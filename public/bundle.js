var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function s(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function u(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function l(t){return document.createTextNode(t)}function d(){return l(" ")}function f(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e,n){const i=new Set;for(let e=0;e<t.length;e+=1)t[e].checked&&i.add(t[e].__value);return n||i.delete(e),Array.from(i)}function g(t){let e;return{p(...n){e=n,e.forEach((e=>t.push(e)))},r(){e.forEach((e=>t.splice(t.indexOf(e),1)))}}}function _(t,e){e=""+e,t.data!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}let v;function w(t){v=t}function b(){if(!v)throw new Error("Function called outside component initialization");return v}function x(t){b().$$.on_mount.push(t)}function T(){const t=b();return(e,n,{cancelable:i=!1}={})=>{const s=t.$$.callbacks[e];if(s){const o=function(t,e,{bubbles:n=!1,cancelable:i=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,i,e),s}(e,n,{cancelable:i});return s.slice().forEach((e=>{e.call(t,o)})),!o.defaultPrevented}return!0}}const E=[],S=[];let C=[];const I=[],P=Promise.resolve();let A=!1;function k(t){C.push(t)}const D=new Set;let M=0;function N(){if(0!==M)return;const t=v;do{try{for(;M<E.length;){const t=E[M];M++,w(t),O(t.$$)}}catch(t){throw E.length=0,M=0,t}for(w(null),E.length=0,M=0;S.length;)S.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];D.has(e)||(D.add(e),e())}C.length=0}while(E.length);for(;I.length;)I.pop()();A=!1,D.clear(),w(t)}function O(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(k)}}const R=new Set;let z;function B(t,e){t&&t.i&&(R.delete(t),t.i(e))}function F(t,e,n,i){if(t&&t.o){if(R.has(t))return;R.add(t),z.c.push((()=>{R.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}else i&&i()}function V(t){t&&t.c()}function U(t,n,o,r){const{fragment:a,after_update:h}=t.$$;a&&a.m(n,o),r||k((()=>{const n=t.$$.on_mount.map(e).filter(s);t.$$.on_destroy?t.$$.on_destroy.push(...n):i(n),t.$$.on_mount=[]})),h.forEach(k)}function j(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];C.forEach((i=>-1===t.indexOf(i)?e.push(i):n.push(i))),n.forEach((t=>t())),C=e}(n.after_update),i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(t,e){-1===t.$$.dirty[0]&&(E.push(t),A||(A=!0,P.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function $(e,s,o,r,a,c,u,l=[-1]){const d=v;w(e);const f=e.$$={fragment:null,ctx:[],props:c,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(d?d.$$.context:[])),callbacks:n(),dirty:l,skip_bound:!1,root:s.target||d.$$.root};u&&u(f.root);let p=!1;if(f.ctx=o?o(e,s.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),p&&Z(e,t)),n})):[],f.update(),p=!0,i(f.before_update),f.fragment=!!r&&r(f.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);f.fragment&&f.fragment.l(t),t.forEach(h)}else f.fragment&&f.fragment.c();s.intro&&B(e.$$.fragment),U(e,s.target,s.anchor,s.customElement),N()}w(d)}class q{$destroy(){j(this,1),this.$destroy=t}$on(e,n){if(!s(n))return t;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const t=i.indexOf(n);-1!==t&&i.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const H=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},G={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],o=e+1<t.length,r=o?t[e+1]:0,a=e+2<t.length,h=a?t[e+2]:0,c=s>>2,u=(3&s)<<4|r>>4;let l=(15&r)<<2|h>>6,d=63&h;a||(d=64,o||(l=64)),i.push(n[c],n[u],n[l],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(H(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&o)}else if(s>239&&s<365){const o=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{const o=t[n++],r=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&o)<<6|63&r)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const r=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==o||null==r||null==a)throw new K;const h=s<<2|o>>4;if(i.push(h),64!==r){const t=o<<4&240|r>>2;if(i.push(t),64!==a){const t=r<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class K extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const W=function(t){return function(t){const e=H(t);return G.encodeByteArray(e,!0)}(t).replace(/\./g,"")};
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const Q=()=>
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Y=()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&function(t){try{return G.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)},X=()=>{try{return Q()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||Y()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},J=t=>{const e=(t=>{var e,n;return null===(n=null===(e=X())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),i]:[e.substring(0,n),i]},tt=()=>{var t;return null===(t=X())||void 0===t?void 0:t.config};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class et{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function nt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function it(){return!function(){var t;const e=null===(t=X())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function st(){try{return"object"==typeof indexedDB}catch(t){return!1}}class ot extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,ot.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rt.prototype.create)}}class rt{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?function(t,e){return t.replace(at,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",r=`${this.serviceName}: ${o} (${i}).`;return new ot(i,r,n)}}const at=/\{\$([^}]+)}/g;function ht(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],o=e[s];if(ct(n)&&ct(o)){if(!ht(n,o))return!1}else if(n!==o)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function ct(t){return null!==t&&"object"==typeof t}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ut(t){return t&&t._delegate?t._delegate:t}class lt{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const dt="[DEFAULT]";
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ft{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new et;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService({instanceIdentifier:dt})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=dt){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=dt){return this.instances.has(t)}getOptions(t=dt){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(t)&&e.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&t(o,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===dt?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=dt){return this.component?this.component.multipleInstances?t:dt:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class pt{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new ft(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var mt;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(mt||(mt={}));const gt={debug:mt.DEBUG,verbose:mt.VERBOSE,info:mt.INFO,warn:mt.WARN,error:mt.ERROR,silent:mt.SILENT},_t=mt.INFO,yt={[mt.DEBUG]:"log",[mt.VERBOSE]:"log",[mt.INFO]:"info",[mt.WARN]:"warn",[mt.ERROR]:"error"},vt=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=yt[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class wt{constructor(t){this.name=t,this._logLevel=_t,this._logHandler=vt,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in mt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?gt[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,mt.DEBUG,...t),this._logHandler(this,mt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,mt.VERBOSE,...t),this._logHandler(this,mt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,mt.INFO,...t),this._logHandler(this,mt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,mt.WARN,...t),this._logHandler(this,mt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,mt.ERROR,...t),this._logHandler(this,mt.ERROR,...t)}}const bt=(t,e)=>e.some((e=>t instanceof e));let xt,Tt;const Et=new WeakMap,St=new WeakMap,Ct=new WeakMap,It=new WeakMap,Lt=new WeakMap;let Pt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return St.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Ct.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Dt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function At(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Tt||(Tt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Mt(this),e),Dt(Et.get(this))}:function(...e){return Dt(t.apply(Mt(this),e))}:function(e,...n){const i=t.call(Mt(this),e,...n);return Ct.set(i,e.sort?e.sort():[e]),Dt(i)}}function kt(t){return"function"==typeof t?At(t):(t instanceof IDBTransaction&&function(t){if(St.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{e(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)}));St.set(t,e)}(t),bt(t,xt||(xt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Pt):t)}function Dt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{e(Dt(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&Et.set(e,t)})).catch((()=>{})),Lt.set(e,t),e}(t);if(It.has(t))return It.get(t);const e=kt(t);return e!==t&&(It.set(t,e),Lt.set(e,t)),e}const Mt=t=>Lt.get(t);const Nt=["get","getKey","getAll","getAllKeys","count"],Ot=["put","add","delete","clear"],Rt=new Map;function zt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Rt.get(e))return Rt.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=Ot.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!Nt.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,s?"readwrite":"readonly");let r=o.store;return i&&(r=r.index(e.shift())),(await Promise.all([r[n](...e),s&&o.done]))[0]};return Rt.set(e,o),o}Pt=(t=>({...t,get:(e,n,i)=>zt(e,n)||t.get(e,n,i),has:(e,n)=>!!zt(e,n)||t.has(e,n)}))(Pt);
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Bt{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const Ft="@firebase/app",Vt="0.10.0",Ut=new wt("@firebase/app"),jt="@firebase/app-compat",Zt="@firebase/analytics-compat",$t="@firebase/analytics",qt="@firebase/app-check-compat",Ht="@firebase/app-check",Gt="@firebase/auth",Kt="@firebase/auth-compat",Wt="@firebase/database",Qt="@firebase/database-compat",Yt="@firebase/functions",Xt="@firebase/functions-compat",Jt="@firebase/installations",te="@firebase/installations-compat",ee="@firebase/messaging",ne="@firebase/messaging-compat",ie="@firebase/performance",se="@firebase/performance-compat",oe="@firebase/remote-config",re="@firebase/remote-config-compat",ae="@firebase/storage",he="@firebase/storage-compat",ce="@firebase/firestore",ue="@firebase/firestore-compat",le="firebase",de="[DEFAULT]",fe={[Ft]:"fire-core",[jt]:"fire-core-compat",[$t]:"fire-analytics",[Zt]:"fire-analytics-compat",[Ht]:"fire-app-check",[qt]:"fire-app-check-compat",[Gt]:"fire-auth",[Kt]:"fire-auth-compat",[Wt]:"fire-rtdb",[Qt]:"fire-rtdb-compat",[Yt]:"fire-fn",[Xt]:"fire-fn-compat",[Jt]:"fire-iid",[te]:"fire-iid-compat",[ee]:"fire-fcm",[ne]:"fire-fcm-compat",[ie]:"fire-perf",[se]:"fire-perf-compat",[oe]:"fire-rc",[re]:"fire-rc-compat",[ae]:"fire-gcs",[he]:"fire-gcs-compat",[ce]:"fire-fst",[ue]:"fire-fst-compat","fire-js":"fire-js",[le]:"fire-js-all"},pe=new Map,me=new Map,ge=new Map;function _e(t,e){try{t.container.addComponent(e)}catch(n){Ut.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ye(t){const e=t.name;if(ge.has(e))return Ut.debug(`There were multiple attempts to register component ${e}.`),!1;ge.set(e,t);for(const e of pe.values())_e(e,t);for(const e of me.values())_e(e,t);return!0}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const ve=new rt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class we{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new lt("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ve.create("app-deleted",{appName:this._name})}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function be(t,e={}){let n=t;if("object"!=typeof e){e={name:e}}const i=Object.assign({name:de,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw ve.create("bad-app-name",{appName:String(s)});if(n||(n=tt()),!n)throw ve.create("no-options");const o=pe.get(s);if(o){if(ht(n,o.options)&&ht(i,o.config))return o;throw ve.create("duplicate-app",{appName:s})}const r=new pt(s);for(const t of ge.values())r.addComponent(t);const a=new we(n,i,r);return pe.set(s,a),a}function xe(t,e,n){var i;let s=null!==(i=fe[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const t=[`Unable to register library "${s}" with version "${e}":`];return o&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&t.push("and"),r&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void Ut.warn(t.join(" "))}ye(new lt(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Te="firebase-heartbeat-database",Ee=1,Se="firebase-heartbeat-store";let Ce=null;function Ie(){return Ce||(Ce=function(t,e,{blocked:n,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(t,e),a=Dt(r);return i&&r.addEventListener("upgradeneeded",(t=>{i(Dt(r.result),t.oldVersion,t.newVersion,Dt(r.transaction),t)})),n&&r.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),s&&t.addEventListener("versionchange",(t=>s(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(Te,Ee,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Se)}catch(t){console.warn(t)}}}).catch((t=>{throw ve.create("idb-open",{originalErrorMessage:t.message})}))),Ce}async function Le(t,e){try{const n=(await Ie()).transaction(Se,"readwrite"),i=n.objectStore(Se);await i.put(e,Pe(t)),await n.done}catch(t){if(t instanceof ot)Ut.warn(t.message);else{const e=ve.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});Ut.warn(e.message)}}}function Pe(t){return`${t.name}!${t.options.appId}`}
/**
     * @license
     * Copyright 2021 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ae{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new De(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ke();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=ke(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),Me(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Me(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),s=W(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function ke(){return(new Date).toISOString().substring(0,10)}class De{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!st()&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await Ie()).transaction(Se),n=await e.objectStore(Se).get(Pe(t));return await e.done,n}catch(t){if(t instanceof ot)Ut.warn(t.message);else{const e=ve.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});Ut.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Le(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Le(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Me(t){return W(JSON.stringify({version:2,heartbeats:t})).length}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ne;Ne="",ye(new lt("platform-logger",(t=>new Bt(t)),"PRIVATE")),ye(new lt("heartbeat",(t=>new Ae(t)),"PRIVATE")),xe(Ft,Vt,Ne),xe(Ft,Vt,"esm2017"),xe("fire-js","");
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
xe("firebase","10.10.0","app");var Oe,Re="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ze=ze||{},Be=Re||self;function Fe(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Ve(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Ue="closure_uid_"+(1e9*Math.random()>>>0),je=0;function Ze(t,e,n){return t.call.apply(t.bind,arguments)}function $e(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function qe(t,e,n){return(qe=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ze:$e).apply(null,arguments)}function He(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Ge(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,i){for(var s=Array(arguments.length-2),o=2;o<arguments.length;o++)s[o-2]=arguments[o];return e.prototype[n].apply(t,s)}}function Ke(){this.s=this.s,this.o=this.o}Ke.prototype.s=!1,Ke.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Ue)&&t[Ue]||(t[Ue]=++je))},Ke.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const We=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Qe(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Ye(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Fe(n)){const e=t.length||0,i=n.length||0;t.length=e+i;for(let s=0;s<i;s++)t[e+s]=n[s]}else t.push(n)}}function Xe(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Xe.prototype.h=function(){this.defaultPrevented=!0};var Je=function(){if(!Be.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};Be.addEventListener("test",t,e),Be.removeEventListener("test",t,e)}catch(t){}return t}();function tn(t){return/^[\s\xa0]*$/.test(t)}function en(){var t=Be.navigator;return t&&(t=t.userAgent)?t:""}function nn(t){return-1!=en().indexOf(t)}function sn(t){return sn[" "](t),t}sn[" "]=function(){};var on,rn,an,hn=nn("Opera"),cn=nn("Trident")||nn("MSIE"),un=nn("Edge"),ln=un||cn,dn=nn("Gecko")&&!(-1!=en().toLowerCase().indexOf("webkit")&&!nn("Edge"))&&!(nn("Trident")||nn("MSIE"))&&!nn("Edge"),fn=-1!=en().toLowerCase().indexOf("webkit")&&!nn("Edge");function pn(){var t=Be.document;return t?t.documentMode:void 0}t:{var mn="",gn=(rn=en(),dn?/rv:([^\);]+)(\)|;)/.exec(rn):un?/Edge\/([\d\.]+)/.exec(rn):cn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rn):fn?/WebKit\/(\S+)/.exec(rn):hn?/(?:Version)[ \/]?(\S+)/.exec(rn):void 0);if(gn&&(mn=gn?gn[1]:""),cn){var _n=pn();if(null!=_n&&_n>parseFloat(mn)){on=String(_n);break t}}on=mn}if(Be.document&&cn){var yn=pn();an=yn||(parseInt(on,10)||void 0)}else an=void 0;var vn=an;function wn(t,e){if(Xe.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(dn){t:{try{sn(e.nodeName);var s=!0;break t}catch(t){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bn[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&wn.$.h.call(this)}}Ge(wn,Xe);var bn={2:"touch",3:"pen",4:"mouse"};wn.prototype.h=function(){wn.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var xn="closure_listenable_"+(1e6*Math.random()|0),Tn=0;function En(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=s,this.key=++Tn,this.fa=this.ia=!1}function Sn(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Cn(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function In(t){const e={};for(const n in t)e[n]=t[n];return e}const Ln="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pn(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<Ln.length;e++)n=Ln[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function An(t){this.src=t,this.g={},this.h=0}function kn(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],o=We(s,e);(i=0<=o)&&Array.prototype.splice.call(s,o,1),i&&(Sn(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Dn(t,e,n,i){for(var s=0;s<t.length;++s){var o=t[s];if(!o.fa&&o.listener==e&&o.capture==!!n&&o.la==i)return s}return-1}An.prototype.add=function(t,e,n,i,s){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var r=Dn(t,e,i,s);return-1<r?(e=t[r],n||(e.ia=!1)):((e=new En(e,this.src,o,!!i,s)).ia=n,t.push(e)),e};var Mn="closure_lm_"+(1e6*Math.random()|0),Nn={};function On(t,e,n,i,s){if(i&&i.once)return zn(t,e,n,i,s);if(Array.isArray(e)){for(var o=0;o<e.length;o++)On(t,e[o],n,i,s);return null}return n=$n(n),t&&t[xn]?t.O(e,n,Ve(i)?!!i.capture:!!i,s):Rn(t,e,n,!1,i,s)}function Rn(t,e,n,i,s,o){if(!e)throw Error("Invalid event type");var r=Ve(s)?!!s.capture:!!s,a=jn(t);if(a||(t[Mn]=a=new An(t)),(n=a.add(e,n,i,r,o)).proxy)return n;if(i=function(){function t(n){return e.call(t.src,t.listener,n)}const e=Un;return t}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Je||(s=r),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(Vn(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function zn(t,e,n,i,s){if(Array.isArray(e)){for(var o=0;o<e.length;o++)zn(t,e[o],n,i,s);return null}return n=$n(n),t&&t[xn]?t.P(e,n,Ve(i)?!!i.capture:!!i,s):Rn(t,e,n,!0,i,s)}function Bn(t,e,n,i,s){if(Array.isArray(e))for(var o=0;o<e.length;o++)Bn(t,e[o],n,i,s);else i=Ve(i)?!!i.capture:!!i,n=$n(n),t&&t[xn]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Dn(o=t.g[e],n,i,s))&&(Sn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=jn(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Dn(e,n,i,s)),(n=-1<t?e[t]:null)&&Fn(n))}function Fn(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[xn])kn(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Vn(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=jn(e))?(kn(n,t),0==n.h&&(n.src=null,e[Mn]=null)):Sn(t)}}}function Vn(t){return t in Nn?Nn[t]:Nn[t]="on"+t}function Un(t,e){if(t.fa)t=!0;else{e=new wn(e,this);var n=t.listener,i=t.la||t.src;t.ia&&Fn(t),t=n.call(i,e)}return t}function jn(t){return(t=t[Mn])instanceof An?t:null}var Zn="__closure_events_fn_"+(1e9*Math.random()>>>0);function $n(t){return"function"==typeof t?t:(t[Zn]||(t[Zn]=function(e){return t.handleEvent(e)}),t[Zn])}function qn(){Ke.call(this),this.i=new An(this),this.S=this,this.J=null}function Hn(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,"string"==typeof e)e=new Xe(e,t);else if(e instanceof Xe)e.target=e.target||t;else{var s=e;Pn(e=new Xe(i,t),s)}if(s=!0,n)for(var o=n.length-1;0<=o;o--){var r=e.g=n[o];s=Gn(r,i,!0,e)&&s}if(s=Gn(r=e.g=t,i,!0,e)&&s,s=Gn(r,i,!1,e)&&s,n)for(o=0;o<n.length;o++)s=Gn(r=e.g=n[o],i,!1,e)&&s}function Gn(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,o=0;o<e.length;++o){var r=e[o];if(r&&!r.fa&&r.capture==n){var a=r.listener,h=r.la||r.src;r.ia&&kn(t.i,r),s=!1!==a.call(h,i)&&s}}return s&&!i.defaultPrevented}Ge(qn,Ke),qn.prototype[xn]=!0,qn.prototype.removeEventListener=function(t,e,n,i){Bn(this,t,e,n,i)},qn.prototype.N=function(){if(qn.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)Sn(n[i]);delete e.g[t],e.h--}}this.J=null},qn.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},qn.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Kn=Be.JSON.stringify;function Wn(){var t=ni;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Qn=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Yn),(t=>t.reset()));class Yn{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Xn(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Jn(t){Be.setTimeout((()=>{throw t}),0)}let ti,ei=!1,ni=new class{constructor(){this.h=this.g=null}add(t,e){const n=Qn.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},ii=()=>{const t=Be.Promise.resolve(void 0);ti=()=>{t.then(si)}};var si=()=>{for(var t;t=Wn();){try{t.h.call(t.g)}catch(t){Jn(t)}var e=Qn;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ei=!1};function oi(t,e){qn.call(this),this.h=t||1,this.g=e||Be,this.j=qe(this.qb,this),this.l=Date.now()}function ri(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function ai(t,e,n){if("function"==typeof t)n&&(t=qe(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=qe(t.handleEvent,t)}return 2147483647<Number(e)?-1:Be.setTimeout(t,e||0)}function hi(t){t.g=ai((()=>{t.g=null,t.i&&(t.i=!1,hi(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Ge(oi,qn),(Oe=oi.prototype).ga=!1,Oe.T=null,Oe.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Hn(this,"tick"),this.ga&&(ri(this),this.start()))}},Oe.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Oe.N=function(){oi.$.N.call(this),ri(this),delete this.g};class ci extends Ke{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:hi(this)}N(){super.N(),this.g&&(Be.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ui(t){Ke.call(this),this.h=t,this.g={}}Ge(ui,Ke);var li=[];function di(t,e,n,i){Array.isArray(n)||(n&&(li[0]=n.toString()),n=li);for(var s=0;s<n.length;s++){var o=On(e,n[s],i||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function fi(t){Cn(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Fn(t)}),t),t.g={}}function pi(){this.g=!0}function mi(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var o=s[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var r=1;r<s.length;r++)s[r]=""}}}return Kn(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}ui.prototype.N=function(){ui.$.N.call(this),fi(this)},ui.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pi.prototype.Ea=function(){this.g=!1},pi.prototype.info=function(){};var gi={},_i=null;function yi(){return _i=_i||new qn}function vi(t){Xe.call(this,gi.Ta,t)}function wi(t){const e=yi();Hn(e,new vi(e))}function bi(t,e){Xe.call(this,gi.STAT_EVENT,t),this.stat=e}function xi(t){const e=yi();Hn(e,new bi(e,t))}function Ti(t,e){Xe.call(this,gi.Ua,t),this.size=e}function Ei(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Be.setTimeout((function(){t()}),e)}gi.Ta="serverreachability",Ge(vi,Xe),gi.STAT_EVENT="statevent",Ge(bi,Xe),gi.Ua="timingevent",Ge(Ti,Xe);var Si={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ci={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ii(){}function Li(t){return t.h||(t.h=t.i())}function Pi(){}Ii.prototype.h=null;var Ai,ki={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Di(){Xe.call(this,"d")}function Mi(){Xe.call(this,"c")}function Ni(){}function Oi(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new ui(this),this.P=zi,t=ln?125:void 0,this.V=new oi(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Ri}function Ri(){this.i=null,this.g="",this.h=!1}Ge(Di,Xe),Ge(Mi,Xe),Ge(Ni,Ii),Ni.prototype.g=function(){return new XMLHttpRequest},Ni.prototype.i=function(){return{}},Ai=new Ni;var zi=45e3,Bi={},Fi={};function Vi(t,e,n){t.L=1,t.A=os(ts(e)),t.u=n,t.S=!0,Ui(t,null)}function Ui(t,e){t.G=Date.now(),qi(t),t.B=ts(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),ys(n.i,"t",i),t.o=0,n=t.l.J,t.h=new Ri,t.g=vo(t.l,n?e:null,!t.u),0<t.O&&(t.M=new ci(qe(t.Pa,t,t.g),t.O)),di(t.U,t.g,"readystatechange",t.nb),e=t.I?In(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),wi(),function(t,e,n,i,s,o){t.info((function(){if(t.g)if(o)for(var r="",a=o.split("&"),h=0;h<a.length;h++){var c=a[h].split("=");if(1<c.length){var u=c[0];c=c[1];var l=u.split("_");r=2<=l.length&&"type"==l[1]?r+(u+"=")+c+"&":r+(u+"=redacted&")}}else r=null;else r=o;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+r}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function ji(t){return!!t.g&&("GET"==t.v&&2!=t.L&&t.l.Ha)}function Zi(t,e,n){let i,s=!0;for(;!t.J&&t.o<n.length;){if(i=$i(t,n),i==Fi){4==e&&(t.s=4,xi(14),s=!1),mi(t.j,t.m,null,"[Incomplete Response]");break}if(i==Bi){t.s=4,xi(15),mi(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}mi(t.j,t.m,i,null),Qi(t,i)}ji(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,xi(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),uo(e),e.M=!0,xi(11))):(mi(t.j,t.m,n,"[Invalid Chunked Response]"),Wi(t),Ki(t))}function $i(t,e){var n=t.o,i=e.indexOf("\n",n);return-1==i?Fi:(n=Number(e.substring(n,i)),isNaN(n)?Bi:(i+=1)+n>e.length?Fi:(e=e.slice(i,i+n),t.o=i+n,e))}function qi(t){t.Y=Date.now()+t.P,Hi(t,t.P)}function Hi(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Ei(qe(t.lb,t),e)}function Gi(t){t.C&&(Be.clearTimeout(t.C),t.C=null)}function Ki(t){0==t.l.H||t.J||po(t.l,t)}function Wi(t){Gi(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,ri(t.V),fi(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Qi(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Ss(n.i,t)))if(!t.K&&Ss(n.i,t)&&3==n.H){try{var i=n.Ja.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;fo(n),no(n)}co(n),xi(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&0==n.A&&!n.v&&(n.v=Ei(qe(n.ib,n),6e3));if(1>=Es(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else go(n,11)}else if((t.K||n.g==t)&&fo(n),!tn(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const e=c[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const s=c[4];null!=s&&(n.Ga=s,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(i=1.5*u,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const l=t.g;if(l){const t=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var o=i.i;o.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(Cs(o,o.h),o.h=null))}if(i.F){const t=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.Da=t,ss(i.I,i.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var r=t;if((i=n).wa=yo(i,i.J?i.pa:null,i.Y),r.K){Is(i.i,r);var a=r,h=i.L;h&&a.setTimeout(h),a.C&&(Gi(a),qi(a)),i.g=r}else ho(i);0<n.j.length&&so(n)}else"stop"!=c[0]&&"close"!=c[0]||go(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?go(n,7):eo(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}wi()}catch(t){}}function Yi(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Fe(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Fe(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const i in t)e[n++]=i;return e}}}(t),i=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Fe(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),s=i.length,o=0;o<s;o++)e.call(void 0,i[o],n&&n[o],t)}(Oe=Oi.prototype).setTimeout=function(t){this.P=t},Oe.nb=function(t){t=t.target;const e=this.M;e&&3==Ws(t)?e.l():this.Pa(t)},Oe.Pa=function(t){try{if(t==this.g)t:{const u=Ws(this.g);var e=this.g.Ia();this.g.da();if(!(3>u)&&(3!=u||ln||this.g&&(this.h.h||this.g.ja()||Qs(this.g)))){this.J||4!=u||7==e||wi(),Gi(this);var n=this.g.da();this.ca=n;e:if(ji(this)){var i=Qs(this.g);t="";var s=i.length,o=4==Ws(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Wi(this),Ki(this);var r="";break e}this.h.i=new Be.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:o&&e==s-1});i.length=0,this.h.g+=t,this.o=0,r=this.h.g}else r=this.g.ja();if(this.i=200==n,function(t,e,n,i,s,o,r){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+o+" "+r}))}(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,h=this.g;if((a=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!tn(a)){var c=a;break e}}c=null}if(!(n=c)){this.i=!1,this.s=3,xi(12),Wi(this),Ki(this);break t}mi(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qi(this,n)}this.S?(Zi(this,u,r),ln&&this.i&&3==u&&(di(this.U,this.V,"tick",this.mb),this.V.start())):(mi(this.j,this.m,r,null),Qi(this,r)),4==u&&Wi(this),this.i&&!this.J&&(4==u?po(this.l,this):(this.i=!1,qi(this)))}else(function(t){const e={};t=(t.g&&2<=Ws(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<t.length;i++){if(tn(t[i]))continue;var n=Xn(t[i]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const o=e[s]||[];e[s]=o,o.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<r.indexOf("Unknown SID")?(this.s=3,xi(12)):(this.s=0,xi(13)),Wi(this),Ki(this)}}}catch(t){}},Oe.mb=function(){if(this.g){var t=Ws(this.g),e=this.g.ja();this.o<e.length&&(Gi(this),Zi(this,t,e),this.i&&4!=t&&qi(this))}},Oe.cancel=function(){this.J=!0,Wi(this)},Oe.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(wi(),xi(17)),Wi(this),this.s=2,Ki(this)):Hi(this,this.Y-t)};var Xi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ji(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ji){this.h=t.h,es(this,t.j),this.s=t.s,this.g=t.g,ns(this,t.m),this.l=t.l;var e=t.i,n=new ps;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),is(this,n),this.o=t.o}else t&&(e=String(t).match(Xi))?(this.h=!1,es(this,e[1]||"",!0),this.s=rs(e[2]||""),this.g=rs(e[3]||"",!0),ns(this,e[4]),this.l=rs(e[5]||"",!0),is(this,e[6]||"",!0),this.o=rs(e[7]||"")):(this.h=!1,this.i=new ps(null,this.h))}function ts(t){return new Ji(t)}function es(t,e,n){t.j=n?rs(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ns(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function is(t,e,n){e instanceof ps?(t.i=e,function(t,e){e&&!t.j&&(ms(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(gs(this,e),ys(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=as(e,ds)),t.i=new ps(e,t.h))}function ss(t,e,n){t.i.set(e,n)}function os(t){return ss(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function rs(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function as(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hs),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hs(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ji.prototype.toString=function(){var t=[],e=this.j;e&&t.push(as(e,cs,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(as(e,cs,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(as(n,"/"==n.charAt(0)?ls:us,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",as(n,fs)),t.join("")};var cs=/[#\/\?@]/g,us=/[#\?:]/g,ls=/[#\?]/g,ds=/[#\?@]/g,fs=/#/g;function ps(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ms(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var o=t[n].substring(0,i);s=t[n].substring(i+1)}else o=t[n];e(o,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function gs(t,e){ms(t),e=vs(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function _s(t,e){return ms(t),e=vs(t,e),t.g.has(e)}function ys(t,e,n){gs(t,e),0<n.length&&(t.i=null,t.g.set(vs(t,e),Qe(n)),t.h+=n.length)}function vs(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(Oe=ps.prototype).add=function(t,e){ms(this),this.i=null,t=vs(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Oe.forEach=function(t,e){ms(this),this.g.forEach((function(n,i){n.forEach((function(n){t.call(e,n,i,this)}),this)}),this)},Oe.ta=function(){ms(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){const s=t[i];for(let t=0;t<s.length;t++)n.push(e[i])}return n},Oe.Z=function(t){ms(this);let e=[];if("string"==typeof t)_s(this,t)&&(e=e.concat(this.g.get(vs(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},Oe.set=function(t,e){return ms(this),this.i=null,_s(this,t=vs(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Oe.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Oe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];const o=encodeURIComponent(String(i)),r=this.Z(i);for(i=0;i<r.length;i++){var s=o;""!==r[i]&&(s+="="+encodeURIComponent(String(r[i]))),t.push(s)}}return this.i=t.join("&")};var ws=class{constructor(t,e){this.g=t,this.map=e}};function bs(t){this.l=t||xs,Be.PerformanceNavigationTiming?t=0<(t=Be.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Be.g&&Be.g.Ka&&Be.g.Ka()&&Be.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var xs=10;function Ts(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Es(t){return t.h?1:t.g?t.g.size:0}function Ss(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Cs(t,e){t.g?t.g.add(e):t.h=e}function Is(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Ls(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Qe(t.i)}bs.prototype.cancel=function(){if(this.i=Ls(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Ps=class{stringify(t){return Be.JSON.stringify(t,void 0)}parse(t){return Be.JSON.parse(t,void 0)}};function As(){this.g=new Ps}function ks(t,e,n){const i=n||"";try{Yi(t,(function(t,n){let s=t;Ve(t)&&(s=Kn(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Ds(t,e,n,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(t){}}function Ms(t){this.l=t.ec||null,this.j=t.ob||!1}function Ns(t,e){qn.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Os,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ge(Ms,Ii),Ms.prototype.g=function(){return new Ns(this.l,this.j)},Ms.prototype.i=function(t){return function(){return t}}({}),Ge(Ns,qn);var Os=0;function Rs(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function zs(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Bs(t)}function Bs(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Oe=Ns.prototype).open=function(t,e){if(this.readyState!=Os)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Bs(this)},Oe.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Be).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Oe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,zs(this)),this.readyState=Os},Oe.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Bs(this)),this.g&&(this.readyState=3,Bs(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Be.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Rs(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Oe.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?zs(this):Bs(this),3==this.readyState&&Rs(this)}},Oe.Za=function(t){this.g&&(this.response=this.responseText=t,zs(this))},Oe.Ya=function(t){this.g&&(this.response=t,zs(this))},Oe.ka=function(){this.g&&zs(this)},Oe.setRequestHeader=function(t,e){this.v.append(t,e)},Oe.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Oe.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ns.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Fs=Be.JSON.parse;function Vs(t){qn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Us,this.L=this.M=!1}Ge(Vs,qn);var Us="",js=/^https?$/i,Zs=["POST","PUT"];function $s(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,qs(t),Gs(t)}function qs(t){t.F||(t.F=!0,Hn(t,"complete"),Hn(t,"error"))}function Hs(t){if(t.h&&void 0!==ze&&(!t.C[1]||4!=Ws(t)||2!=t.da()))if(t.v&&4==Ws(t))ai(t.La,0,t);else if(Hn(t,"readystatechange"),4==Ws(t)){t.h=!1;try{const r=t.da();t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===r){var s=String(t.I).match(Xi)[1]||null;!s&&Be.self&&Be.self.location&&(s=Be.self.location.protocol.slice(0,-1)),i=!js.test(s?s.toLowerCase():"")}n=i}if(n)Hn(t,"complete"),Hn(t,"success");else{t.m=6;try{var o=2<Ws(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.da()+"]",qs(t)}}finally{Gs(t)}}}function Gs(t,e){if(t.g){Ks(t);const n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Hn(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function Ks(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Be.clearTimeout(t.A),t.A=null)}function Ws(t){return t.g?t.g.readyState:0}function Qs(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Us:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Ys(t){let e="";return Cn(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function Xs(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=Ys(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ss(t,e,n))}function Js(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function to(t){this.Ga=0,this.j=[],this.l=new pi,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Js("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Js("baseRetryDelayMs",5e3,t),this.hb=Js("retryDelaySeedMs",1e4,t),this.eb=Js("forwardChannelMaxRetries",2,t),this.xa=Js("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new bs(t&&t.concurrentRequestLimit),this.Ja=new As,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function eo(t){if(io(t),3==t.H){var e=t.W++,n=ts(t.I);if(ss(n,"SID",t.K),ss(n,"RID",e),ss(n,"TYPE","terminate"),ro(t,n),(e=new Oi(t,t.l,e)).L=2,e.A=os(ts(n)),n=!1,Be.navigator&&Be.navigator.sendBeacon)try{n=Be.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Be.Image&&((new Image).src=e.A,n=!0),n||(e.g=vo(e.l,null),e.g.ha(e.A)),e.G=Date.now(),qi(e)}_o(t)}function no(t){t.g&&(uo(t),t.g.cancel(),t.g=null)}function io(t){no(t),t.u&&(Be.clearTimeout(t.u),t.u=null),fo(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Be.clearTimeout(t.m),t.m=null)}function so(t){if(!Ts(t.i)&&!t.m){t.m=!0;var e=t.Na;ti||ii(),ei||(ti(),ei=!0),ni.add(e,t),t.C=0}}function oo(t,e){var n;n=e?e.m:t.W++;const i=ts(t.I);ss(i,"SID",t.K),ss(i,"RID",n),ss(i,"AID",t.V),ro(t,i),t.o&&t.s&&Xs(i,t.o,t.s),n=new Oi(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=ao(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Cs(t.i,n),Vi(n,i,e)}function ro(t,e){t.na&&Cn(t.na,(function(t,n){ss(e,n,t)})),t.h&&Yi({},(function(t,n){ss(e,n,t)}))}function ao(t,e,n){n=Math.min(t.j.length,n);var i=t.h?qe(t.h.Va,t.h,t):null;t:{var s=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let r=0;r<n;r++){let n=s[r].g;const a=s[r].map;if(n-=e,0>n)e=Math.max(0,s[r].g-100),o=!1;else try{ks(a,t,"req"+n+"_")}catch(t){i&&i(a)}}if(o){i=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,i}function ho(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;ti||ii(),ei||(ti(),ei=!0),ni.add(e,t),t.A=0}}function co(t){return!(t.g||t.u||3<=t.A)&&(t.ba++,t.u=Ei(qe(t.Ma,t),mo(t,t.A)),t.A++,!0)}function uo(t){null!=t.B&&(Be.clearTimeout(t.B),t.B=null)}function lo(t){t.g=new Oi(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=ts(t.wa);ss(e,"RID","rpc"),ss(e,"SID",t.K),ss(e,"AID",t.V),ss(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&ss(e,"TO",t.qa),ss(e,"TYPE","xmlhttp"),ro(t,e),t.o&&t.s&&Xs(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=os(ts(e)),n.u=null,n.S=!0,Ui(n,t)}function fo(t){null!=t.v&&(Be.clearTimeout(t.v),t.v=null)}function po(t,e){var n=null;if(t.g==e){fo(t),uo(t),t.g=null;var i=2}else{if(!Ss(t.i,e))return;n=e.F,Is(t.i,e),i=1}if(0!=t.H)if(e.i)if(1==i){n=e.u?e.u.length:0,e=Date.now()-e.G;var s=t.C;Hn(i=yi(),new Ti(i,n)),so(t)}else ho(t);else if(3==(s=e.s)||0==s&&0<e.ca||!(1==i&&function(t,e){return!(Es(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Ei(qe(t.Na,t,e),mo(t,t.C)),t.C++,0)))}(t,e)||2==i&&co(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:go(t,5);break;case 4:go(t,10);break;case 3:go(t,6);break;default:go(t,2)}}function mo(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function go(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var i=qe(t.pb,t);n||(n=new Ji("//www.google.com/images/cleardot.gif"),Be.location&&"http"==Be.location.protocol||es(n,"https"),os(n)),function(t,e){const n=new pi;if(Be.Image){const i=new Image;i.onload=He(Ds,n,i,"TestLoadImage: loaded",!0,e),i.onerror=He(Ds,n,i,"TestLoadImage: error",!1,e),i.onabort=He(Ds,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=He(Ds,n,i,"TestLoadImage: timeout",!1,e),Be.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else xi(2);t.H=0,t.h&&t.h.za(e),_o(t),io(t)}function _o(t){if(t.H=0,t.ma=[],t.h){const e=Ls(t.i);0==e.length&&0==t.j.length||(Ye(t.ma,e),Ye(t.ma,t.j),t.i.i.length=0,Qe(t.j),t.j.length=0),t.h.ya()}}function yo(t,e,n){var i=n instanceof Ji?ts(n):new Ji(n);if(""!=i.g)e&&(i.g=e+"."+i.g),ns(i,i.m);else{var s=Be.location;i=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var o=new Ji(null);i&&es(o,i),e&&(o.g=e),s&&ns(o,s),n&&(o.l=n),i=o}return n=t.F,e=t.Da,n&&e&&ss(i,n,e),ss(i,"VER",t.ra),ro(t,i),i}function vo(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Vs(new Ms({ob:n})):new Vs(t.va)).Oa(t.J),e}function wo(){}function bo(){if(cn&&!(10<=Number(vn)))throw Error("Environmental error: no available transport.")}function xo(t,e){qn.call(this),this.g=new to(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!tn(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!tn(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new So(this)}function To(t){Di.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Eo(){Mi.call(this),this.status=1}function So(t){this.g=t}function Co(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Io(t,e,n){n||(n=0);var i=Array(16);if("string"==typeof e)for(var s=0;16>s;++s)i[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)i[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var o=t.g[3],r=e+(o^n&(s^o))+i[0]+3614090360&4294967295;r=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=(n=(s=(o=(e=n+(r<<7&4294967295|r>>>25))+((r=o+(s^e&(n^s))+i[1]+3905402710&4294967295)<<12&4294967295|r>>>20))+((r=s+(n^o&(e^n))+i[2]+606105819&4294967295)<<17&4294967295|r>>>15))+((r=n+(e^s&(o^e))+i[3]+3250441966&4294967295)<<22&4294967295|r>>>10))+((r=e+(o^n&(s^o))+i[4]+4118548399&4294967295)<<7&4294967295|r>>>25))+((r=o+(s^e&(n^s))+i[5]+1200080426&4294967295)<<12&4294967295|r>>>20))+((r=s+(n^o&(e^n))+i[6]+2821735955&4294967295)<<17&4294967295|r>>>15))+((r=n+(e^s&(o^e))+i[7]+4249261313&4294967295)<<22&4294967295|r>>>10))+((r=e+(o^n&(s^o))+i[8]+1770035416&4294967295)<<7&4294967295|r>>>25))+((r=o+(s^e&(n^s))+i[9]+2336552879&4294967295)<<12&4294967295|r>>>20))+((r=s+(n^o&(e^n))+i[10]+4294925233&4294967295)<<17&4294967295|r>>>15))+((r=n+(e^s&(o^e))+i[11]+2304563134&4294967295)<<22&4294967295|r>>>10))+((r=e+(o^n&(s^o))+i[12]+1804603682&4294967295)<<7&4294967295|r>>>25))+((r=o+(s^e&(n^s))+i[13]+4254626195&4294967295)<<12&4294967295|r>>>20))+((r=s+(n^o&(e^n))+i[14]+2792965006&4294967295)<<17&4294967295|r>>>15))+((r=n+(e^s&(o^e))+i[15]+1236535329&4294967295)<<22&4294967295|r>>>10))+((r=e+(s^o&(n^s))+i[1]+4129170786&4294967295)<<5&4294967295|r>>>27))+((r=o+(n^s&(e^n))+i[6]+3225465664&4294967295)<<9&4294967295|r>>>23))+((r=s+(e^n&(o^e))+i[11]+643717713&4294967295)<<14&4294967295|r>>>18))+((r=n+(o^e&(s^o))+i[0]+3921069994&4294967295)<<20&4294967295|r>>>12))+((r=e+(s^o&(n^s))+i[5]+3593408605&4294967295)<<5&4294967295|r>>>27))+((r=o+(n^s&(e^n))+i[10]+38016083&4294967295)<<9&4294967295|r>>>23))+((r=s+(e^n&(o^e))+i[15]+3634488961&4294967295)<<14&4294967295|r>>>18))+((r=n+(o^e&(s^o))+i[4]+3889429448&4294967295)<<20&4294967295|r>>>12))+((r=e+(s^o&(n^s))+i[9]+568446438&4294967295)<<5&4294967295|r>>>27))+((r=o+(n^s&(e^n))+i[14]+3275163606&4294967295)<<9&4294967295|r>>>23))+((r=s+(e^n&(o^e))+i[3]+4107603335&4294967295)<<14&4294967295|r>>>18))+((r=n+(o^e&(s^o))+i[8]+1163531501&4294967295)<<20&4294967295|r>>>12))+((r=e+(s^o&(n^s))+i[13]+2850285829&4294967295)<<5&4294967295|r>>>27))+((r=o+(n^s&(e^n))+i[2]+4243563512&4294967295)<<9&4294967295|r>>>23))+((r=s+(e^n&(o^e))+i[7]+1735328473&4294967295)<<14&4294967295|r>>>18))+((r=n+(o^e&(s^o))+i[12]+2368359562&4294967295)<<20&4294967295|r>>>12))+((r=e+(n^s^o)+i[5]+4294588738&4294967295)<<4&4294967295|r>>>28))+((r=o+(e^n^s)+i[8]+2272392833&4294967295)<<11&4294967295|r>>>21))+((r=s+(o^e^n)+i[11]+1839030562&4294967295)<<16&4294967295|r>>>16))+((r=n+(s^o^e)+i[14]+4259657740&4294967295)<<23&4294967295|r>>>9))+((r=e+(n^s^o)+i[1]+2763975236&4294967295)<<4&4294967295|r>>>28))+((r=o+(e^n^s)+i[4]+1272893353&4294967295)<<11&4294967295|r>>>21))+((r=s+(o^e^n)+i[7]+4139469664&4294967295)<<16&4294967295|r>>>16))+((r=n+(s^o^e)+i[10]+3200236656&4294967295)<<23&4294967295|r>>>9))+((r=e+(n^s^o)+i[13]+681279174&4294967295)<<4&4294967295|r>>>28))+((r=o+(e^n^s)+i[0]+3936430074&4294967295)<<11&4294967295|r>>>21))+((r=s+(o^e^n)+i[3]+3572445317&4294967295)<<16&4294967295|r>>>16))+((r=n+(s^o^e)+i[6]+76029189&4294967295)<<23&4294967295|r>>>9))+((r=e+(n^s^o)+i[9]+3654602809&4294967295)<<4&4294967295|r>>>28))+((r=o+(e^n^s)+i[12]+3873151461&4294967295)<<11&4294967295|r>>>21))+((r=s+(o^e^n)+i[15]+530742520&4294967295)<<16&4294967295|r>>>16))+((r=n+(s^o^e)+i[2]+3299628645&4294967295)<<23&4294967295|r>>>9))+((r=e+(s^(n|~o))+i[0]+4096336452&4294967295)<<6&4294967295|r>>>26))+((r=o+(n^(e|~s))+i[7]+1126891415&4294967295)<<10&4294967295|r>>>22))+((r=s+(e^(o|~n))+i[14]+2878612391&4294967295)<<15&4294967295|r>>>17))+((r=n+(o^(s|~e))+i[5]+4237533241&4294967295)<<21&4294967295|r>>>11))+((r=e+(s^(n|~o))+i[12]+1700485571&4294967295)<<6&4294967295|r>>>26))+((r=o+(n^(e|~s))+i[3]+2399980690&4294967295)<<10&4294967295|r>>>22))+((r=s+(e^(o|~n))+i[10]+4293915773&4294967295)<<15&4294967295|r>>>17))+((r=n+(o^(s|~e))+i[1]+2240044497&4294967295)<<21&4294967295|r>>>11))+((r=e+(s^(n|~o))+i[8]+1873313359&4294967295)<<6&4294967295|r>>>26))+((r=o+(n^(e|~s))+i[15]+4264355552&4294967295)<<10&4294967295|r>>>22))+((r=s+(e^(o|~n))+i[6]+2734768916&4294967295)<<15&4294967295|r>>>17))+((r=n+(o^(s|~e))+i[13]+1309151649&4294967295)<<21&4294967295|r>>>11))+((o=(e=n+((r=e+(s^(n|~o))+i[4]+4149444226&4294967295)<<6&4294967295|r>>>26))+((r=o+(n^(e|~s))+i[11]+3174756917&4294967295)<<10&4294967295|r>>>22))^((s=o+((r=s+(e^(o|~n))+i[2]+718787259&4294967295)<<15&4294967295|r>>>17))|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(r<<21&4294967295|r>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+o&4294967295}function Lo(t,e){this.h=e;for(var n=[],i=!0,s=t.length-1;0<=s;s--){var o=0|t[s];i&&o==e||(n[s]=o,i=!1)}this.g=n}(Oe=Vs.prototype).Oa=function(t){this.M=t},Oe.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ai.g(),this.C=this.u?Li(this.u):Li(Ai),this.g.onreadystatechange=qe(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void $s(this,t)}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)n.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const t of i.keys())n.set(t,i.get(t))}i=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),s=Be.FormData&&t instanceof Be.FormData,!(0<=We(Zs,e))||i||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ks(this),0<this.B&&((this.L=function(t){return cn&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=qe(this.ua,this)):this.A=ai(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){$s(this,t)}},Oe.ua=function(){void 0!==ze&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Hn(this,"timeout"),this.abort(8))},Oe.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Hn(this,"complete"),Hn(this,"abort"),Gs(this))},Oe.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Gs(this,!0)),Vs.$.N.call(this)},Oe.La=function(){this.s||(this.G||this.v||this.l?Hs(this):this.kb())},Oe.kb=function(){Hs(this)},Oe.isActive=function(){return!!this.g},Oe.da=function(){try{return 2<Ws(this)?this.g.status:-1}catch(t){return-1}},Oe.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Oe.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Fs(e)}},Oe.Ia=function(){return this.m},Oe.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Oe=to.prototype).ra=8,Oe.H=1,Oe.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new Oi(this,this.l,t);let o=this.s;if(this.U&&(o?(o=In(o),Pn(o,this.U)):o=this.U),null!==this.o||this.O||(s.I=o,o=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=ao(this,s,e),ss(n=ts(this.I),"RID",t),ss(n,"CVER",22),this.F&&ss(n,"X-HTTP-Session-Id",this.F),ro(this,n),o&&(this.O?e="headers="+encodeURIComponent(String(Ys(o)))+"&"+e:this.o&&Xs(n,this.o,o)),Cs(this.i,s),this.bb&&ss(n,"TYPE","init"),this.P?(ss(n,"$req",e),ss(n,"SID","null"),s.aa=!0,Vi(s,n,null)):Vi(s,n,e),this.H=2}}else 3==this.H&&(t?oo(this,t):0==this.j.length||Ts(this.i)||oo(this))},Oe.Ma=function(){if(this.u=null,lo(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Ei(qe(this.jb,this),t)}},Oe.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,xi(10),no(this),lo(this))},Oe.ib=function(){null!=this.v&&(this.v=null,no(this),co(this),xi(19))},Oe.pb=function(t){t?(this.l.info("Successfully pinged google.com"),xi(2)):(this.l.info("Failed to ping google.com"),xi(1))},Oe.isActive=function(){return!!this.h&&this.h.isActive(this)},(Oe=wo.prototype).Ba=function(){},Oe.Aa=function(){},Oe.za=function(){},Oe.ya=function(){},Oe.isActive=function(){return!0},Oe.Va=function(){},bo.prototype.g=function(t,e){return new xo(t,e)},Ge(xo,qn),xo.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;xi(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=yo(t,null,t.Y),so(t)},xo.prototype.close=function(){eo(this.g)},xo.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Kn(t),t=n);e.j.push(new ws(e.fb++,t)),3==e.H&&so(e)},xo.prototype.N=function(){this.g.h=null,delete this.j,eo(this.g),delete this.g,xo.$.N.call(this)},Ge(To,Di),Ge(Eo,Mi),Ge(So,wo),So.prototype.Ba=function(){Hn(this.g,"a")},So.prototype.Aa=function(t){Hn(this.g,new To(t))},So.prototype.za=function(t){Hn(this.g,new Eo)},So.prototype.ya=function(){Hn(this.g,"b")},Ge(Co,(function(){this.blockSize=-1})),Co.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Co.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=this.m,s=this.h,o=0;o<e;){if(0==s)for(;o<=n;)Io(this,t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(i[s++]=t.charCodeAt(o++),s==this.blockSize){Io(this,i),s=0;break}}else for(;o<e;)if(i[s++]=t[o++],s==this.blockSize){Io(this,i),s=0;break}}this.h=s,this.i+=e},Co.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};var Po={};function Ao(t){return-128<=t&&128>t?function(t,e){var n=Po;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(t){return new Lo([0|t],0>t?-1:0)})):new Lo([0|t],0>t?-1:0)}function ko(t){if(isNaN(t)||!isFinite(t))return Mo;if(0>t)return Bo(ko(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=Do;return new Lo(e,0)}var Do=4294967296,Mo=Ao(0),No=Ao(1),Oo=Ao(16777216);function Ro(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function zo(t){return-1==t.h}function Bo(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new Lo(n,~t.h).add(No)}function Fo(t,e){return t.add(Bo(e))}function Vo(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Uo(t,e){this.g=t,this.h=e}function jo(t,e){if(Ro(e))throw Error("division by zero");if(Ro(t))return new Uo(Mo,Mo);if(zo(t))return e=jo(Bo(t),e),new Uo(Bo(e.g),Bo(e.h));if(zo(e))return e=jo(t,Bo(e)),new Uo(Bo(e.g),e.h);if(30<t.g.length){if(zo(t)||zo(e))throw Error("slowDivide_ only works with positive integers.");for(var n=No,i=e;0>=i.X(t);)n=Zo(n),i=Zo(i);var s=$o(n,1),o=$o(i,1);for(i=$o(i,2),n=$o(n,2);!Ro(i);){var r=o.add(i);0>=r.X(t)&&(s=s.add(n),o=r),i=$o(i,1),n=$o(n,1)}return e=Fo(t,s.R(e)),new Uo(s,e)}for(s=Mo;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),r=(o=ko(n)).R(e);zo(r)||0<r.X(t);)r=(o=ko(n-=i)).R(e);Ro(o)&&(o=No),s=s.add(o),t=Fo(t,r)}return new Uo(s,t)}function Zo(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new Lo(n,t.h)}function $o(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,s=[],o=0;o<i;o++)s[o]=0<e?t.D(o+n)>>>e|t.D(o+n+1)<<32-e:t.D(o+n);return new Lo(s,t.h)}(Oe=Lo.prototype).ea=function(){if(zo(this))return-Bo(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:Do+i)*e,e*=Do}return t},Oe.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Ro(this))return"0";if(zo(this))return"-"+Bo(this).toString(t);for(var e=ko(Math.pow(t,6)),n=this,i="";;){var s=jo(n,e).g,o=((0<(n=Fo(n,s.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Ro(n=s))return o+i;for(;6>o.length;)o="0"+o;i=o+i}},Oe.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Oe.X=function(t){return zo(t=Fo(this,t))?-1:Ro(t)?0:1},Oe.abs=function(){return zo(this)?Bo(this):this},Oe.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,s=0;s<=e;s++){var o=i+(65535&this.D(s))+(65535&t.D(s)),r=(o>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);i=r>>>16,o&=65535,r&=65535,n[s]=r<<16|o}return new Lo(n,-2147483648&n[n.length-1]?-1:0)},Oe.R=function(t){if(Ro(this)||Ro(t))return Mo;if(zo(this))return zo(t)?Bo(this).R(Bo(t)):Bo(Bo(this).R(t));if(zo(t))return Bo(this.R(Bo(t)));if(0>this.X(Oo)&&0>t.X(Oo))return ko(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<t.g.length;s++){var o=this.D(i)>>>16,r=65535&this.D(i),a=t.D(s)>>>16,h=65535&t.D(s);n[2*i+2*s]+=r*h,Vo(n,2*i+2*s),n[2*i+2*s+1]+=o*h,Vo(n,2*i+2*s+1),n[2*i+2*s+1]+=r*a,Vo(n,2*i+2*s+1),n[2*i+2*s+2]+=o*a,Vo(n,2*i+2*s+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new Lo(n,0)},Oe.gb=function(t){return jo(this,t).h},Oe.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new Lo(n,this.h&t.h)},Oe.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new Lo(n,this.h|t.h)},Oe.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new Lo(n,this.h^t.h)},bo.prototype.createWebChannel=bo.prototype.g,xo.prototype.send=xo.prototype.u,xo.prototype.open=xo.prototype.m,xo.prototype.close=xo.prototype.close,Si.NO_ERROR=0,Si.TIMEOUT=8,Si.HTTP_ERROR=6,Ci.COMPLETE="complete",Pi.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",qn.prototype.listen=qn.prototype.O,Vs.prototype.listenOnce=Vs.prototype.P,Vs.prototype.getLastError=Vs.prototype.Sa,Vs.prototype.getLastErrorCode=Vs.prototype.Ia,Vs.prototype.getStatus=Vs.prototype.da,Vs.prototype.getResponseJson=Vs.prototype.Wa,Vs.prototype.getResponseText=Vs.prototype.ja,Vs.prototype.send=Vs.prototype.ha,Vs.prototype.setWithCredentials=Vs.prototype.Oa,Co.prototype.digest=Co.prototype.l,Co.prototype.reset=Co.prototype.reset,Co.prototype.update=Co.prototype.j,Lo.prototype.add=Lo.prototype.add,Lo.prototype.multiply=Lo.prototype.R,Lo.prototype.modulo=Lo.prototype.gb,Lo.prototype.compare=Lo.prototype.X,Lo.prototype.toNumber=Lo.prototype.ea,Lo.prototype.toString=Lo.prototype.toString,Lo.prototype.getBits=Lo.prototype.D,Lo.fromNumber=ko,Lo.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return Bo(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=ko(Math.pow(n,8)),s=Mo,o=0;o<e.length;o+=8){var r=Math.min(8,e.length-o),a=parseInt(e.substring(o,o+r),n);8>r?(r=ko(Math.pow(n,r)),s=s.R(r).add(ko(a))):s=(s=s.R(i)).add(ko(a))}return s};var qo=Si,Ho=Ci,Go=gi,Ko=10,Wo=11,Qo=Pi,Yo=Vs,Xo=Co,Jo=Lo;const tr="@firebase/firestore";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class er{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}er.UNAUTHENTICATED=new er(null),er.GOOGLE_CREDENTIALS=new er("google-credentials-uid"),er.FIRST_PARTY=new er("first-party-uid"),er.MOCK_USER=new er("mock-user");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
let nr="10.10.0";
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const ir=new wt("@firebase/firestore");function sr(){return ir.logLevel}function or(t,...e){if(ir.logLevel<=mt.DEBUG){const n=e.map(hr);ir.debug(`Firestore (${nr}): ${t}`,...n)}}function rr(t,...e){if(ir.logLevel<=mt.ERROR){const n=e.map(hr);ir.error(`Firestore (${nr}): ${t}`,...n)}}function ar(t,...e){if(ir.logLevel<=mt.WARN){const n=e.map(hr);ir.warn(`Firestore (${nr}): ${t}`,...n)}}function hr(t){if("string"==typeof t)return t;try{
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function cr(t="Unexpected state"){const e=`FIRESTORE (${nr}) INTERNAL ASSERTION FAILED: `+t;throw rr(e),new Error(e)}function ur(t,e){t||cr()}function lr(t,e){return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const dr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fr extends ot{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class pr{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mr{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class gr{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(er.UNAUTHENTICATED)))}shutdown(){}}class _r{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class yr{constructor(t){this.t=t,this.currentUser=er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new pr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new pr,t.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},r=t=>{or("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit((t=>r(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?r(t):(or("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new pr)}}),0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(or("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(ur("string"==typeof e.accessToken),new mr(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return ur(null===t||"string"==typeof t),new er(t)}}class vr{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=er.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class wr{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new vr(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(er.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class br{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xr{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&or("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,or("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{or("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?i(t):or("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(ur("string"==typeof t.token),this.R=t.token,new br(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Tr(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Er{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=Tr(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<e&&(n+=t.charAt(i[s]%62))}return n}}function Sr(t,e){return t<e?-1:t>e?1:0}function Cr(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ir{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new fr(dr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new fr(dr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new fr(dr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new fr(dr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Ir.fromMillis(Date.now())}static fromDate(t){return Ir.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Ir(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Sr(this.nanoseconds,t.nanoseconds):Sr(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Lr{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Lr(t)}static min(){return new Lr(new Ir(0,0))}static max(){return new Lr(new Ir(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Pr{constructor(t,e,n){void 0===e?e=0:e>t.length&&cr(),void 0===n?n=t.length-e:n>t.length-e&&cr(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Pr.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Pr?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),s=e.get(i);if(n<s)return-1;if(n>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Ar extends Pr{construct(t,e,n){return new Ar(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new fr(dr.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Ar(e)}static emptyPath(){return new Ar([])}}const kr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dr extends Pr{construct(t,e,n){return new Dr(t,e,n)}static isValidIdentifier(t){return kr.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dr.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Dr(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new fr(dr.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let o=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new fr(dr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new fr(dr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(o=!o,i++):"."!==e||o?(n+=e,i++):(s(),i++)}if(s(),o)throw new fr(dr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Dr(e)}static emptyPath(){return new Dr([])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Mr{constructor(t){this.path=t}static fromPath(t){return new Mr(Ar.fromString(t))}static fromName(t){return new Mr(Ar.fromString(t).popFirst(5))}static empty(){return new Mr(Ar.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Ar.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Ar.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Mr(new Ar(t.slice()))}}function Nr(t){return new Or(t.readTime,t.key,-1)}class Or{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Or(Lr.min(),Mr.empty(),-1)}static max(){return new Or(Lr.max(),Mr.empty(),-1)}}function Rr(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Mr.comparator(t.documentKey,e.documentKey),0!==n?n:Sr(t.largestBatchId,e.largestBatchId)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */)}const zr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Br{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */async function Fr(t){if(t.code!==dr.FAILED_PRECONDITION||t.message!==zr)throw t;or("LocalStore","Unexpectedly lost primary lease")}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Vr{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&cr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Vr(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Vr?e:Vr.resolve(e)}catch(t){return Vr.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Vr.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Vr.reject(e)}static resolve(t){return new Vr(((e,n)=>{e(t)}))}static reject(t){return new Vr(((e,n)=>{n(t)}))}static waitFor(t){return new Vr(((e,n)=>{let i=0,s=0,o=!1;t.forEach((t=>{++i,t.next((()=>{++s,o&&s===i&&e()}),(t=>n(t)))})),o=!0,s===i&&e()}))}static or(t){let e=Vr.resolve(!1);for(const n of t)e=e.next((t=>t?Vr.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new Vr(((n,i)=>{const s=t.length,o=new Array(s);let r=0;for(let a=0;a<s;a++){const h=a;e(t[h]).next((t=>{o[h]=t,++r,r===s&&n(o)}),(t=>i(t)))}}))}static doWhile(t,e){return new Vr(((n,i)=>{const s=()=>{!0===t()?e().next((()=>{s()}),i):n()};s()}))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ur{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new pr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new $r(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=Wr(e.target.error);this.V.reject(new $r(t,n))}}static open(t,e,n,i){try{return new Ur(e,t.transaction(i,n))}catch(t){throw new $r(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(or("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new Hr(e)}}class jr{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===jr.S(nt())&&rr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return or("SimpleDb","Removing database:",t),Gr(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!st())return!1;if(jr.C())return!0;const t=nt(),e=jr.S(t),n=0<e&&e<10,i=jr.v(t),s=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||s)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(or("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=t=>{const n=t.target.result;e(n)},i.onblocked=()=>{n(new $r(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=e=>{const i=e.target.error;"VersionError"===i.name?n(new fr(dr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new fr(dr.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new $r(t,i))},i.onupgradeneeded=t=>{or("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,i.transaction,t.oldVersion,this.version).next((()=>{or("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db}B(t){this.L=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,i){const s="readonly"===e;let o=0;for(;;){++o;try{this.db=await this.O(t);const e=Ur.open(this.db,t,s?"readonly":"readwrite",n),o=i(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),Vr.reject(t)))).toPromise();return o.catch((()=>{})),await e.m,o}catch(t){const e=t,n="FirebaseError"!==e.name&&o<3;if(or("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Zr{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Gr(this.k.delete())}}class $r extends fr{constructor(t,e){super(dr.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function qr(t){return"IndexedDbTransactionError"===t.name}class Hr{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(or("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(or("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Gr(n)}add(t){return or("SimpleDb","ADD",this.store.name,t,t),Gr(this.store.add(t))}get(t){return Gr(this.store.get(t)).next((e=>(void 0===e&&(e=null),or("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return or("SimpleDb","DELETE",this.store.name,t),Gr(this.store.delete(t))}count(){return or("SimpleDb","COUNT",this.store.name),Gr(this.store.count())}W(t,e){const n=this.options(t,e),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const t=i.getAll(n.range);return new Vr(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new Vr(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){or("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const i=this.cursor(n);return this.G(i,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const i=this.cursor(n);return this.G(i,e)}Z(t){const e=this.cursor({});return new Vr(((n,i)=>{e.onerror=t=>{const e=Wr(t.target.error);i(e)},e.onsuccess=e=>{const i=e.target.result;i?t(i.primaryKey,i.value).next((t=>{t?i.continue():n()})):n()}}))}G(t,e){const n=[];return new Vr(((i,s)=>{t.onerror=t=>{s(t.target.error)},t.onsuccess=t=>{const s=t.target.result;if(!s)return void i();const o=new Zr(s),r=e(s.primaryKey,s.value,o);if(r instanceof Vr){const t=r.catch((t=>(o.done(),Vr.reject(t))));n.push(t)}o.isDone?i():null===o.$?s.continue():s.continue(o.$)}})).next((()=>Vr.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Gr(t){return new Vr(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=Wr(t.target.error);n(e)}}))}let Kr=!1;function Wr(t){const e=jr.S(nt());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new fr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Kr||(Kr=!0,setTimeout((()=>{throw t}),0)),t}}return t}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Qr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function Yr(t){return null==t}function Xr(t){return 0===t&&1/t==-1/0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Jr(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ta(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ea(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Qr._e=-1;class na{constructor(t,e){this.comparator=t,this.root=e||sa.EMPTY}insert(t,e){return new na(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,sa.BLACK,null,null))}remove(t){return new na(this.comparator,this.root.remove(t,this.comparator).copy(null,null,sa.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ia(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ia(this.root,t,this.comparator,!1)}getReverseIterator(){return new ia(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ia(this.root,t,this.comparator,!0)}}class ia{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class sa{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:sa.RED,this.left=null!=i?i:sa.EMPTY,this.right=null!=s?s:sa.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new sa(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return sa.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return sa.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,sa.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,sa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw cr();if(this.right.isRed())throw cr();const t=this.left.check();if(t!==this.right.check())throw cr();return t+(this.isRed()?0:1)}}sa.EMPTY=null,sa.RED=!0,sa.BLACK=!1,sa.EMPTY=new class{constructor(){this.size=0}get key(){throw cr()}get value(){throw cr()}get color(){throw cr()}get left(){throw cr()}get right(){throw cr()}copy(t,e,n,i,s){return this}insert(t,e,n){return new sa(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class oa{constructor(t){this.comparator=t,this.data=new na(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new ra(this.data.getIterator())}getIteratorFrom(t){return new ra(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof oa))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new oa(this.comparator);return e.data=t,e}}class ra{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class aa{constructor(t){this.fields=t,t.sort(Dr.comparator)}static empty(){return new aa([])}unionWith(t){let e=new oa(Dr.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new aa(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Cr(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ha extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ca{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new ha("Invalid base64 string: "+t):t}}(t);return new ca(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ca(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Sr(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ca.EMPTY_BYTE_STRING=new ca("");const ua=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function la(t){if(ur(!!t),"string"==typeof t){let e=0;const n=ua.exec(t);if(ur(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:da(t.seconds),nanos:da(t.nanos)}}function da(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function fa(t){return"string"==typeof t?ca.fromBase64String(t):ca.fromUint8Array(t)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function pa(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ma(t){const e=t.mapValue.fields.__previous_value__;return pa(e)?ma(e):e}function ga(t){const e=la(t.mapValue.fields.__local_write_time__.timestampValue);return new Ir(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _a{constructor(t,e,n,i,s,o,r,a,h){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=r,this.longPollingOptions=a,this.useFetchStreams=h}}class ya{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new ya("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof ya&&t.projectId===this.projectId&&t.database===this.database}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const va={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function wa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pa(t)?4:function(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)?9007199254740991:10:cr()}function ba(t,e){if(t===e)return!0;const n=wa(t);if(n!==wa(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ga(t).isEqual(ga(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=la(t.timestampValue),i=la(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return fa(t.bytesValue).isEqual(fa(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return da(t.geoPointValue.latitude)===da(e.geoPointValue.latitude)&&da(t.geoPointValue.longitude)===da(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return da(t.integerValue)===da(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=da(t.doubleValue),i=da(e.doubleValue);return n===i?Xr(n)===Xr(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Cr(t.arrayValue.values||[],e.arrayValue.values||[],ba);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(Jr(n)!==Jr(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!ba(n[t],i[t])))return!1;return!0}(t,e);default:return cr()}}function xa(t,e){return void 0!==(t.values||[]).find((t=>ba(t,e)))}function Ta(t,e){if(t===e)return 0;const n=wa(t),i=wa(e);if(n!==i)return Sr(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Sr(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=da(t.integerValue||t.doubleValue),i=da(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Ea(t.timestampValue,e.timestampValue);case 4:return Ea(ga(t),ga(e));case 5:return Sr(t.stringValue,e.stringValue);case 6:return function(t,e){const n=fa(t),i=fa(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Sr(n[t],i[t]);if(0!==e)return e}return Sr(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Sr(da(t.latitude),da(e.latitude));return 0!==n?n:Sr(da(t.longitude),da(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Ta(n[t],i[t]);if(e)return e}return Sr(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===va.mapValue&&e===va.mapValue)return 0;if(t===va.mapValue)return 1;if(e===va.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},o=Object.keys(s);i.sort(),o.sort();for(let t=0;t<i.length&&t<o.length;++t){const e=Sr(i[t],o[t]);if(0!==e)return e;const r=Ta(n[i[t]],s[o[t]]);if(0!==r)return r}return Sr(i.length,o.length)}(t.mapValue,e.mapValue);default:throw cr()}}function Ea(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Sr(t,e);const n=la(t),i=la(e),s=Sr(n.seconds,i.seconds);return 0!==s?s:Sr(n.nanos,i.nanos)}function Sa(t){return Ca(t)}function Ca(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=la(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return fa(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return Mr.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Ca(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+=`${s}:${Ca(t.fields[s])}`;return n+"}"}(t.mapValue):cr()}function Ia(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function La(t){return!!t&&"integerValue"in t}function Pa(t){return!!t&&"arrayValue"in t}function Aa(t){return!!t&&"nullValue"in t}function ka(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Da(t){return!!t&&"mapValue"in t}function Ma(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ta(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Ma(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ma(t.arrayValue.values[n]);return e}return Object.assign({},t)}class Na{constructor(t){this.value=t}static empty(){return new Na({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Da(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ma(e)}setAll(t){let e=Dr.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=Ma(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());Da(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ba(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Da(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){ta(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Na(Ma(this.value))}}function Oa(t){const e=[];return ta(t.fields,((t,n)=>{const i=new Dr([t]);if(Da(n)){const t=Oa(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new aa(e)
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class Ra{constructor(t,e,n,i,s,o,r){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=r}static newInvalidDocument(t){return new Ra(t,0,Lr.min(),Lr.min(),Lr.min(),Na.empty(),0)}static newFoundDocument(t,e,n,i){return new Ra(t,1,e,Lr.min(),n,i,0)}static newNoDocument(t,e){return new Ra(t,2,e,Lr.min(),Lr.min(),Na.empty(),0)}static newUnknownDocument(t,e){return new Ra(t,3,e,Lr.min(),Lr.min(),Na.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Lr.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Na.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Na.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Lr.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Ra&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ra(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class za{constructor(t,e){this.position=t,this.inclusive=e}}function Ba(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const o=e[s],r=t.position[s];if(i=o.field.isKeyField()?Mr.comparator(Mr.fromName(r.referenceValue),n.key):Ta(r,n.data.field(o.field)),"desc"===o.dir&&(i*=-1),0!==i)break}return i}function Fa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ba(t.position[n],e.position[n]))return!1;return!0}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Va{constructor(t,e="asc"){this.field=t,this.dir=e}}function Ua(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ja{}class Za extends ja{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new Qa(t,e,n):"array-contains"===e?new th(t,n):"in"===e?new eh(t,n):"not-in"===e?new nh(t,n):"array-contains-any"===e?new ih(t,n):new Za(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new Ya(t,n):new Xa(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(Ta(e,this.value)):null!==e&&wa(this.value)===wa(e)&&this.matchesComparison(Ta(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return cr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $a extends ja{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new $a(t,e)}matches(t){return qa(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function qa(t){return"and"===t.op}function Ha(t){return function(t){for(const e of t.filters)if(e instanceof $a)return!1;return!0}(t)&&qa(t)}function Ga(t){if(t instanceof Za)return t.field.canonicalString()+t.op.toString()+Sa(t.value);if(Ha(t))return t.filters.map((t=>Ga(t))).join(",");{const e=t.filters.map((t=>Ga(t))).join(",");return`${t.op}(${e})`}}function Ka(t,e){return t instanceof Za?function(t,e){return e instanceof Za&&t.op===e.op&&t.field.isEqual(e.field)&&ba(t.value,e.value)}(t,e):t instanceof $a?function(t,e){return e instanceof $a&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,i)=>t&&Ka(n,e.filters[i])),!0)}(t,e):void cr()}function Wa(t){return t instanceof Za?function(t){return`${t.field.canonicalString()} ${t.op} ${Sa(t.value)}`}(t):t instanceof $a?function(t){return t.op.toString()+" {"+t.getFilters().map(Wa).join(" ,")+"}"}(t):"Filter"}class Qa extends Za{constructor(t,e,n){super(t,e,n),this.key=Mr.fromName(n.referenceValue)}matches(t){const e=Mr.comparator(t.key,this.key);return this.matchesComparison(e)}}class Ya extends Za{constructor(t,e){super(t,"in",e),this.keys=Ja("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Xa extends Za{constructor(t,e){super(t,"not-in",e),this.keys=Ja("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Ja(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Mr.fromName(t.referenceValue)))}class th extends Za{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Pa(e)&&xa(e.arrayValue,this.value)}}class eh extends Za{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&xa(this.value.arrayValue,e)}}class nh extends Za{constructor(t,e){super(t,"not-in",e)}matches(t){if(xa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!xa(this.value.arrayValue,e)}}class ih extends Za{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Pa(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>xa(this.value.arrayValue,t)))}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sh{constructor(t,e=null,n=[],i=[],s=null,o=null,r=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=r,this.ce=null}}function oh(t,e=null,n=[],i=[],s=null,o=null,r=null){return new sh(t,e,n,i,s,o,r)}function rh(t){const e=lr(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Ga(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Yr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Sa(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Sa(t))).join(",")),e.ce=t}return e.ce}function ah(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ua(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Ka(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fa(t.startAt,e.startAt)&&Fa(t.endAt,e.endAt)}function hh(t){return Mr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ch{constructor(t,e=null,n=[],i=[],s=null,o="F",r=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=r,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function uh(t){return new ch(t)}function lh(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function dh(t){return null!==t.collectionGroup}function fh(t){const e=lr(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",i=function(t){let e=new oa(Dr.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);i.forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.le.push(new Va(i,n))})),t.has(Dr.keyField().canonicalString())||e.le.push(new Va(Dr.keyField(),n))}return e.le}function ph(t){const e=lr(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return oh(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new Va(t.field,e)}));const n=t.endAt?new za(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new za(t.startAt.position,t.startAt.inclusive):null;return oh(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}(e,fh(t))),e.he}function mh(t,e){const n=t.filters.concat([e]);return new ch(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function gh(t,e,n){return new ch(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _h(t,e){return ah(ph(t),ph(e))&&t.limitType===e.limitType}function yh(t){return`${rh(ph(t))}|lt:${t.limitType}`}function vh(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Wa(t))).join(", ")}]`),Yr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Sa(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Sa(t))).join(",")),`Target(${e})`}(ph(t))}; limitType=${t.limitType})`}function wh(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Mr.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of fh(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=Ba(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,fh(t),e))&&!(t.endAt&&!function(t,e,n){const i=Ba(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,fh(t),e))}(t,e)}function bh(t){return(e,n)=>{let i=!1;for(const s of fh(t)){const t=xh(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}function xh(t,e,n){const i=t.field.isKeyField()?Mr.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?Ta(i,s):cr()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return cr()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Th{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){ta(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return ea(this.inner)}size(){return this.innerSize}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Eh=new na(Mr.comparator);function Sh(){return Eh}const Ch=new na(Mr.comparator);function Ih(...t){let e=Ch;for(const n of t)e=e.insert(n.key,n);return e}function Lh(t){let e=Ch;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Ph(){return kh()}function Ah(){return kh()}function kh(){return new Th((t=>t.toString()),((t,e)=>t.isEqual(e)))}const Dh=new na(Mr.comparator),Mh=new oa(Mr.comparator);function Nh(...t){let e=Mh;for(const n of t)e=e.add(n);return e}const Oh=new oa(Sr);
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Rh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xr(e)?"-0":e}}function zh(t){return{integerValue:""+t}}function Bh(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Xr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?zh(e):Rh(t,e)}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Fh{constructor(){this._=void 0}}function Vh(t,e,n){return t instanceof Zh?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&pa(e)&&(e=ma(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof $h?qh(t,e):t instanceof Hh?Gh(t,e):function(t,e){const n=jh(t,e),i=Wh(n)+Wh(t.Ie);return La(n)&&La(t.Ie)?zh(i):Rh(t.serializer,i)}(t,e)}function Uh(t,e,n){return t instanceof $h?qh(t,e):t instanceof Hh?Gh(t,e):n}function jh(t,e){return t instanceof Kh?function(t){return La(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class Zh extends Fh{}class $h extends Fh{constructor(t){super(),this.elements=t}}function qh(t,e){const n=Qh(e);for(const e of t.elements)n.some((t=>ba(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Hh extends Fh{constructor(t){super(),this.elements=t}}function Gh(t,e){let n=Qh(e);for(const e of t.elements)n=n.filter((t=>!ba(t,e)));return{arrayValue:{values:n}}}class Kh extends Fh{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Wh(t){return da(t.integerValue||t.doubleValue)}function Qh(t){return Pa(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Yh{constructor(t,e){this.version=t,this.transformResults=e}}class Xh{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Xh}static exists(t){return new Xh(void 0,t)}static updateTime(t){return new Xh(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Jh(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class tc{}function ec(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new lc(t.key,Xh.none()):new rc(t.key,t.data,Xh.none());{const n=t.data,i=Na.empty();let s=new oa(Dr.comparator);for(let t of e.fields)if(!s.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),s=s.add(t)}return new ac(t.key,i,new aa(s.toArray()),Xh.none())}}function nc(t,e,n){t instanceof rc?function(t,e,n){const i=t.value.clone(),s=cc(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof ac?function(t,e,n){if(!Jh(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=cc(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(hc(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function ic(t,e,n,i){return t instanceof rc?function(t,e,n,i){if(!Jh(t.precondition,e))return n;const s=t.value.clone(),o=uc(t.fieldTransforms,i,e);return s.setAll(o),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null}(t,e,n,i):t instanceof ac?function(t,e,n,i){if(!Jh(t.precondition,e))return n;const s=uc(t.fieldTransforms,i,e),o=e.data;return o.setAll(hc(t)),o.setAll(s),e.convertToFoundDocument(e.version,o).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return Jh(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function sc(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=jh(i.transform,t||null);null!=s&&(null===n&&(n=Na.empty()),n.set(i.field,s))}return n||null}function oc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Cr(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof $h&&e instanceof $h||t instanceof Hh&&e instanceof Hh?Cr(t.elements,e.elements,ba):t instanceof Kh&&e instanceof Kh?ba(t.Ie,e.Ie):t instanceof Zh&&e instanceof Zh}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class rc extends tc{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ac extends tc{constructor(t,e,n,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function hc(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function cc(t,e,n){const i=new Map;ur(t.length===n.length);for(let s=0;s<n.length;s++){const o=t[s],r=o.transform,a=e.data.field(o.field);i.set(o.field,Uh(r,a,n[s]))}return i}function uc(t,e,n){const i=new Map;for(const s of t){const t=s.transform,o=n.data.field(s.field);i.set(s.field,Vh(t,o,e))}return i}class lc extends tc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dc extends tc{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class fc{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&nc(i,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=ic(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=ic(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Ah();return this.mutations.forEach((i=>{const s=t.get(i.key),o=s.overlayedDocument;let r=this.applyToLocalView(o,s.mutatedFields);r=e.has(i.key)?null:r;const a=ec(o,r);null!==a&&n.set(i.key,a),o.isValidDocument()||o.convertToNoDocument(Lr.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Nh())}isEqual(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,((t,e)=>oc(t,e)))&&Cr(this.baseMutations,t.baseMutations,((t,e)=>oc(t,e)))}}class pc{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){ur(t.mutations.length===n.length);let i=Dh;const s=t.mutations;for(let t=0;t<s.length;t++)i=i.insert(s[t].key,n[t].version);return new pc(t,e,n,i)}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mc{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gc{constructor(t,e){this.count=t,this.unchangedNames=e}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var _c,yc;function vc(t){if(void 0===t)return rr("GRPC error has no .code"),dr.UNKNOWN;switch(t){case _c.OK:return dr.OK;case _c.CANCELLED:return dr.CANCELLED;case _c.UNKNOWN:return dr.UNKNOWN;case _c.DEADLINE_EXCEEDED:return dr.DEADLINE_EXCEEDED;case _c.RESOURCE_EXHAUSTED:return dr.RESOURCE_EXHAUSTED;case _c.INTERNAL:return dr.INTERNAL;case _c.UNAVAILABLE:return dr.UNAVAILABLE;case _c.UNAUTHENTICATED:return dr.UNAUTHENTICATED;case _c.INVALID_ARGUMENT:return dr.INVALID_ARGUMENT;case _c.NOT_FOUND:return dr.NOT_FOUND;case _c.ALREADY_EXISTS:return dr.ALREADY_EXISTS;case _c.PERMISSION_DENIED:return dr.PERMISSION_DENIED;case _c.FAILED_PRECONDITION:return dr.FAILED_PRECONDITION;case _c.ABORTED:return dr.ABORTED;case _c.OUT_OF_RANGE:return dr.OUT_OF_RANGE;case _c.UNIMPLEMENTED:return dr.UNIMPLEMENTED;case _c.DATA_LOSS:return dr.DATA_LOSS;default:return cr()}}(yc=_c||(_c={}))[yc.OK=0]="OK",yc[yc.CANCELLED=1]="CANCELLED",yc[yc.UNKNOWN=2]="UNKNOWN",yc[yc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yc[yc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yc[yc.NOT_FOUND=5]="NOT_FOUND",yc[yc.ALREADY_EXISTS=6]="ALREADY_EXISTS",yc[yc.PERMISSION_DENIED=7]="PERMISSION_DENIED",yc[yc.UNAUTHENTICATED=16]="UNAUTHENTICATED",yc[yc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yc[yc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yc[yc.ABORTED=10]="ABORTED",yc[yc.OUT_OF_RANGE=11]="OUT_OF_RANGE",yc[yc.UNIMPLEMENTED=12]="UNIMPLEMENTED",yc[yc.INTERNAL=13]="INTERNAL",yc[yc.UNAVAILABLE=14]="UNAVAILABLE",yc[yc.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
const wc=new Jo([4294967295,4294967295],0);function bc(t){const e=(new TextEncoder).encode(t),n=new Xo;return n.update(e),new Uint8Array(n.digest())}function xc(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Jo([n,i],0),new Jo([s,o],0)]}class Tc{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Ec(`Invalid padding: ${e}`);if(n<0)throw new Ec(`Invalid hash count: ${n}`);if(t.length>0&&0===this.hashCount)throw new Ec(`Invalid hash count: ${n}`);if(0===t.length&&0!==e)throw new Ec(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=Jo.fromNumber(this.Te)}de(t,e,n){let i=t.add(e.multiply(Jo.fromNumber(n)));return 1===i.compare(wc)&&(i=new Jo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=bc(t),[n,i]=xc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);if(!this.Ae(e))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new Tc(s,i,e);return n.forEach((t=>o.insert(t))),o}insert(t){if(0===this.Te)return;const e=bc(t),[n,i]=xc(e);for(let t=0;t<this.hashCount;t++){const e=this.de(n,i,t);this.Re(e)}}Re(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Ec extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Sc{constructor(t,e,n,i,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Cc.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Sc(Lr.min(),i,new na(Sr),Sh(),Nh())}}class Cc{constructor(t,e,n,i,s){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Cc(n,e,Nh(),Nh(),Nh())}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ic{constructor(t,e,n,i){this.Ve=t,this.removedTargetIds=e,this.key=n,this.me=i}}class Lc{constructor(t,e){this.targetId=t,this.fe=e}}class Pc{constructor(t,e,n=ca.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Ac{constructor(){this.ge=0,this.pe=Mc(),this.ye=ca.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=Nh(),e=Nh(),n=Nh();return this.pe.forEach(((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:cr()}})),new Cc(this.ye,this.we,t,e,n)}Fe(){this.Se=!1,this.pe=Mc()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,ur(this.ge>=0)}Le(){this.Se=!0,this.we=!0}}class kc{constructor(t){this.Be=t,this.ke=new Map,this.qe=Sh(),this.Qe=Dc(),this.Ke=new na(Sr)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,(e=>{const n=this.ze(e);switch(t.state){case 0:this.je(e)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(e);break;case 3:this.je(e)&&(n.Le(),n.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),n.Ce(t.resumeToken));break;default:cr()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach(((t,n)=>{this.je(n)&&e(n)}))}Je(t){const e=t.targetId,n=t.fe.count,i=this.Ye(e);if(i){const s=i.target;if(hh(s))if(0===n){const t=new Mr(s.path);this.We(e,t,Ra.newNoDocument(t,Lr.min()))}else ur(1===n);else{const i=this.Ze(e);if(i!==n){const n=this.Xe(t),s=n?this.et(n,t,i):1;if(0!==s){this.He(e);const t=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(e,t)}}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=e;let o,r;try{o=fa(n).toUint8Array()}catch(t){if(t instanceof ha)return ar("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{r=new Tc(o,i,s)}catch(t){return ar(t instanceof Ec?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===r.Te?null:r}et(t,e,n){return e.fe.count===n-this.rt(t,e.targetId)?0:2}rt(t,e){const n=this.Be.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const s=this.Be.nt(),o=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;t.mightContain(o)||(this.We(e,n,null),i++)})),i}it(t){const e=new Map;this.ke.forEach(((n,i)=>{const s=this.Ye(i);if(s){if(n.current&&hh(s.target)){const e=new Mr(s.target.path);null!==this.qe.get(e)||this.st(i,e)||this.We(i,e,Ra.newNoDocument(e,t))}n.De&&(e.set(i,n.ve()),n.Fe())}}));let n=Nh();this.Qe.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ye(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.qe.forEach(((e,n)=>n.setReadTime(t)));const i=new Sc(t,e,this.Ke,this.qe,n);return this.qe=Sh(),this.Qe=Dc(),this.Ke=new na(Sr),i}Ue(t,e){if(!this.je(t))return;const n=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,n),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,e)?i.Me(e,1):i.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),n&&(this.qe=this.qe.insert(e,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Be.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new Ac,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new oa(Sr),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||or("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Be._t(t)}He(t){this.ke.set(t,new Ac),this.Be.getRemoteKeysForTarget(t).forEach((e=>{this.We(t,e,null)}))}st(t,e){return this.Be.getRemoteKeysForTarget(t).has(e)}}function Dc(){return new na(Mr.comparator)}function Mc(){return new na(Mr.comparator)}const Nc={asc:"ASCENDING",desc:"DESCENDING"},Oc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rc={and:"AND",or:"OR"};class zc{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Bc(t,e){return t.useProto3Json||Yr(e)?e:{value:e}}function Fc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vc(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Uc(t,e){return Fc(t,e.toTimestamp())}function jc(t){return ur(!!t),Lr.fromTimestamp(function(t){const e=la(t);return new Ir(e.seconds,e.nanos)}(t))}function Zc(t,e){return $c(t,e).canonicalString()}function $c(t,e){const n=function(t){return new Ar(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function qc(t){const e=Ar.fromString(t);return ur(cu(e)),e}function Hc(t,e){return Zc(t.databaseId,e.path)}function Gc(t,e){const n=qc(e);if(n.get(1)!==t.databaseId.projectId)throw new fr(dr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new fr(dr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Mr(Qc(n))}function Kc(t,e){return Zc(t.databaseId,e)}function Wc(t){return new Ar(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Qc(t){return ur(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Yc(t,e,n){return{name:Hc(t,e),fields:n.value.mapValue.fields}}function Xc(t,e){return{documents:[Kc(t,e.path)]}}function Jc(t,e){const n={structuredQuery:{}},i=e.path;let s;null!==e.collectionGroup?(s=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Kc(t,s);const o=function(t){if(0!==t.length)return au($a.create(t,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const r=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:ou(t.field),direction:nu(t.dir)}}(t)))}(e.orderBy);r&&(n.structuredQuery.orderBy=r);const a=Bc(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{ut:n,parent:s}}function tu(t){let e=function(t){const e=qc(t);return 4===e.length?Ar.emptyPath():Qc(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){ur(1===i);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let o=[];n.where&&(o=function(t){const e=eu(t);return e instanceof $a&&Ha(e)?e.getFilters():[e]}(n.where));let r=[];n.orderBy&&(r=function(t){return t.map((t=>function(t){return new Va(ru(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Yr(e)?null:e}(n.limit));let h=null;n.startAt&&(h=function(t){const e=!!t.before,n=t.values||[];return new za(n,e)}(n.startAt));let c=null;return n.endAt&&(c=function(t){const e=!t.before,n=t.values||[];return new za(n,e)}(n.endAt)),function(t,e,n,i,s,o,r,a){return new ch(t,e,n,i,s,o,r,a)}(e,s,r,o,a,"F",h,c)}function eu(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=ru(t.unaryFilter.field);return Za.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=ru(t.unaryFilter.field);return Za.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ru(t.unaryFilter.field);return Za.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=ru(t.unaryFilter.field);return Za.create(s,"!=",{nullValue:"NULL_VALUE"});default:return cr()}}(t):void 0!==t.fieldFilter?function(t){return Za.create(ru(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return cr()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return $a.create(t.compositeFilter.filters.map((t=>eu(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return cr()}}(t.compositeFilter.op))}(t):cr()}function nu(t){return Nc[t]}function iu(t){return Oc[t]}function su(t){return Rc[t]}function ou(t){return{fieldPath:t.canonicalString()}}function ru(t){return Dr.fromServerFormat(t.fieldPath)}function au(t){return t instanceof Za?function(t){if("=="===t.op){if(ka(t.value))return{unaryFilter:{field:ou(t.field),op:"IS_NAN"}};if(Aa(t.value))return{unaryFilter:{field:ou(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ka(t.value))return{unaryFilter:{field:ou(t.field),op:"IS_NOT_NAN"}};if(Aa(t.value))return{unaryFilter:{field:ou(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ou(t.field),op:iu(t.op),value:t.value}}}(t):t instanceof $a?function(t){const e=t.getFilters().map((t=>au(t)));return 1===e.length?e[0]:{compositeFilter:{op:su(t.op),filters:e}}}(t):cr()}function hu(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function cu(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class uu{constructor(t,e,n,i,s=Lr.min(),o=Lr.min(),r=ca.EMPTY_BYTE_STRING,a=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=r,this.expectedCount=a}withSequenceNumber(t){return new uu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new uu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new uu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new uu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class lu{constructor(t){this.ct=t}}function du(t){const e=tu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?gh(e,e.limit,"L"):e}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class fu{constructor(){this._n=new pu}addToCollectionParentIndex(t,e){return this._n.add(e),Vr.resolve()}getCollectionParents(t,e){return Vr.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return Vr.resolve()}deleteFieldIndex(t,e){return Vr.resolve()}deleteAllFieldIndexes(t){return Vr.resolve()}createTargetIndexes(t,e){return Vr.resolve()}getDocumentsMatchingTarget(t,e){return Vr.resolve(null)}getIndexType(t,e){return Vr.resolve(0)}getFieldIndexes(t,e){return Vr.resolve([])}getNextCollectionGroupToUpdate(t){return Vr.resolve(null)}getMinOffset(t,e){return Vr.resolve(Or.min())}getMinOffsetFromCollectionGroup(t,e){return Vr.resolve(Or.min())}updateCollectionGroup(t,e,n){return Vr.resolve()}updateIndexEntries(t,e){return Vr.resolve()}}class pu{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new oa(Ar.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new oa(Ar.comparator)).toArray()}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class mu{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new mu(0)}static Ln(){return new mu(-1)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gu{constructor(){this.changes=new Th((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Ra.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Vr.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class _u{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class yu{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&ic(n.mutation,t,aa.empty(),Ir.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,Nh()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=Nh()){const i=Ph();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=Ih();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=Ph();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Nh())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let s=Sh();const o=kh(),r=kh();return e.forEach(((t,e)=>{const r=n.get(e.key);i.has(e.key)&&(void 0===r||r.mutation instanceof ac)?s=s.insert(e.key,e):void 0!==r?(o.set(e.key,r.mutation.getFieldMask()),ic(r.mutation,e,r.mutation.getFieldMask(),Ir.now())):o.set(e.key,aa.empty())})),this.recalculateAndSaveOverlays(t,s).next((t=>(t.forEach(((t,e)=>o.set(t,e))),e.forEach(((t,e)=>{var n;return r.set(t,new _u(e,null!==(n=o.get(t))&&void 0!==n?n:null))})),r)))}recalculateAndSaveOverlays(t,e){const n=kh();let i=new na(((t,e)=>t-e)),s=Nh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const s of t)s.keys().forEach((t=>{const o=e.get(t);if(null===o)return;let r=n.get(t)||aa.empty();r=s.applyToLocalView(o,r),n.set(t,r);const a=(i.get(s.batchId)||Nh()).add(t);i=i.insert(s.batchId,a)}))})).next((()=>{const o=[],r=i.getReverseIterator();for(;r.hasNext();){const i=r.getNext(),a=i.key,h=i.value,c=Ah();h.forEach((t=>{if(!s.has(t)){const i=ec(e.get(t),n.get(t));null!==i&&c.set(t,i),s=s.add(t)}})),o.push(this.documentOverlayCache.saveOverlays(t,a,c))}return Vr.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,i){return function(t){return Mr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):dh(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-s.size):Vr.resolve(Ph());let r=-1,a=s;return o.next((e=>Vr.forEach(e,((e,n)=>(r<n.largestBatchId&&(r=n.largestBatchId),s.get(e)?Vr.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,s))).next((()=>this.computeViews(t,a,e,Nh()))).next((t=>({batchId:r,changes:Lh(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Mr(e)).next((t=>{let e=Ih();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const s=e.collectionGroup;let o=Ih();return this.indexManager.getCollectionParents(t,s).next((r=>Vr.forEach(r,(r=>{const a=function(t,e){return new ch(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(s));return this.getDocumentsMatchingCollectionQuery(t,a,n,i).next((t=>{t.forEach(((t,e)=>{o=o.insert(t,e)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,s,i)))).next((t=>{s.forEach(((e,n)=>{const i=n.getKey();null===t.get(i)&&(t=t.insert(i,Ra.newInvalidDocument(i)))}));let n=Ih();return t.forEach(((t,i)=>{const o=s.get(t);void 0!==o&&ic(o.mutation,i,aa.empty(),Ir.now()),wh(e,i)&&(n=n.insert(t,i))})),n}))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class vu{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return Vr.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:jc(t.createTime)}}(e)),Vr.resolve()}getNamedQuery(t,e){return Vr.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:du(t.bundledQuery),readTime:jc(t.readTime)}}(e)),Vr.resolve()}}
/**
     * @license
     * Copyright 2022 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class wu{constructor(){this.overlays=new na(Mr.comparator),this.hr=new Map}getOverlay(t,e){return Vr.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Ph();return Vr.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ht(t,e,i)})),Vr.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.hr.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),Vr.resolve()}getOverlaysForCollection(t,e,n){const i=Ph(),s=e.length+1,o=new Mr(e.child("")),r=this.overlays.getIteratorFrom(o);for(;r.hasNext();){const t=r.getNext().value,o=t.getKey();if(!e.isPrefixOf(o.path))break;o.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Vr.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new na(((t,e)=>t-e));const o=this.overlays.getIterator();for(;o.hasNext();){const t=o.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=Ph(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const r=Ph(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>r.set(t,e))),!(r.size()>=i)););return Vr.resolve(r)}ht(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.hr.get(i.largestBatchId).delete(n.key);this.hr.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new mc(e,n));let s=this.hr.get(e);void 0===s&&(s=Nh(),this.hr.set(e,s)),this.hr.set(e,s.add(n.key))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bu{constructor(){this.Pr=new oa(xu.Ir),this.Tr=new oa(xu.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new xu(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new xu(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new Mr(new Ar([])),n=new xu(e,t),i=new xu(e,t+1),s=[];return this.Tr.forEachInRange([n,i],(t=>{this.Ar(t),s.push(t.key)})),s}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new Mr(new Ar([])),n=new xu(e,t),i=new xu(e,t+1);let s=Nh();return this.Tr.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new xu(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class xu{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return Mr.comparator(t.key,e.key)||Sr(t.pr,e.pr)}static Er(t,e){return Sr(t.pr,e.pr)||Mr.comparator(t.key,e.key)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Tu{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new oa(xu.Ir)}checkEmpty(t){return Vr.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new fc(s,e,n,i);this.mutationQueue.push(o);for(const e of i)this.wr=this.wr.add(new xu(e.key,s)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Vr.resolve(o)}lookupMutationBatch(t,e){return Vr.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.br(n),s=i<0?0:i;return Vr.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Vr.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return Vr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new xu(e,0),i=new xu(e,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,i],(t=>{const e=this.Sr(t.pr);s.push(e)})),Vr.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new oa(Sr);return e.forEach((t=>{const e=new xu(t,0),i=new xu(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,i],(t=>{n=n.add(t.pr)}))})),Vr.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;Mr.isDocumentKey(s)||(s=s.child(""));const o=new xu(new Mr(s),0);let r=new oa(Sr);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(r=r.add(t.pr)),!0)}),o),Vr.resolve(this.Dr(r))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){ur(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Vr.forEach(e.mutations,(i=>{const s=new xu(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new xu(e,0),i=this.wr.firstAfterOrEqual(n);return Vr.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,Vr.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Eu{constructor(t){this.vr=t,this.docs=new na(Mr.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,o=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Vr.resolve(n?n.document.mutableCopy():Ra.newInvalidDocument(e))}getEntries(t,e){let n=Sh();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Ra.newInvalidDocument(t))})),Vr.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let s=Sh();const o=e.path,r=new Mr(o.child("")),a=this.docs.getIteratorFrom(r);for(;a.hasNext();){const{key:t,value:{document:r}}=a.getNext();if(!o.isPrefixOf(t.path))break;t.path.length>o.length+1||Rr(Nr(r),n)<=0||(i.has(r.key)||wh(e,r))&&(s=s.insert(r.key,r.mutableCopy()))}return Vr.resolve(s)}getAllFromCollectionGroup(t,e,n,i){cr()}Fr(t,e){return Vr.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Su(this)}getSize(t){return Vr.resolve(this.size)}}class Su extends gu{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.ar.addEntry(t,i)):this.ar.removeEntry(n)})),Vr.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Cu{constructor(t){this.persistence=t,this.Mr=new Th((t=>rh(t)),ah),this.lastRemoteSnapshotVersion=Lr.min(),this.highestTargetId=0,this.Or=0,this.Nr=new bu,this.targetCount=0,this.Lr=mu.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),Vr.resolve()}getLastRemoteSnapshotVersion(t){return Vr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Vr.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Lr.next(),Vr.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),Vr.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Lr=new mu(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,Vr.resolve()}updateTargetData(t,e){return this.qn(e),Vr.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,Vr.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.Mr.forEach(((o,r)=>{r.sequenceNumber<=e&&null===n.get(r.targetId)&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(t,r.targetId)),i++)})),Vr.waitFor(s).next((()=>i))}getTargetCount(t){return Vr.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return Vr.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),Vr.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),Vr.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),Vr.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return Vr.resolve(n)}containsKey(t,e){return Vr.resolve(this.Nr.containsKey(e))}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Iu{constructor(t,e){this.Br={},this.overlays={},this.kr=new Qr(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Cu(this),this.indexManager=new fu,this.remoteDocumentCache=function(t){return new Eu(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new lu(e),this.$r=new vu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new wu,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Br[t.toKey()];return n||(n=new Tu(e,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){or("MemoryPersistence","Starting transaction:",t);const i=new Lu(this.kr.next());return this.referenceDelegate.Ur(),n(i).next((t=>this.referenceDelegate.Wr(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Gr(t,e){return Vr.or(Object.values(this.Br).map((n=>()=>n.containsKey(t,e))))}}class Lu extends Br{constructor(t){super(),this.currentSequenceNumber=t}}class Pu{constructor(t){this.persistence=t,this.zr=new bu,this.jr=null}static Hr(t){return new Pu(t)}get Jr(){if(this.jr)return this.jr;throw cr()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),Vr.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),Vr.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),Vr.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Vr.forEach(this.Jr,(n=>{const i=Mr.fromPath(n);return this.Yr(t,i).next((t=>{t||e.removeEntry(i,Lr.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return Vr.or([()=>Vr.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Au{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=i}static Ki(t,e){let n=Nh(),i=Nh();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Au(t,e.fromCache,n,i)}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ku{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Du{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=it()?8:jr.v(nt())>0?6:4}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,i){const s={result:null};return this.ji(t,e).next((t=>{s.result=t})).next((()=>{if(!s.result)return this.Hi(t,e,i,n).next((t=>{s.result=t}))})).next((()=>{if(s.result)return;const n=new ku;return this.Ji(t,e,n).next((i=>{if(s.result=i,this.Ui)return this.Yi(t,e,n,i.size)}))})).next((()=>s.result))}Yi(t,e,n,i){return n.documentReadCount<this.Wi?(sr()<=mt.DEBUG&&or("QueryEngine","SDK will not create cache indexes for query:",vh(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Vr.resolve()):(sr()<=mt.DEBUG&&or("QueryEngine","Query:",vh(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Gi*i?(sr()<=mt.DEBUG&&or("QueryEngine","The SDK decides to create cache indexes for query:",vh(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ph(e))):Vr.resolve())}ji(t,e){if(lh(e))return Vr.resolve(null);let n=ph(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=gh(e,null,"F"),n=ph(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const s=Nh(...i);return this.zi.getDocuments(t,s).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const o=this.Zi(e,i);return this.Xi(e,o,s,n.readTime)?this.ji(t,gh(e,null,"F")):this.es(t,o,e,n)}))))})))))}Hi(t,e,n,i){return lh(e)||i.isEqual(Lr.min())?Vr.resolve(null):this.zi.getDocuments(t,n).next((s=>{const o=this.Zi(e,s);return this.Xi(e,o,n,i)?Vr.resolve(null):(sr()<=mt.DEBUG&&or("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),vh(e)),this.es(t,o,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=Lr.fromTimestamp(1e9===i?new Ir(n+1,0):new Ir(n,i));return new Or(s,Mr.empty(),e)}(i,-1)).next((t=>t)))}))}Zi(t,e){let n=new oa(bh(t));return e.forEach(((e,i)=>{wh(t,i)&&(n=n.add(i))})),n}Xi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(t,e,n){return sr()<=mt.DEBUG&&or("QueryEngine","Using full collection scan to execute query:",vh(e)),this.zi.getDocumentsMatchingQuery(t,e,Or.min(),n)}es(t,e,n,i){return this.zi.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Mu{constructor(t,e,n,i){this.persistence=t,this.ts=e,this.serializer=i,this.ns=new na(Sr),this.rs=new Th((t=>rh(t)),ah),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new yu(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function Nu(t,e){const n=lr(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const s=[],o=[];let r=Nh();for(const t of i){s.push(t.batchId);for(const e of t.mutations)r=r.add(e.key)}for(const t of e){o.push(t.batchId);for(const e of t.mutations)r=r.add(e.key)}return n.localDocuments.getDocuments(t,r).next((t=>({us:t,removedBatchIds:s,addedBatchIds:o})))}))}))}function Ou(t){const e=lr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}function Ru(t,e){const n=lr(t),i=e.snapshotVersion;let s=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const o=n.os.newChangeBuffer({trackRemovals:!0});s=n.ns;const r=[];e.targetChanges.forEach(((o,a)=>{const h=s.get(a);if(!h)return;r.push(n.Qr.removeMatchingKeys(t,o.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(t,o.addedDocuments,a))));let c=h.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?c=c.withResumeToken(ca.EMPTY_BYTE_STRING,Lr.min()).withLastLimboFreeSnapshotVersion(Lr.min()):o.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(o.resumeToken,i)),s=s.insert(a,c),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(h,c,o)&&r.push(n.Qr.updateTargetData(t,c))}));let a=Sh(),h=Nh();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&r.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),r.push(function(t,e,n){let i=Nh(),s=Nh();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=Sh();return n.forEach(((n,o)=>{const r=t.get(n);o.isFoundDocument()!==r.isFoundDocument()&&(s=s.add(n)),o.isNoDocument()&&o.version.isEqual(Lr.min())?(e.removeEntry(n,o.readTime),i=i.insert(n,o)):!r.isValidDocument()||o.version.compareTo(r.version)>0||0===o.version.compareTo(r.version)&&r.hasPendingWrites?(e.addEntry(o),i=i.insert(n,o)):or("LocalStore","Ignoring outdated watch update for ",n,". Current version:",r.version," Watch version:",o.version)})),{cs:i,ls:s}}))}(t,o,e.documentUpdates).next((t=>{a=t.cs,h=t.ls}))),!i.isEqual(Lr.min())){const e=n.Qr.getLastRemoteSnapshotVersion(t).next((e=>n.Qr.setTargetsMetadata(t,t.currentSequenceNumber,i)));r.push(e)}return Vr.waitFor(r).next((()=>o.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,h))).next((()=>a))})).then((t=>(n.ns=s,t)))}function zu(t,e){const n=lr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function Bu(t,e,n){const i=lr(t),s=i.ns.get(e),o=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",o,(t=>i.persistence.referenceDelegate.removeTarget(t,s)))}catch(t){if(!qr(t))throw t;or("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.ns=i.ns.remove(e),i.rs.delete(s.target)}function Fu(t,e,n){const i=lr(t);let s=Lr.min(),o=Nh();return i.persistence.runTransaction("Execute query","readwrite",(t=>function(t,e,n){const i=lr(t),s=i.rs.get(n);return void 0!==s?Vr.resolve(i.ns.get(s)):i.Qr.getTargetData(e,n)}(i,t,ph(e)).next((e=>{if(e)return s=e.lastLimboFreeSnapshotVersion,i.Qr.getMatchingKeysForTargetId(t,e.targetId).next((t=>{o=t}))})).next((()=>i.ts.getDocumentsMatchingQuery(t,e,n?s:Lr.min(),n?o:Nh()))).next((t=>(function(t,e,n){let i=t.ss.get(e)||Lr.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.ss.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,hs:o})))))}class Vu{constructor(){this.activeTargetIds=Oh}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Uu{constructor(){this.no=new Vu,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new Vu,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ju{io(t){}shutdown(){}}
/**
     * @license
     * Copyright 2019 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Zu{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */let $u=null;function qu(){return null===$u?$u=268435456+Math.round(2147483648*Math.random()):$u++,"0x"+$u.toString(16)
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const Hu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gu{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Ku="WebChannelConnection";class Wu extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${i}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${i}`}get wo(){return!1}So(t,e,n,i,s){const o=qu(),r=this.bo(t,e.toUriEncodedString());or("RestConnection",`Sending RPC '${t}' ${o}:`,r,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,i,s),this.Co(t,r,a,n).then((e=>(or("RestConnection",`Received RPC '${t}' ${o}: `,e),e)),(e=>{throw ar("RestConnection",`RPC '${t}' ${o} failed with error: `,e,"url: ",r,"request:",n),e}))}vo(t,e,n,i,s,o){return this.So(t,e,n,i,s)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+nr,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=Hu[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,i){const s=qu();return new Promise(((o,r)=>{const a=new Yo;a.setWithCredentials(!0),a.listenOnce(Ho.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case qo.NO_ERROR:const e=a.getResponseJson();or(Ku,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(e)),o(e);break;case qo.TIMEOUT:or(Ku,`RPC '${t}' ${s} timed out`),r(new fr(dr.DEADLINE_EXCEEDED,"Request time out"));break;case qo.HTTP_ERROR:const n=a.getStatus();if(or(Ku,`RPC '${t}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(dr).indexOf(e)>=0?e:dr.UNKNOWN}(e.status);r(new fr(t,e.message))}else r(new fr(dr.UNKNOWN,"Server responded with status "+a.getStatus()))}else r(new fr(dr.UNAVAILABLE,"Connection failed."));break;default:cr()}}finally{or(Ku,`RPC '${t}' ${s} completed.`)}}));const h=JSON.stringify(i);or(Ku,`RPC '${t}' ${s} sending request:`,i),a.send(e,"POST",h,n,15)}))}Fo(t,e,n){const i=qu(),s=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=new bo,r=yi(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;void 0!==h&&(a.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const c=s.join("");or(Ku,`Creating RPC '${t}' stream ${i}: ${c}`,a);const u=o.createWebChannel(c,a);let l=!1,d=!1;const f=new Gu({lo:e=>{d?or(Ku,`Not sending because RPC '${t}' stream ${i} is closed:`,e):(l||(or(Ku,`Opening RPC '${t}' stream ${i} transport.`),u.open(),l=!0),or(Ku,`RPC '${t}' stream ${i} sending:`,e),u.send(e))},ho:()=>u.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,Qo.EventType.OPEN,(()=>{d||or(Ku,`RPC '${t}' stream ${i} transport opened.`)})),p(u,Qo.EventType.CLOSE,(()=>{d||(d=!0,or(Ku,`RPC '${t}' stream ${i} transport closed`),f.Vo())})),p(u,Qo.EventType.ERROR,(e=>{d||(d=!0,ar(Ku,`RPC '${t}' stream ${i} transport errored:`,e),f.Vo(new fr(dr.UNAVAILABLE,"The operation could not be completed")))})),p(u,Qo.EventType.MESSAGE,(e=>{var n;if(!d){const s=e.data[0];ur(!!s);const o=s,r=o.error||(null===(n=o[0])||void 0===n?void 0:n.error);if(r){or(Ku,`RPC '${t}' stream ${i} received error:`,r);const e=r.status;let n=function(t){const e=_c[t];if(void 0!==e)return vc(e)}(e),s=r.message;void 0===n&&(n=dr.INTERNAL,s="Unknown error status: "+e+" with message "+r.message),d=!0,f.Vo(new fr(n,s)),u.close()}else or(Ku,`RPC '${t}' stream ${i} received:`,s),f.mo(s)}})),p(r,Go.STAT_EVENT,(e=>{e.stat===Ko?or(Ku,`RPC '${t}' stream ${i} detected buffering proxy`):e.stat===Wo&&or(Ku,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function Qu(){return"undefined"!=typeof document?document:null}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Yu(t){return new zc(t,!0)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Xu{constructor(t,e,n=1e3,i=1.5,s=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=i,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Bo),i=Math.max(0,e-n);i>0&&or("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Bo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ju{constructor(t,e,n,i,s,o,r,a){this.oi=t,this.$o=n,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=r,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Xu(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===dr.RESOURCE_EXHAUSTED?(rr(e.toString()),rr("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===dr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new fr(dr.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return or("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class tl extends Ju{constructor(t,e,n,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,o),this.serializer=s}a_(t,e){return this.connection.Fo("Listen",t,e)}onMessage(t){this.jo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:cr()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(t,e){return t.useProto3Json?(ur(void 0===e||"string"==typeof e),ca.fromBase64String(e||"")):(ur(void 0===e||e instanceof Uint8Array),ca.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),r=e.targetChange.cause,a=r&&function(t){const e=void 0===t.code?dr.UNKNOWN:vc(t.code);return new fr(e,t.message||"")}(r);n=new Pc(i,s,o,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Gc(t,i.document.name),o=jc(i.document.updateTime),r=i.document.createTime?jc(i.document.createTime):Lr.min(),a=new Na({mapValue:{fields:i.document.fields}}),h=Ra.newFoundDocument(s,o,r,a),c=i.targetIds||[],u=i.removedTargetIds||[];n=new Ic(c,u,h.key,h)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Gc(t,i.document),o=i.readTime?jc(i.readTime):Lr.min(),r=Ra.newNoDocument(s,o),a=i.removedTargetIds||[];n=new Ic([],a,r.key,r)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Gc(t,i.document),o=i.removedTargetIds||[];n=new Ic([],o,s,null)}else{if(!("filter"in e))return cr();{e.filter;const t=e.filter;t.targetId;const{count:i=0,unchangedNames:s}=t,o=new gc(i,s),r=t.targetId;n=new Lc(r,o)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Lr.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Lr.min():e.readTime?jc(e.readTime):Lr.min()}(t);return this.listener.u_(e,n)}c_(t){const e={};e.database=Wc(this.serializer),e.addTarget=function(t,e){let n;const i=e.target;if(n=hh(i)?{documents:Xc(t,i)}:{query:Jc(t,i).ut},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=Vc(t,e.resumeToken);const i=Bc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}else if(e.snapshotVersion.compareTo(Lr.min())>0){n.readTime=Fc(t,e.snapshotVersion.toTimestamp());const i=Bc(t,e.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return cr()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.t_(e)}l_(t){const e={};e.database=Wc(this.serializer),e.removeTarget=t,this.t_(e)}}class el extends Ju{constructor(t,e,n,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(ur(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(ur(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?jc(t.updateTime):jc(e);return n.isEqual(Lr.min())&&(n=jc(e)),new Yh(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=jc(t.commitTime);return this.listener.T_(n,e)}return ur(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=Wc(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof rc)n={update:Yc(t,e.key,e.value)};else if(e instanceof lc)n={delete:Hc(t,e.key)};else if(e instanceof ac)n={update:Yc(t,e.key,e.data),updateMask:hu(e.fieldMask)};else{if(!(e instanceof dc))return cr();n={verify:Hc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Zh)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof $h)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Hh)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Kh)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw cr()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Uc(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:cr()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class nl extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new fr(dr.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.So(t,$c(e,n),i,s,o))).catch((t=>{throw"FirebaseError"===t.name?(t.code===dr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new fr(dr.UNKNOWN,t.toString())}))}vo(t,e,n,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,r])=>this.connection.vo(t,$c(e,n),i,o,r,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===dr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new fr(dr.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class il{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(rr(e),this.g_=!1):or("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class sl{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io((t=>{n.enqueueAndForget((async()=>{fl(this)&&(or("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=lr(t);e.v_.add(4),await rl(e),e.x_.set("Unknown"),e.v_.delete(4),await ol(e)}(this))}))})),this.x_=new il(n,i)}}async function ol(t){if(fl(t))for(const e of t.F_)await e(!0)}async function rl(t){for(const e of t.F_)await e(!1)}function al(t,e){const n=lr(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),dl(n)?ll(n):Al(n).Jo()&&cl(n,e))}function hl(t,e){const n=lr(t),i=Al(n);n.C_.delete(e),i.Jo()&&ul(n,e),0===n.C_.size&&(i.Jo()?i.Xo():fl(n)&&n.x_.set("Unknown"))}function cl(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Lr.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Al(t).c_(e)}function ul(t,e){t.O_.Oe(e),Al(t).l_(e)}function ll(t){t.O_=new kc({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Al(t).start(),t.x_.p_()}function dl(t){return fl(t)&&!Al(t).Ho()&&t.C_.size>0}function fl(t){return 0===lr(t).v_.size}function pl(t){t.O_=void 0}async function ml(t){t.C_.forEach(((e,n)=>{cl(t,e)}))}async function gl(t,e){pl(t),dl(t)?(t.x_.S_(e),ll(t)):t.x_.set("Unknown")}async function _l(t,e,n){if(t.x_.set("Online"),e instanceof Pc&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.C_.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.C_.delete(i),t.O_.removeTarget(i))}(t,e)}catch(n){or("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await yl(t,n)}else if(e instanceof Ic?t.O_.$e(e):e instanceof Lc?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(Lr.min()))try{const e=await Ou(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.O_.it(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const s=t.C_.get(i);s&&t.C_.set(i,s.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach(((e,n)=>{const i=t.C_.get(e);if(!i)return;t.C_.set(e,i.withResumeToken(ca.EMPTY_BYTE_STRING,i.snapshotVersion)),ul(t,e);const s=new uu(i.target,e,n,i.sequenceNumber);cl(t,s)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){or("RemoteStore","Failed to raise snapshot:",e),await yl(t,e)}}async function yl(t,e,n){if(!qr(e))throw e;t.v_.add(1),await rl(t),t.x_.set("Offline"),n||(n=()=>Ou(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{or("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await ol(t)}))}function vl(t,e){return e().catch((n=>yl(t,n,e)))}async function wl(t){const e=lr(t),n=kl(e);let i=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;bl(e);)try{const t=await zu(e.localStore,i);if(null===t){0===e.D_.length&&n.Xo();break}i=t.batchId,xl(e,t)}catch(t){await yl(e,t)}Tl(e)&&El(e)}function bl(t){return fl(t)&&t.D_.length<10}function xl(t,e){t.D_.push(e);const n=kl(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function Tl(t){return fl(t)&&!kl(t).Ho()&&t.D_.length>0}function El(t){kl(t).start()}async function Sl(t){kl(t).d_()}async function Cl(t){const e=kl(t);for(const n of t.D_)e.I_(n.mutations)}async function Il(t,e,n){const i=t.D_.shift(),s=pc.from(i,e,n);await vl(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await wl(t)}async function Ll(t,e){e&&kl(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return cr();case dr.CANCELLED:case dr.UNKNOWN:case dr.DEADLINE_EXCEEDED:case dr.RESOURCE_EXHAUSTED:case dr.INTERNAL:case dr.UNAVAILABLE:case dr.UNAUTHENTICATED:return!1;case dr.INVALID_ARGUMENT:case dr.NOT_FOUND:case dr.ALREADY_EXISTS:case dr.PERMISSION_DENIED:case dr.FAILED_PRECONDITION:case dr.ABORTED:case dr.OUT_OF_RANGE:case dr.UNIMPLEMENTED:case dr.DATA_LOSS:return!0}}(t)&&t!==dr.ABORTED}(e.code)){const n=t.D_.shift();kl(t).Zo(),await vl(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await wl(t)}}(t,e),Tl(t)&&El(t)}async function Pl(t,e){const n=lr(t);n.asyncQueue.verifyOperationInProgress(),or("RemoteStore","RemoteStore received new credentials");const i=fl(n);n.v_.add(3),await rl(n),i&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await ol(n)}function Al(t){return t.N_||(t.N_=function(t,e,n){const i=lr(t);return i.R_(),new tl(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}(t.datastore,t.asyncQueue,{Po:ml.bind(null,t),To:gl.bind(null,t),u_:_l.bind(null,t)}),t.F_.push((async e=>{e?(t.N_.Zo(),dl(t)?ll(t):t.x_.set("Unknown")):(await t.N_.stop(),pl(t))}))),t.N_}function kl(t){return t.L_||(t.L_=function(t,e,n){const i=lr(t);return i.R_(),new el(e,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(t.datastore,t.asyncQueue,{Po:Sl.bind(null,t),To:Ll.bind(null,t),E_:Cl.bind(null,t),T_:Il.bind(null,t)}),t.F_.push((async e=>{e?(t.L_.Zo(),await wl(t)):(await t.L_.stop(),t.D_.length>0&&(or("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.L_
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}class Dl{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new pr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,s){const o=Date.now()+n,r=new Dl(t,e,o,i,s);return r.start(n),r}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new fr(dr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ml(t,e){if(rr("AsyncQueue",`${e}: ${t}`),qr(t))return new fr(dr.UNAVAILABLE,`${e}: ${t}`);throw t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Nl{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Mr.comparator(e.key,n.key):(t,e)=>Mr.comparator(t.key,e.key),this.keyedMap=Ih(),this.sortedSet=new na(this.comparator)}static emptySet(t){return new Nl(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Nl))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Nl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Ol{constructor(){this.B_=new na(Mr.comparator)}track(t){const e=t.doc.key,n=this.B_.get(e);n?0!==t.type&&3===n.type?this.B_=this.B_.insert(e,t):3===t.type&&1!==n.type?this.B_=this.B_.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.B_=this.B_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.B_=this.B_.remove(e):1===t.type&&2===n.type?this.B_=this.B_.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):cr():this.B_=this.B_.insert(e,t)}k_(){const t=[];return this.B_.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Rl{constructor(t,e,n,i,s,o,r,a,h){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=r,this.excludesMetadataChanges=a,this.hasCachedResults=h}static fromInitialDocuments(t,e,n,i,s){const o=[];return e.forEach((t=>{o.push({type:0,doc:t})})),new Rl(t,e,Nl.emptySet(e),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&_h(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let t=0;t<e.length;t++)if(e[t].type!==n[t].type||!e[t].doc.isEqual(n[t].doc))return!1;return!0}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zl{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some((t=>t.U_()))}}class Bl{constructor(){this.queries=new Th((t=>yh(t)),_h),this.onlineState="Unknown",this.W_=new Set}}function Fl(t,e){const n=lr(t);let i=!1;for(const t of e){const e=t.query,s=n.queries.get(e);if(s){for(const e of s.Q_)e.z_(t)&&(i=!0);s.q_=t}}i&&Ul(n)}function Vl(t,e,n){const i=lr(t),s=i.queries.get(e);if(s)for(const t of s.Q_)t.onError(n);i.queries.delete(e)}function Ul(t){t.W_.forEach((t=>{t.next()}))}var jl,Zl;(Zl=jl||(jl={})).j_="default",Zl.Cache="cache";class $l{constructor(t,e,n){this.query=t,this.H_=e,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=n||{}}z_(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Rl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.J_?this.Z_(t)&&(this.H_.next(t),e=!0):this.X_(t,this.onlineState)&&(this.ea(t),e=!0),this.Y_=t,e}onError(t){this.H_.error(t)}G_(t){this.onlineState=t;let e=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,t)&&(this.ea(this.Y_),e=!0),e}X_(t,e){if(!t.fromCache)return!0;if(!this.U_())return!0;const n="Offline"!==e;return(!this.options.ta||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Z_(t){if(t.docChanges.length>0)return!0;const e=this.Y_&&this.Y_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}ea(t){t=Rl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.J_=!0,this.H_.next(t)}U_(){return this.options.source!==jl.Cache}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ql{constructor(t){this.key=t}}class Hl{constructor(t){this.key=t}}class Gl{constructor(t,e){this.query=t,this.ua=e,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=Nh(),this.mutatedKeys=Nh(),this.ha=bh(t),this.Pa=new Nl(this.ha)}get Ia(){return this.ua}Ta(t,e){const n=e?e.Ea:new Ol,i=e?e.Pa:this.Pa;let s=e?e.mutatedKeys:this.mutatedKeys,o=i,r=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,h="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const c=i.get(t),u=wh(this.query,e)?e:null,l=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?l!==d&&(n.track({type:3,doc:u}),f=!0):this.da(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ha(u,a)>0||h&&this.ha(u,h)<0)&&(r=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||h)&&(r=!0)),f&&(u?(o=o.add(u),s=d?s.add(t):s.delete(t)):(o=o.delete(t),s=s.delete(t)))})),null!==this.query.limit)for(;o.size>this.query.limit;){const t="F"===this.query.limitType?o.last():o.first();o=o.delete(t.key),s=s.delete(t.key),n.track({type:1,doc:t})}return{Pa:o,Ea:n,Xi:r,mutatedKeys:s}}da(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const s=this.Pa;this.Pa=t.Pa,this.mutatedKeys=t.mutatedKeys;const o=t.Ea.k_();o.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return cr()}};return n(t)-n(e)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t.type,e.type)||this.ha(t.doc,e.doc))),this.Aa(n),i=null!=i&&i;const r=e&&!i?this.Ra():[],a=0===this.la.size&&this.current&&!i?1:0,h=a!==this.ca;return this.ca=a,0!==o.length||h?{snapshot:new Rl(this.query,t.Pa,s,o,t.mutatedKeys,0===a,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),Va:r}:{Va:r}}G_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new Ol,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(t){return!this.ua.has(t)&&!!this.Pa.has(t)&&!this.Pa.get(t).hasLocalMutations}Aa(t){t&&(t.addedDocuments.forEach((t=>this.ua=this.ua.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.ua=this.ua.delete(t))),this.current=t.current)}Ra(){if(!this.current)return[];const t=this.la;this.la=Nh(),this.Pa.forEach((t=>{this.ma(t.key)&&(this.la=this.la.add(t.key))}));const e=[];return t.forEach((t=>{this.la.has(t)||e.push(new Hl(t))})),this.la.forEach((n=>{t.has(n)||e.push(new ql(n))})),e}fa(t){this.ua=t.hs,this.la=Nh();const e=this.Ta(t.documents);return this.applyChanges(e,!0)}ga(){return Rl.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,0===this.ca,this.hasCachedResults)}}class Kl{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Wl{constructor(t){this.key=t,this.pa=!1}}class Ql{constructor(t,e,n,i,s,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Th((t=>yh(t)),_h),this.Sa=new Map,this.ba=new Set,this.Da=new na(Mr.comparator),this.Ca=new Map,this.va=new bu,this.Fa={},this.Ma=new Map,this.xa=mu.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}async function Yl(t,e,n=!0){const i=yd(t);let s;const o=i.wa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.ga()):s=await Jl(i,e,n,!0),s}async function Xl(t,e){const n=yd(t);await Jl(n,e,!0,!1)}async function Jl(t,e,n,i){const s=await function(t,e){const n=lr(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Qr.getTargetData(t,e).next((s=>s?(i=s,Vr.resolve(i)):n.Qr.allocateTargetId(t).next((s=>(i=new uu(e,s,"TargetPurposeListen",t.currentSequenceNumber),n.Qr.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.ns.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(t.targetId,t),n.rs.set(e,t.targetId)),t}))}(t.localStore,ph(e)),o=s.targetId,r=n?t.sharedClientState.addLocalQueryTarget(o):"not-current";let a;return i&&(a=await async function(t,e,n,i,s){t.Na=(e,n,i)=>async function(t,e,n,i){let s=e.view.Ta(n);s.Xi&&(s=await Fu(t.localStore,e.query,!1).then((({documents:t})=>e.view.Ta(t,s))));const o=i&&i.targetChanges.get(e.targetId),r=i&&null!=i.targetMismatches.get(e.targetId),a=e.view.applyChanges(s,t.isPrimaryClient,o,r);return dd(t,e.targetId,a.Va),a.snapshot}(t,e,n,i);const o=await Fu(t.localStore,e,!0),r=new Gl(e,o.hs),a=r.Ta(o.documents),h=Cc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState,s),c=r.applyChanges(a,t.isPrimaryClient,h);dd(t,n,c.Va);const u=new Kl(e,n,r);return t.wa.set(e,u),t.Sa.has(n)?t.Sa.get(n).push(e):t.Sa.set(n,[e]),c.snapshot}(t,e,o,"current"===r,s.resumeToken)),t.isPrimaryClient&&n&&al(t.remoteStore,s),a}async function td(t,e,n){const i=lr(t),s=i.wa.get(e),o=i.Sa.get(s.targetId);if(o.length>1)return i.Sa.set(s.targetId,o.filter((t=>!_h(t,e)))),void i.wa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Bu(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),n&&hl(i.remoteStore,s.targetId),ud(i,s.targetId)})).catch(Fr)):(ud(i,s.targetId),await Bu(i.localStore,s.targetId,!0))}async function ed(t,e){const n=lr(t),i=n.wa.get(e),s=n.Sa.get(i.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),hl(n.remoteStore,i.targetId))}async function nd(t,e,n){const i=function(t){const e=lr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rd.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ad.bind(null,e),e}(t);try{const t=await function(t,e){const n=lr(t),i=Ir.now(),s=e.reduce(((t,e)=>t.add(e.key)),Nh());let o,r;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Sh(),h=Nh();return n.os.getEntries(t,s).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(h=h.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((s=>{o=s;const r=[];for(const t of e){const e=sc(t,o.get(t.key).overlayedDocument);null!=e&&r.push(new ac(t.key,e,Oa(e.value.mapValue),Xh.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,r,e)})).next((e=>{r=e;const i=e.applyToLocalDocumentSet(o,h);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:r.batchId,changes:Lh(o)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Fa[t.currentUser.toKey()];i||(i=new na(Sr)),i=i.insert(e,n),t.Fa[t.currentUser.toKey()]=i}(i,t.batchId,n),await md(i,t.changes),await wl(i.remoteStore)}catch(t){const e=Ml(t,"Failed to persist write");n.reject(e)}}async function id(t,e){const n=lr(t);try{const t=await Ru(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.Ca.get(e);i&&(ur(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.pa=!0:t.modifiedDocuments.size>0?ur(i.pa):t.removedDocuments.size>0&&(ur(i.pa),i.pa=!1))})),await md(n,t,e)}catch(t){await Fr(t)}}function sd(t,e,n){const i=lr(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.wa.forEach(((n,i)=>{const s=i.view.G_(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=lr(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.G_(e)&&(i=!0)})),i&&Ul(n)}(i.eventManager,e),t.length&&i.ya.u_(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function od(t,e,n){const i=lr(t);i.sharedClientState.updateQueryState(e,"rejected",n);const s=i.Ca.get(e),o=s&&s.key;if(o){let t=new na(Mr.comparator);t=t.insert(o,Ra.newNoDocument(o,Lr.min()));const n=Nh().add(o),s=new Sc(Lr.min(),new Map,new na(Sr),t,n);await id(i,s),i.Da=i.Da.remove(o),i.Ca.delete(e),pd(i)}else await Bu(i.localStore,e,!1).then((()=>ud(i,e,n))).catch(Fr)}async function rd(t,e){const n=lr(t),i=e.batch.batchId;try{const t=await function(t,e){const n=lr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,o=s.keys();let r=Vr.resolve();return o.forEach((t=>{r=r.next((()=>i.getEntry(e,t))).next((e=>{const o=n.docVersions.get(t);ur(null!==o),e.version.compareTo(o)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),r.next((()=>t.mutationQueue.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=Nh();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);cd(n,i,null),hd(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await md(n,t)}catch(t){await Fr(t)}}async function ad(t,e,n){const i=lr(t);try{const t=await function(t,e){const n=lr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(ur(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);cd(i,e,n),hd(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await md(i,t)}catch(n){await Fr(n)}}function hd(t,e){(t.Ma.get(e)||[]).forEach((t=>{t.resolve()})),t.Ma.delete(e)}function cd(t,e,n){const i=lr(t);let s=i.Fa[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.Fa[i.currentUser.toKey()]=s}}function ud(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Sa.get(e))t.wa.delete(i),n&&t.ya.La(i,n);t.Sa.delete(e),t.isPrimaryClient&&t.va.Vr(e).forEach((e=>{t.va.containsKey(e)||ld(t,e)}))}function ld(t,e){t.ba.delete(e.path.canonicalString());const n=t.Da.get(e);null!==n&&(hl(t.remoteStore,n),t.Da=t.Da.remove(e),t.Ca.delete(n),pd(t))}function dd(t,e,n){for(const i of n)i instanceof ql?(t.va.addReference(i.key,e),fd(t,i)):i instanceof Hl?(or("SyncEngine","Document no longer in limbo: "+i.key),t.va.removeReference(i.key,e),t.va.containsKey(i.key)||ld(t,i.key)):cr()}function fd(t,e){const n=e.key,i=n.path.canonicalString();t.Da.get(n)||t.ba.has(i)||(or("SyncEngine","New document in limbo: "+n),t.ba.add(i),pd(t))}function pd(t){for(;t.ba.size>0&&t.Da.size<t.maxConcurrentLimboResolutions;){const e=t.ba.values().next().value;t.ba.delete(e);const n=new Mr(Ar.fromString(e)),i=t.xa.next();t.Ca.set(i,new Wl(n)),t.Da=t.Da.insert(n,i),al(t.remoteStore,new uu(ph(uh(n.path)),i,"TargetPurposeLimboResolution",Qr._e))}}async function md(t,e,n){const i=lr(t),s=[],o=[],r=[];i.wa.isEmpty()||(i.wa.forEach(((t,a)=>{r.push(i.Na(a,e,n).then((t=>{if((t||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){s.push(t);const e=Au.Ki(a.targetId,t);o.push(e)}})))})),await Promise.all(r),i.ya.u_(s),await async function(t,e){const n=lr(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Vr.forEach(e,(e=>Vr.forEach(e.qi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Vr.forEach(e.Qi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!qr(t))throw t;or("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),i=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(i);n.ns=n.ns.insert(e,s)}}}(i.localStore,o))}async function gd(t,e){const n=lr(t);if(!n.currentUser.isEqual(e)){or("SyncEngine","User change. New user:",e.toKey());const t=await Nu(n.localStore,e);n.currentUser=e,function(t,e){t.Ma.forEach((t=>{t.forEach((t=>{t.reject(new fr(dr.CANCELLED,e))}))})),t.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await md(n,t.us)}}function _d(t,e){const n=lr(t),i=n.Ca.get(e);if(i&&i.pa)return Nh().add(i.key);{let t=Nh();const i=n.Sa.get(e);if(!i)return t;for(const e of i){const i=n.wa.get(e);t=t.unionWith(i.view.Ia)}return t}}function yd(t){const e=lr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=id.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_d.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=od.bind(null,e),e.ya.u_=Fl.bind(null,e.eventManager),e.ya.La=Vl.bind(null,e.eventManager),e}class vd{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Yu(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,i){return new Mu(t,e,n,i)}(this.persistence,new Du,t.initialUser,this.serializer)}createPersistence(t){return new Iu(Pu.Hr,this.serializer)}createSharedClientState(t){return new Uu}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class wd{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>sd(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=gd.bind(null,this.syncEngine),await async function(t,e){const n=lr(t);e?(n.v_.delete(2),await ol(n)):e||(n.v_.add(2),await rl(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Bl}createDatastore(t){const e=Yu(t.databaseInfo.databaseId),n=function(t){return new Wu(t)}(t.databaseInfo);return function(t,e,n,i){return new nl(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,i,s){return new sl(t,e,n,i,s)}(this.localStore,this.datastore,t.asyncQueue,(t=>sd(this.syncEngine,t,0)),Zu.D()?new Zu:new ju)}createSyncEngine(t,e){return function(t,e,n,i,s,o,r){const a=new Ql(t,e,n,i,s,o);return r&&(a.Oa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=lr(t);or("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await rl(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class bd{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.qa(this.observer.next,t)}error(t){this.observer.error?this.qa(this.observer.error,t):rr("Uncaught Error in snapshot listener:",t.toString())}Qa(){this.muted=!0}qa(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class xd{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=er.UNAUTHENTICATED,this.clientId=Er.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{or("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(or("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new fr(dr.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new pr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Ml(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Td(t,e){t.asyncQueue.verifyOperationInProgress(),or("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Nu(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Ed(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){or("FirestoreClient","Using user provided OfflineComponentProvider");try{await Td(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===dr.FAILED_PRECONDITION||t.code===dr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;ar("Error using user provided cache. Falling back to memory cache: "+n),await Td(t,new vd)}}else or("FirestoreClient","Using default OfflineComponentProvider"),await Td(t,new vd);return t._offlineComponents}(t);or("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>Pl(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Pl(e.remoteStore,n))),t._onlineComponents=e}async function Sd(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(or("FirestoreClient","Using user provided OnlineComponentProvider"),await Ed(t,t._uninitializedComponentsProvider._online)):(or("FirestoreClient","Using default OnlineComponentProvider"),await Ed(t,new wd))),t._onlineComponents}async function Cd(t){const e=await Sd(t),n=e.eventManager;return n.onListen=Yl.bind(null,e.syncEngine),n.onUnlisten=td.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Xl.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ed.bind(null,e.syncEngine),n
/**
     * @license
     * Copyright 2023 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}function Id(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}const Ld=new Map;
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Pd(t,e,n){if(!n)throw new fr(dr.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ad(t){if(!Mr.isDocumentKey(t))throw new fr(dr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function kd(t){if(Mr.isDocumentKey(t))throw new fr(dr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Dd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":cr()}function Md(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new fr(dr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Dd(t);throw new fr(dr.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Nd{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new fr(dr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new fr(dr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,i){if(!0===e&&!0===i)throw new fr(dr.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Id(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new fr(dr.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new fr(dr.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new fr(dr.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Od{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nd({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new fr(dr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new fr(dr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nd(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new gr;switch(t.type){case"firstParty":return new wr(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new fr(dr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Ld.get(t);e&&(or("ComponentProvider","Removing Datastore"),Ld.delete(t),e.terminate())}(this),Promise.resolve()}}function Rd(t,e,n,i={}){var s;const o=(t=Md(t,Od))._getSettings(),r=`${e}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==r&&ar("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:r,ssl:!1})),i.mockUserToken){let e,n;if("string"==typeof i.mockUserToken)e=i.mockUserToken,n=er.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[W(JSON.stringify({alg:"none",type:"JWT"})),W(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new fr(dr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new er(o)}t._authCredentials=new _r(new mr(e,n))}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class zd{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new zd(this.firestore,t,this._query)}}class Bd{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fd(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Bd(this.firestore,t,this._key)}}class Fd extends zd{constructor(t,e,n){super(t,e,uh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Bd(this.firestore,null,new Mr(t))}withConverter(t){return new Fd(this.firestore,t,this._path)}}function Vd(t,e,...n){if(t=ut(t),Pd("collection","path",e),t instanceof Od){const i=Ar.fromString(e,...n);return kd(i),new Fd(t,null,i)}{if(!(t instanceof Bd||t instanceof Fd))throw new fr(dr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ar.fromString(e,...n));return kd(i),new Fd(t.firestore,null,i)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Ud{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new Xu(this,"async_queue_retry"),this.cu=()=>{const t=Qu();t&&or("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=Qu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.lu(),this.hu(t)}enterRestrictedMode(t){if(!this.iu){this.iu=!0,this.au=t||!1;const e=Qu();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.cu)}}enqueue(t){if(this.lu(),this.iu)return new Promise((()=>{}));const e=new pr;return this.hu((()=>this.iu&&this.au?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.ru.push(t),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(t){if(!qr(t))throw t;or("AsyncQueue","Operation failed with retryable error: "+t)}this.ru.length>0&&this.jo.qo((()=>this.Pu()))}}hu(t){const e=this.nu.then((()=>(this._u=!0,t().catch((t=>{this.ou=t,this._u=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t);throw rr("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this._u=!1,t))))));return this.nu=e,e}enqueueAfterDelay(t,e,n){this.lu(),this.uu.indexOf(t)>-1&&(e=0);const i=Dl.createAndSchedule(this,t,e,n,(t=>this.Iu(t)));return this.su.push(i),i}lu(){this.ou&&cr()}verifyOperationInProgress(){}async Tu(){let t;do{t=this.nu,await t}while(t!==this.nu)}Eu(t){for(const e of this.su)if(e.timerId===t)return!0;return!1}du(t){return this.Tu().then((()=>{this.su.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.su)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Tu()}))}Au(t){this.uu.push(t)}Iu(t){const e=this.su.indexOf(t);this.su.splice(e,1)}}function jd(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const t of e)if(t in n&&"function"==typeof n[t])return!0;return!1}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t,["next","error","complete"])}class Zd extends Od{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new Ud,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||qd(this),this._firestoreClient.terminate()}}function $d(t){return t._firestoreClient||qd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function qd(t){var e,n,i;const s=t._freezeSettings(),o=function(t,e,n,i){return new _a(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Id(i.experimentalLongPollingOptions),i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new xd(t._authCredentials,t._appCheckCredentials,t._queue,o),(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=s.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Hd{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Hd(ca.fromBase64String(t))}catch(t){throw new fr(dr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Hd(ca.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Gd{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new fr(dr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Kd{constructor(t){this._methodName=t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class Wd{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new fr(dr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new fr(dr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Sr(this._lat,t._lat)||Sr(this._long,t._long)}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */const Qd=/^__.*__$/;class Yd{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new ac(t,this.data,this.fieldMask,e,this.fieldTransforms):new rc(t,this.data,e,this.fieldTransforms)}}function Xd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw cr()}}class Jd{constructor(t,e,n,i,s,o){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.Ru(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(t){return new Jd(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.mu({path:n,gu:!1});return i.pu(t),i}yu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.mu({path:n,gu:!1});return i.Ru(),i}wu(t){return this.mu({path:void 0,gu:!0})}Su(t){return lf(t,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Ru(){if(this.path)for(let t=0;t<this.path.length;t++)this.pu(this.path.get(t))}pu(t){if(0===t.length)throw this.Su("Document fields must not be empty");if(Xd(this.Vu)&&Qd.test(t))throw this.Su('Document fields cannot begin and end with "__"')}}class tf{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Yu(t)}Cu(t,e,n,i=!1){return new Jd({Vu:t,methodName:e,Du:n,path:Dr.emptyPath(),gu:!1,bu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ef(t){const e=t._freezeSettings(),n=Yu(t._databaseId);return new tf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function nf(t,e,n,i,s,o={}){const r=t.Cu(o.merge||o.mergeFields?2:0,e,n,s);af("Data must be an object, but it was:",r,i);const a=of(i,r);let h,c;if(o.merge)h=new aa(r.fieldMask),c=r.fieldTransforms;else if(o.mergeFields){const t=[];for(const i of o.mergeFields){const s=hf(e,i,n);if(!r.contains(s))throw new fr(dr.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);df(t,s)||t.push(s)}h=new aa(t),c=r.fieldTransforms.filter((t=>h.covers(t.field)))}else h=null,c=r.fieldTransforms;return new Yd(new Na(a),h,c)}function sf(t,e){if(rf(t=ut(t)))return af("Unsupported field value:",e,t),of(t,e);if(t instanceof Kd)return function(t,e){if(!Xd(e.Vu))throw e.Su(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Su(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.gu&&4!==e.Vu)throw e.Su("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=sf(s,e.wu(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=ut(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Bh(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Ir.fromDate(t);return{timestampValue:Fc(e.serializer,n)}}if(t instanceof Ir){const n=new Ir(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Fc(e.serializer,n)}}if(t instanceof Wd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Hd)return{bytesValue:Vc(e.serializer,t._byteString)};if(t instanceof Bd){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.Su(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Zc(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Su(`Unsupported field value: ${Dd(t)}`)}(t,e)}function of(t,e){const n={};return ea(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ta(t,((t,i)=>{const s=sf(i,e.fu(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function rf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ir||t instanceof Wd||t instanceof Hd||t instanceof Bd||t instanceof Kd)}function af(t,e,n){if(!rf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Dd(n);throw"an object"===i?e.Su(t+" a custom object"):e.Su(t+" "+i)}}function hf(t,e,n){if((e=ut(e))instanceof Gd)return e._internalPath;if("string"==typeof e)return uf(t,e);throw lf("Field path arguments must be of type string or ",t,!1,void 0,n)}const cf=new RegExp("[~\\*/\\[\\]]");function uf(t,e,n){if(e.search(cf)>=0)throw lf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Gd(...e.split("."))._internalPath}catch(i){throw lf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function lf(t,e,n,i,s){const o=i&&!i.isEmpty(),r=void 0!==s;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let h="";return(o||r)&&(h+=" (found",o&&(h+=` in field ${i}`),r&&(h+=` in document ${s}`),h+=")"),new fr(dr.INVALID_ARGUMENT,a+t+h)}function df(t,e){return t.some((t=>t.isEqual(e)))}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class ff{constructor(t,e,n,i,s){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Bd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new pf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(mf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class pf extends ff{data(){return super.data()}}function mf(t,e){return"string"==typeof e?uf(t,e):e instanceof Gd?e._internalPath:e._delegate._internalPath}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */class gf{}class _f extends gf{}class yf extends _f{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new yf(t,e,n)}_apply(t){const e=this._parse(t);return Tf(t._query,e),new zd(t.firestore,t.converter,mh(t._query,e))}_parse(t){const e=ef(t.firestore),n=function(t,e,n,i,s,o,r){let a;if(s.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new fr(dr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${o}' queries on documentId().`);if("in"===o||"not-in"===o){xf(r,o);const e=[];for(const n of r)e.push(bf(i,t,n));a={arrayValue:{values:e}}}else a=bf(i,t,r)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||xf(r,o),a=function(t,e,n,i=!1){return sf(n,t.Cu(i?4:3,e))}(n,e,r,"in"===o||"not-in"===o);return Za.create(s,o,a)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value);return n}}class vf extends gf{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new vf(t,e)}_parse(t){const e=this._queryConstraints.map((e=>e._parse(t))).filter((t=>t.getFilters().length>0));return 1===e.length?e[0]:$a.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const i=e.getFlattenedFilters();for(const t of i)Tf(n,t),n=mh(n,t)}(t._query,e),new zd(t.firestore,t.converter,mh(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class wf extends _f{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new wf(t,e)}_apply(t){const e=function(t,e,n){if(null!==t.startAt)throw new fr(dr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new fr(dr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Va(e,n)}(t._query,this._field,this._direction);return new zd(t.firestore,t.converter,function(t,e){const n=t.explicitOrderBy.concat([e]);return new ch(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))}}function bf(t,e,n){if("string"==typeof(n=ut(n))){if(""===n)throw new fr(dr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dh(e)&&-1!==n.indexOf("/"))throw new fr(dr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Ar.fromString(n));if(!Mr.isDocumentKey(i))throw new fr(dr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ia(t,new Mr(i))}if(n instanceof Bd)return Ia(t,n._key);throw new fr(dr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Dd(n)}.`)}function xf(t,e){if(!Array.isArray(t)||0===t.length)throw new fr(dr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Tf(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new fr(dr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new fr(dr.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Ef{convertValue(t,e="none"){switch(wa(t)){case 0:return null;case 1:return t.booleanValue;case 2:return da(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(fa(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw cr()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return ta(t,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Wd(da(t.latitude),da(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=ma(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(ga(t));default:return null}}convertTimestamp(t){const e=la(t);return new Ir(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Ar.fromString(t);ur(cu(n));const i=new ya(n.get(1),n.get(3)),s=new Mr(n.popFirst(5));return i.isEqual(e)||rr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
class Sf{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Cf extends ff{constructor(t,e,n,i,s,o){super(t,e,n,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new If(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(mf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class If extends Cf{data(t={}){return super.data(t)}}class Lf{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Sf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new If(this._firestore,this._userDataWriter,n.key,n,new Sf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new fr(dr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>{const i=new If(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Sf(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:e++}}))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new If(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Sf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let s=-1,o=-1;return 0!==e.type&&(s=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),o=n.indexOf(e.doc.key)),{type:Pf(e.type),doc:i,oldIndex:s,newIndex:o}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Pf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return cr()}}class Af extends Ef{constructor(t){super(),this.firestore=t}convertBytes(t){return new Hd(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Bd(this.firestore,null,e)}}function kf(t,e){const n=Md(t.firestore,Zd),i=function(t,e,...n){if(t=ut(t),1===arguments.length&&(e=Er.newId()),Pd("doc","path",e),t instanceof Od){const i=Ar.fromString(e,...n);return Ad(i),new Bd(t,null,new Mr(i))}{if(!(t instanceof Bd||t instanceof Fd))throw new fr(dr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ar.fromString(e,...n));return Ad(i),new Bd(t.firestore,t instanceof Fd?t.converter:null,new Mr(i))}}(t),s=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return function(t,e){return function(t,e){const n=new pr;return t.asyncQueue.enqueueAndForget((async()=>nd(await function(t){return Sd(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}($d(t),e)}(n,[nf(ef(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,Xh.exists(!1))]).then((()=>i))}function Df(t,...e){var n,i,s;t=ut(t);let o={includeMetadataChanges:!1,source:"default"},r=0;"object"!=typeof e[r]||jd(e[r])||(o=e[r],r++);const a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(jd(e[r])){const t=e[r];e[r]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[r+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[r+2]=null===(s=t.complete)||void 0===s?void 0:s.bind(t)}let h,c,u;if(t instanceof Bd)c=Md(t.firestore,Zd),u=uh(t._key.path),h={next:n=>{e[r]&&e[r](function(t,e,n){const i=n.docs.get(e._key),s=new Af(t);return new Cf(t,s,e._key,i,new Sf(n.hasPendingWrites,n.fromCache),e.converter)}(c,t,n))},error:e[r+1],complete:e[r+2]};else{const n=Md(t,zd);c=Md(n.firestore,Zd),u=n._query;const i=new Af(c);h={next:t=>{e[r]&&e[r](new Lf(c,i,n,t))},error:e[r+1],complete:e[r+2]},function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new fr(dr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query)}return function(t,e,n,i){const s=new bd(i),o=new $l(e,s,n);return t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=lr(t);let i=3;const s=e.query;let o=n.queries.get(s);o?!o.K_()&&e.U_()&&(i=2):(o=new zl,i=e.U_()?0:1);try{switch(i){case 0:o.q_=await n.onListen(s,!0);break;case 1:o.q_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(t){const n=Ml(t,`Initialization of query '${vh(e.query)}' failed`);return void e.onError(n)}n.queries.set(s,o),o.Q_.push(e),e.G_(n.onlineState),o.q_&&e.z_(o.q_)&&Ul(n)}(await Cd(t),o))),()=>{s.Qa(),t.asyncQueue.enqueueAndForget((async()=>async function(t,e){const n=lr(t),i=e.query;let s=3;const o=n.queries.get(i);if(o){const t=o.Q_.indexOf(e);t>=0&&(o.Q_.splice(t,1),0===o.Q_.length?s=e.U_()?0:1:!o.K_()&&e.U_()&&(s=2))}switch(s){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}(await Cd(t),o)))}}($d(c),u,a,h)}!function(t,e=!0){!function(t){nr=t}("10.10.0"),ye(new lt("firestore",((t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),o=new Zd(new yr(t.getProvider("auth-internal")),new xr(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new fr(dr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ya(t.options.projectId,e)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),xe(tr,"4.5.1",t),xe(tr,"4.5.1","esm2017")}();const Mf=function(t,e){const n="object"==typeof t?t:function(t=de){const e=pe.get(t);if(!e&&t===de&&tt())return be();if(!e)throw ve.create("no-app",{appName:t});return e}(),i="string"==typeof t?t:e||"(default)",s=function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const t=J("firestore");t&&Rd(s,...t)}return s}(be({apiKey:"AIzaSyBf0CCaay3FOZgJN_ziWFet3r3eJgmi1So",authDomain:"sepierde-org.firebaseapp.com",databaseURL:"https://sepierde-org-default-rtdb.firebaseio.com",projectId:"sepierde-org",storageBucket:"sepierde-org.appspot.com",messagingSenderId:"602937478415",appId:"1:602937478415:web:45339aa8916dd71de6c27a",measurementId:"G-0SDB43GK3K"}));"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function Nf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Of={exports:{}};
/* @preserve
     * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
     * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
     */(function(t){var e="1.9.4";function n(t){var e,n,i,s;for(n=1,i=arguments.length;n<i;n++)for(e in s=arguments[n])t[e]=s[e];return t}var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function s(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}var o=0;function r(t){return"_leaflet_id"in t||(t._leaflet_id=++o),t._leaflet_id}function a(t,e,n){var i,s,o,r;return r=function(){i=!1,s&&(o.apply(n,s),s=!1)},o=function(){i?s=arguments:(t.apply(n,arguments),setTimeout(r,e),i=!0)},o}function h(t,e,n){var i=e[1],s=e[0],o=i-s;return t===i&&n?t:((t-s)%o+o)%o+s}function c(){return!1}function u(t,e){if(!1===e)return t;var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function l(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function d(t){return l(t).split(/\s+/)}function f(t,e){for(var n in Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?i(t.options):{}),e)t.options[n]=e[n];return t.options}function p(t,e,n){var i=[];for(var s in t)i.push(encodeURIComponent(n?s.toUpperCase():s)+"="+encodeURIComponent(t[s]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}var m=/\{ *([\w_ -]+) *\}/g;function g(t,e){return t.replace(m,(function(t,n){var i=e[n];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i}))}var _=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function y(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var v="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var b=0;function x(t){var e=+new Date,n=Math.max(0,16-(e-b));return b=e+n,window.setTimeout(t,n)}var T=window.requestAnimationFrame||w("RequestAnimationFrame")||x,E=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function S(t,e,n){if(!n||T!==x)return T.call(window,s(t,e));t.call(e)}function C(t){t&&E.call(window,t)}var I={__proto__:null,extend:n,create:i,bind:s,get lastId(){return o},stamp:r,throttle:a,wrapNum:h,falseFn:c,formatNum:u,trim:l,splitWords:d,setOptions:f,getParamString:p,template:g,isArray:_,indexOf:y,emptyImageUrl:v,requestFn:T,cancelFn:E,requestAnimFrame:S,cancelAnimFrame:C};function P(){}function A(t){if("undefined"!=typeof L&&L&&L.Mixin){t=_(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}P.extend=function(t){var e=function(){f(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=e.__super__=this.prototype,o=i(s);for(var r in o.constructor=e,e.prototype=o,this)Object.prototype.hasOwnProperty.call(this,r)&&"prototype"!==r&&"__super__"!==r&&(e[r]=this[r]);return t.statics&&n(e,t.statics),t.includes&&(A(t.includes),n.apply(null,[o].concat(t.includes))),n(o,t),delete o.statics,delete o.includes,o.options&&(o.options=s.options?i(s.options):{},n(o.options,t.options)),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=o._initHooks.length;t<e;t++)o._initHooks[t].call(this)}},e},P.include=function(t){var e=this.prototype.options;return n(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},P.mergeOptions=function(t){return n(this.prototype.options,t),this},P.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var k={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var s=0,o=(t=d(t)).length;s<o;s++)this._on(t[s],e,n);return this},off:function(t,e,n){if(arguments.length)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else{t=d(t);for(var s=1===arguments.length,o=0,r=t.length;o<r;o++)s?this._off(t[o]):this._off(t[o],e,n)}else delete this._events;return this},_on:function(t,e,n,i){if("function"==typeof e){if(!1===this._listens(t,e,n)){n===this&&(n=void 0);var s={fn:e,ctx:n};i&&(s.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(s)}}else console.warn("wrong listener type: "+typeof e)},_off:function(t,e,n){var i,s,o;if(this._events&&(i=this._events[t]))if(1!==arguments.length)if("function"==typeof e){var r=this._listens(t,e,n);if(!1!==r){var a=i[r];this._firingCount&&(a.fn=c,this._events[t]=i=i.slice()),i.splice(r,1)}}else console.warn("wrong listener type: "+typeof e);else{if(this._firingCount)for(s=0,o=i.length;s<o;s++)i[s].fn=c;delete this._events[t]}},fire:function(t,e,i){if(!this.listens(t,i))return this;var s=n({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var r=0,a=o.length;r<a;r++){var h=o[r],c=h.fn;h.once&&this.off(t,c,h.ctx),c.call(h.ctx||this,s)}this._firingCount--}}return i&&this._propagateEvent(s),this},listens:function(t,e,n,i){"string"!=typeof t&&console.warn('"string" type argument expected');var s=e;"function"!=typeof e&&(i=!!e,s=void 0,n=void 0);var o=this._events&&this._events[t];if(o&&o.length&&!1!==this._listens(t,s,n))return!0;if(i)for(var r in this._eventParents)if(this._eventParents[r].listens(t,e,n,i))return!0;return!1},_listens:function(t,e,n){if(!this._events)return!1;var i=this._events[t]||[];if(!e)return!!i.length;n===this&&(n=void 0);for(var s=0,o=i.length;s<o;s++)if(i[s].fn===e&&i[s].ctx===n)return s;return!1},once:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e,!0);else for(var s=0,o=(t=d(t)).length;s<o;s++)this._on(t[s],e,n,!0);return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[r(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[r(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};k.addEventListener=k.on,k.removeEventListener=k.clearAllEventListeners=k.off,k.addOneTimeEventListener=k.once,k.fireEvent=k.fire,k.hasEventListeners=k.listens;var D=P.extend(k);function M(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var N=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function O(t,e,n){return t instanceof M?t:_(t)?new M(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new M(t.x,t.y):new M(t,e,n)}function R(t,e){if(t)for(var n=e?[t,e]:t,i=0,s=n.length;i<s;i++)this.extend(n[i])}function z(t,e){return!t||t instanceof R?t:new R(t,e)}function B(t,e){if(t)for(var n=e?[t,e]:t,i=0,s=n.length;i<s;i++)this.extend(n[i])}function F(t,e){return t instanceof B?t:new B(t,e)}function V(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function U(t,e,n){return t instanceof V?t:_(t)&&"object"!=typeof t[0]?3===t.length?new V(t[0],t[1],t[2]):2===t.length?new V(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new V(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new V(t,e,n)}M.prototype={clone:function(){return new M(this.x,this.y)},add:function(t){return this.clone()._add(O(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(O(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new M(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new M(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=N(this.x),this.y=N(this.y),this},distanceTo:function(t){var e=(t=O(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=O(t)).x===this.x&&t.y===this.y},contains:function(t){return t=O(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},R.prototype={extend:function(t){var e,n;if(!t)return this;if(t instanceof M||"number"==typeof t[0]||"x"in t)e=n=O(t);else if(e=(t=z(t)).min,n=t.max,!e||!n)return this;return this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=e.clone(),this.max=n.clone()),this},getCenter:function(t){return O((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return O(this.min.x,this.max.y)},getTopRight:function(){return O(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof M?O(t):z(t))instanceof R?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=z(t);var e=this.min,n=this.max,i=t.min,s=t.max,o=s.x>=e.x&&i.x<=n.x,r=s.y>=e.y&&i.y<=n.y;return o&&r},overlaps:function(t){t=z(t);var e=this.min,n=this.max,i=t.min,s=t.max,o=s.x>e.x&&i.x<n.x,r=s.y>e.y&&i.y<n.y;return o&&r},isValid:function(){return!(!this.min||!this.max)},pad:function(t){var e=this.min,n=this.max,i=Math.abs(e.x-n.x)*t,s=Math.abs(e.y-n.y)*t;return z(O(e.x-i,e.y-s),O(n.x+i,n.y+s))},equals:function(t){return!!t&&(t=z(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight()))}},B.prototype={extend:function(t){var e,n,i=this._southWest,s=this._northEast;if(t instanceof V)e=t,n=t;else{if(!(t instanceof B))return t?this.extend(U(t)||F(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return i||s?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),s.lat=Math.max(n.lat,s.lat),s.lng=Math.max(n.lng,s.lng)):(this._southWest=new V(e.lat,e.lng),this._northEast=new V(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,s=Math.abs(e.lng-n.lng)*t;return new B(new V(e.lat-i,e.lng-s),new V(n.lat+i,n.lng+s))},getCenter:function(){return new V((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new V(this.getNorth(),this.getWest())},getSouthEast:function(){return new V(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof V||"lat"in t?U(t):F(t);var e,n,i=this._southWest,s=this._northEast;return t instanceof B?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=s.lat&&e.lng>=i.lng&&n.lng<=s.lng},intersects:function(t){t=F(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),s=t.getNorthEast(),o=s.lat>=e.lat&&i.lat<=n.lat,r=s.lng>=e.lng&&i.lng<=n.lng;return o&&r},overlaps:function(t){t=F(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),s=t.getNorthEast(),o=s.lat>e.lat&&i.lat<n.lat,r=s.lng>e.lng&&i.lng<n.lng;return o&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=F(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},V.prototype={equals:function(t,e){return!!t&&(t=U(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+u(this.lat,t)+", "+u(this.lng,t)+")"},distanceTo:function(t){return $.distance(this,U(t))},wrap:function(){return $.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return F([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new V(this.lat,this.lng,this.alt)}};var j,Z={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new R(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?h(t.lng,this.wrapLng,!0):t.lng;return new V(this.wrapLat?h(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,s=e.lng-n.lng;if(0===i&&0===s)return t;var o=t.getSouthWest(),r=t.getNorthEast();return new B(new V(o.lat-i,o.lng-s),new V(r.lat-i,r.lng-s))}},$=n({},Z,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,s=e.lat*n,o=Math.sin((e.lat-t.lat)*n/2),r=Math.sin((e.lng-t.lng)*n/2),a=o*o+Math.cos(i)*Math.cos(s)*r*r,h=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*h}}),q=6378137,H={R:q,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),s=Math.sin(i*e);return new M(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new V((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(j=q*Math.PI,new R([-j,-j],[j,j]))};function G(t,e,n,i){if(_(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function K(t,e,n,i){return new G(t,e,n,i)}G.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new M((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var W=n({},$,{code:"EPSG:3857",projection:H,transformation:function(){var t=.5/(Math.PI*H.R);return K(t,.5,-t,.5)}()}),Q=n({},W,{code:"EPSG:900913"});function Y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function X(t,e){var n,i,s,o,r,a,h="";for(n=0,s=t.length;n<s;n++){for(i=0,o=(r=t[n]).length;i<o;i++)h+=(i?"L":"M")+(a=r[i]).x+" "+a.y;h+=e?Bt.svg?"z":"x":""}return h||"M0 0"}var J,tt=document.documentElement.style,et="ActiveXObject"in window,nt=et&&!document.addEventListener,it="msLaunchUri"in navigator&&!("documentMode"in document),st=zt("webkit"),ot=zt("android"),rt=zt("android 2")||zt("android 3"),at=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ht=ot&&zt("Google")&&at<537&&!("AudioNode"in window),ct=!!window.opera,ut=!it&&zt("chrome"),lt=zt("gecko")&&!st&&!ct&&!et,dt=!ut&&zt("safari"),ft=zt("phantom"),pt="OTransition"in tt,mt=0===navigator.platform.indexOf("Win"),gt=et&&"transition"in tt,_t="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!rt,yt="MozPerspective"in tt,vt=!window.L_DISABLE_3D&&(gt||_t||yt)&&!pt&&!ft,wt="undefined"!=typeof orientation||zt("mobile"),bt=wt&&st,xt=wt&&_t,Tt=!window.PointerEvent&&window.MSPointerEvent,Et=!(!window.PointerEvent&&!Tt),St="ontouchstart"in window||!!window.TouchEvent,Ct=!window.L_NO_TOUCH&&(St||Et),It=wt&&ct,Lt=wt&&lt,Pt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,At=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",c,e),window.removeEventListener("testPassiveEventSupport",c,e)}catch(t){}return t}(),kt=!!document.createElement("canvas").getContext,Dt=!(!document.createElementNS||!Y("svg").createSVGRect),Mt=!!Dt&&((J=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(J.firstChild&&J.firstChild.namespaceURI)),Nt=!Dt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),Ot=0===navigator.platform.indexOf("Mac"),Rt=0===navigator.platform.indexOf("Linux");function zt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Bt={ie:et,ielt9:nt,edge:it,webkit:st,android:ot,android23:rt,androidStock:ht,opera:ct,chrome:ut,gecko:lt,safari:dt,phantom:ft,opera12:pt,win:mt,ie3d:gt,webkit3d:_t,gecko3d:yt,any3d:vt,mobile:wt,mobileWebkit:bt,mobileWebkit3d:xt,msPointer:Tt,pointer:Et,touch:Ct,touchNative:St,mobileOpera:It,mobileGecko:Lt,retina:Pt,passiveEvents:At,canvas:kt,svg:Dt,vml:Nt,inlineSvg:Mt,mac:Ot,linux:Rt},Ft=Bt.msPointer?"MSPointerDown":"pointerdown",Vt=Bt.msPointer?"MSPointerMove":"pointermove",Ut=Bt.msPointer?"MSPointerUp":"pointerup",jt=Bt.msPointer?"MSPointerCancel":"pointercancel",Zt={touchstart:Ft,touchmove:Vt,touchend:Ut,touchcancel:jt},$t={touchstart:te,touchmove:Jt,touchend:Jt,touchcancel:Jt},qt={},Ht=!1;function Gt(t,e,n){return"touchstart"===e&&Xt(),$t[e]?(n=$t[e].bind(this,n),t.addEventListener(Zt[e],n,!1),n):(console.warn("wrong event specified:",e),c)}function Kt(t,e,n){Zt[e]?t.removeEventListener(Zt[e],n,!1):console.warn("wrong event specified:",e)}function Wt(t){qt[t.pointerId]=t}function Qt(t){qt[t.pointerId]&&(qt[t.pointerId]=t)}function Yt(t){delete qt[t.pointerId]}function Xt(){Ht||(document.addEventListener(Ft,Wt,!0),document.addEventListener(Vt,Qt,!0),document.addEventListener(Ut,Yt,!0),document.addEventListener(jt,Yt,!0),Ht=!0)}function Jt(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in e.touches=[],qt)e.touches.push(qt[n]);e.changedTouches=[e],t(e)}}function te(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&We(e),Jt(t,e)}function ee(t){var e,n,i={};for(n in t)e=t[n],i[n]=e&&e.bind?e.bind(t):e;return t=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}var ne=200;function ie(t,e){t.addEventListener("dblclick",e);var n,i=0;function s(t){if(1===t.detail){if("mouse"!==t.pointerType&&(!t.sourceCapabilities||t.sourceCapabilities.firesTouchEvents)){var s=Ye(t);if(!s.some((function(t){return t instanceof HTMLLabelElement&&t.attributes.for}))||s.some((function(t){return t instanceof HTMLInputElement||t instanceof HTMLSelectElement}))){var o=Date.now();o-i<=ne?2==++n&&e(ee(t)):n=1,i=o}}}else n=t.detail}return t.addEventListener("click",s),{dblclick:e,simDblclick:s}}function se(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var oe,re,ae,he,ce,ue=Ie(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),le=Ie(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),de="webkitTransition"===le||"OTransition"===le?le+"End":"transitionend";function fe(t){return"string"==typeof t?document.getElementById(t):t}function pe(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function me(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function ge(t){var e=t.parentNode;e&&e.removeChild(t)}function _e(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ye(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function ve(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function we(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=Ee(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function be(t,e){if(void 0!==t.classList)for(var n=d(e),i=0,s=n.length;i<s;i++)t.classList.add(n[i]);else if(!we(t,e)){var o=Ee(t);Te(t,(o?o+" ":"")+e)}}function xe(t,e){void 0!==t.classList?t.classList.remove(e):Te(t,l((" "+Ee(t)+" ").replace(" "+e+" "," ")))}function Te(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function Ee(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function Se(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&Ce(t,e)}function Ce(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}function Ie(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function Le(t,e,n){var i=e||new M(0,0);t.style[ue]=(Bt.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function Pe(t,e){t._leaflet_pos=e,Bt.any3d?Le(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Ae(t){return t._leaflet_pos||new M(0,0)}if("onselectstart"in document)oe=function(){Fe(window,"selectstart",We)},re=function(){Ue(window,"selectstart",We)};else{var ke=Ie(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);oe=function(){if(ke){var t=document.documentElement.style;ae=t[ke],t[ke]="none"}},re=function(){ke&&(document.documentElement.style[ke]=ae,ae=void 0)}}function De(){Fe(window,"dragstart",We)}function Me(){Ue(window,"dragstart",We)}function Ne(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Oe(),he=t,ce=t.style.outlineStyle,t.style.outlineStyle="none",Fe(window,"keydown",Oe))}function Oe(){he&&(he.style.outlineStyle=ce,he=void 0,ce=void 0,Ue(window,"keydown",Oe))}function Re(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function ze(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Be={__proto__:null,TRANSFORM:ue,TRANSITION:le,TRANSITION_END:de,get:fe,getStyle:pe,create:me,remove:ge,empty:_e,toFront:ye,toBack:ve,hasClass:we,addClass:be,removeClass:xe,setClass:Te,getClass:Ee,setOpacity:Se,testProp:Ie,setTransform:Le,setPosition:Pe,getPosition:Ae,get disableTextSelection(){return oe},get enableTextSelection(){return re},disableImageDrag:De,enableImageDrag:Me,preventOutline:Ne,restoreOutline:Oe,getSizedParentNode:Re,getScale:ze};function Fe(t,e,n,i){if(e&&"object"==typeof e)for(var s in e)$e(t,s,e[s],n);else for(var o=0,r=(e=d(e)).length;o<r;o++)$e(t,e[o],n,i);return this}var Ve="_leaflet_events";function Ue(t,e,n,i){if(1===arguments.length)je(t),delete t[Ve];else if(e&&"object"==typeof e)for(var s in e)qe(t,s,e[s],n);else if(e=d(e),2===arguments.length)je(t,(function(t){return-1!==y(e,t)}));else for(var o=0,r=e.length;o<r;o++)qe(t,e[o],n,i);return this}function je(t,e){for(var n in t[Ve]){var i=n.split(/\d/)[0];e&&!e(i)||qe(t,i,null,null,n)}}var Ze={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function $e(t,e,n,i){var s=e+r(n)+(i?"_"+r(i):"");if(t[Ve]&&t[Ve][s])return this;var o=function(e){return n.call(i||t,e||window.event)},a=o;!Bt.touchNative&&Bt.pointer&&0===e.indexOf("touch")?o=Gt(t,e,o):Bt.touch&&"dblclick"===e?o=ie(t,o):"addEventListener"in t?"touchstart"===e||"touchmove"===e||"wheel"===e||"mousewheel"===e?t.addEventListener(Ze[e]||e,o,!!Bt.passiveEvents&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(o=function(e){e=e||window.event,en(t,e)&&a(e)},t.addEventListener(Ze[e],o,!1)):t.addEventListener(e,a,!1):t.attachEvent("on"+e,o),t[Ve]=t[Ve]||{},t[Ve][s]=o}function qe(t,e,n,i,s){s=s||e+r(n)+(i?"_"+r(i):"");var o=t[Ve]&&t[Ve][s];if(!o)return this;!Bt.touchNative&&Bt.pointer&&0===e.indexOf("touch")?Kt(t,e,o):Bt.touch&&"dblclick"===e?se(t,o):"removeEventListener"in t?t.removeEventListener(Ze[e]||e,o,!1):t.detachEvent("on"+e,o),t[Ve][s]=null}function He(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Ge(t){return $e(t,"wheel",He),this}function Ke(t){return Fe(t,"mousedown touchstart dblclick contextmenu",He),t._leaflet_disable_click=!0,this}function We(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Qe(t){return We(t),He(t),this}function Ye(t){if(t.composedPath)return t.composedPath();for(var e=[],n=t.target;n;)e.push(n),n=n.parentNode;return e}function Xe(t,e){if(!e)return new M(t.clientX,t.clientY);var n=ze(e),i=n.boundingClientRect;return new M((t.clientX-i.left)/n.x-e.clientLeft,(t.clientY-i.top)/n.y-e.clientTop)}var Je=Bt.linux&&Bt.chrome?window.devicePixelRatio:Bt.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function tn(t){return Bt.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Je:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function en(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var nn={__proto__:null,on:Fe,off:Ue,stopPropagation:He,disableScrollPropagation:Ge,disableClickPropagation:Ke,preventDefault:We,stop:Qe,getPropagationPath:Ye,getMousePosition:Xe,getWheelDelta:tn,isExternalTarget:en,addListener:Fe,removeListener:Ue},sn=D.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=Ae(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=S(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),Pe(this._el,n),this.fire("step")},_complete:function(){C(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),on=D.extend({options:{crs:W,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=f(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=s(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(U(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=le&&Bt.any3d&&!Bt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Fe(this._proxy,de,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(U(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n({animate:i.animate},i.zoom),i.pan=n({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e,i.pan&&i.pan.noMoveStart),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),s=this.getSize().divideBy(2),o=(t instanceof M?t:this.latLngToContainerPoint(t)).subtract(s).multiplyBy(1-1/i),r=this.containerPointToLatLng(s.add(o));return this.setView(r,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():F(t);var n=O(e.paddingTopLeft||e.padding||[0,0]),i=O(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,n.add(i));if((s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s)===1/0)return{center:t.getCenter(),zoom:s};var o=i.subtract(n).divideBy(2),r=this.project(t.getSouthWest(),s),a=this.project(t.getNorthEast(),s);return{center:this.unproject(r.add(a).divideBy(2).add(o),s),zoom:s}},fitBounds:function(t,e){if(!(t=F(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=O(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new sn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){be(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!Bt.any3d)return this.setView(t,e,n);this._stop();var i=this.project(this.getCenter()),s=this.project(t),o=this.getSize(),r=this._zoom;t=U(t),e=void 0===e?r:e;var a=Math.max(o.x,o.y),h=a*this.getZoomScale(r,e),c=s.distanceTo(i)||1,u=1.42,l=u*u;function d(t){var e=(h*h-a*a+(t?-1:1)*l*l*c*c)/(2*(t?h:a)*l*c),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function f(t){return(Math.exp(t)-Math.exp(-t))/2}function p(t){return(Math.exp(t)+Math.exp(-t))/2}function m(t){return f(t)/p(t)}var g=d(0);function _(t){return a*(p(g)/p(g+u*t))}function y(t){return a*(p(g)*m(g+u*t)-f(g))/l}function v(t){return 1-Math.pow(1-t,1.5)}var w=Date.now(),b=(d(1)-g)/u,x=n.duration?1e3*n.duration:1e3*b*.8;function T(){var n=(Date.now()-w)/x,o=v(n)*b;n<=1?(this._flyToFrame=S(T,this),this._move(this.unproject(i.add(s.subtract(i).multiplyBy(y(o)/c)),r),this.getScaleZoom(a/_(o),r),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),T.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return t=F(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,F(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=O((e=e||{}).paddingTopLeft||e.padding||[0,0]),i=O(e.paddingBottomRight||e.padding||[0,0]),s=this.project(this.getCenter()),o=this.project(t),r=this.getPixelBounds(),a=z([r.min.add(n),r.max.subtract(i)]),h=a.getSize();if(!a.contains(o)){this._enforcingBounds=!0;var c=o.subtract(a.getCenter()),u=a.extend(o).getSize().subtract(h);s.x+=c.x<0?-u.x:u.x,s.y+=c.y<0?-u.y:u.y,this.panTo(this.unproject(s),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),o=e.divideBy(2).round(),r=i.divideBy(2).round(),a=o.subtract(r);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=s(this._handleGeolocationResponse,this),i=s(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=new V(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),i=this._locateOptions;if(i.setView){var s=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(s,i.maxZoom):s)}var o={latlng:e,bounds:n,timestamp:t.timestamp};for(var r in t.coords)"number"==typeof t.coords[r]&&(o[r]=t.coords[r]);this.fire("locationfound",o)}},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ge(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(C(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)ge(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=me("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new B(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=F(t),n=O(n||[0,0]);var i=this.getZoom()||0,s=this.getMinZoom(),o=this.getMaxZoom(),r=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(n),c=z(this.project(a,i),this.project(r,i)).getSize(),u=Bt.any3d?this.options.zoomSnap:1,l=h.x/c.x,d=h.y/c.y,f=e?Math.max(l,d):Math.min(l,d);return i=this.getScaleZoom(f,i),u&&(i=Math.round(i/(u/100))*(u/100),i=e?Math.ceil(i/u)*u:Math.floor(i/u)*u),Math.max(s,Math.min(o,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new M(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new R(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?1/0:i},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(U(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(O(t),e)},layerPointToLatLng:function(t){var e=O(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(U(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(U(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(F(t))},distance:function(t,e){return this.options.crs.distance(U(t),U(e))},containerPointToLayerPoint:function(t){return O(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return O(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(O(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(U(t)))},mouseEventToContainerPoint:function(t){return Xe(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=fe(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Fe(e,"scroll",this._onScroll,this),this._containerId=r(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Bt.any3d,be(t,"leaflet-container"+(Bt.touch?" leaflet-touch":"")+(Bt.retina?" leaflet-retina":"")+(Bt.ielt9?" leaflet-oldie":"")+(Bt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=pe(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&"sticky"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Pe(this._mapPane,new M(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(be(t.markerPane,"leaflet-zoom-hide"),be(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,n){Pe(this._mapPane,new M(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var s=this._zoom!==e;this._moveStart(s,n)._move(t,e)._moveEnd(s),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n,i){void 0===e&&(e=this._zoom);var s=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),i?n&&n.pinch&&this.fire("zoom",n):((s||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return C(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Pe(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[r(this._container)]=this;var e=t?Ue:Fe;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Bt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){C(this._resizeRequest),this._resizeRequest=S((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,i=[],s="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,a=!1;o;){if((n=this._targets[r(o)])&&("click"===e||"preclick"===e)&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)){if(s&&!en(o,t))break;if(i.push(n),s)break}if(o===this._container)break;o=o.parentNode}return i.length||a||s||!this.listens(e,!0)||(i=[this]),i},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||"click"===t.type&&this._isClickDisabled(e))){var n=t.type;"mousedown"===n&&Ne(e),this._fireDOMEvent(t,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,i){if("click"===t.type){var s=n({},t);s.type="preclick",this._fireDOMEvent(s,s.type,i)}var o=this._findEventTargets(t,e);if(i){for(var r=[],a=0;a<i.length;a++)i[a].listens(e,!0)&&r.push(i[a]);o=r.concat(o)}if(o.length){"contextmenu"===e&&We(t);var h=o[0],c={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var u=h.getLatLng&&(!h._radius||h._radius<=10);c.containerPoint=u?this.latLngToContainerPoint(h.getLatLng()):this.mouseEventToContainerPoint(t),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=u?h.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(a=0;a<o.length;a++)if(o[a].fire(e,c,!0),c.originalEvent._stopped||!1===o[a].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Ae(this._mapPane)||new M(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return z([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),s=this.getSize().divideBy(2),o=new R(i.subtract(s),i.add(s)),r=this._getBoundsOffset(o,n,e);return Math.abs(r.x)<=1&&Math.abs(r.y)<=1?t:this.unproject(i.add(r),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new R(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=z(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),s=i.min.subtract(t.min),o=i.max.subtract(t.max);return new M(this._rebound(s.x,-o.x),this._rebound(s.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=Bt.any3d?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){xe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=ue,n=this._proxy.style[e];Le(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ge(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();Le(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(s)||(S((function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,be(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:i}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(s(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&xe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function rn(t,e){return new on(t,e)}var an=P.extend({options:{position:"topright"},initialize:function(t){f(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return be(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ge(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),hn=function(t){return new an(t)};on.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=me("div",e+"control-container",this._container);function i(i,s){var o=e+i+" "+e+s;t[i+s]=me("div",o,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ge(this._controlCorners[t]);ge(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var cn=an.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){for(var i in f(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return an.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){be(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(be(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):xe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return xe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=me("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Ke(e),Ge(e);var i=this._section=me("section",t+"-list");n&&(this._map.on("click",this.collapse,this),Fe(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var s=this._layersLink=me("a",t+"-toggle",e);s.href="#",s.title="Layers",s.setAttribute("role","button"),Fe(s,{keydown:function(t){13===t.keyCode&&this._expandSafely()},click:function(t){We(t),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=me("div",t+"-base",i),this._separator=me("div",t+"-separator",i),this._overlaysList=me("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(s((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;_e(this._baseLayersList),_e(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,s=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,s+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=document.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers_"+r(this),i),this._layerControlInputs.push(e),e.layerId=r(t.layer),Fe(e,"click",this._onInputClick,this);var s=document.createElement("span");s.innerHTML=" "+t.name;var o=document.createElement("span");return n.appendChild(o),o.appendChild(e),o.appendChild(s),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var t,e,n=this._layerControlInputs,i=[],s=[];this._handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=n[o],e=this._getLayer(t.layerId).layer,t.checked?i.push(e):t.checked||s.push(e);for(o=0;o<s.length;o++)this._map.hasLayer(s[o])&&this._map.removeLayer(s[o]);for(o=0;o<i.length;o++)this._map.hasLayer(i[o])||this._map.addLayer(i[o]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,i=this._map.getZoom(),s=n.length-1;s>=0;s--)t=n[s],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&i<e.options.minZoom||void 0!==e.options.maxZoom&&i>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Fe(t,"click",We),this.expand();var e=this;setTimeout((function(){Ue(t,"click",We),e._preventClick=!1}))}}),un=function(t,e,n){return new cn(t,e,n)},ln=an.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=me("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,s){var o=me("a",n,i);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),Ke(o),Fe(o,"click",Qe),Fe(o,"click",s,this),Fe(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";xe(this._zoomInButton,e),xe(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(be(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(be(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});on.mergeOptions({zoomControl:!0}),on.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new ln,this.addControl(this.zoomControl))}));var dn=function(t){return new ln(t)},fn=an.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=me("div",e),i=this.options;return this._addScales(i,e+"-line",n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=me("div",e,n)),t.imperial&&(this._iScale=me("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,i,s=3.2808399*t;s>5280?(e=s/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(i=this._getRoundNum(s),this._updateScale(this._iScale,i+" ft",i/s))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),pn=function(t){return new fn(t)},mn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',gn=an.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Bt.inlineSvg?mn+" ":"")+"Leaflet</a>"},initialize:function(t){f(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=me("div","leaflet-control-attribution"),Ke(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",(function(){this.removeAttribution(t.layer.getAttribution())}),this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});on.mergeOptions({attributionControl:!0}),on.addInitHook((function(){this.options.attributionControl&&(new gn).addTo(this)}));var _n=function(t){return new gn(t)};an.Layers=cn,an.Zoom=ln,an.Scale=fn,an.Attribution=gn,hn.layers=un,hn.zoom=dn,hn.scale=pn,hn.attribution=_n;var yn=P.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});yn.addTo=function(t,e){return t.addHandler(e,this),this};var vn={Events:k},wn=Bt.touch?"touchstart mousedown":"mousedown",bn=D.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){f(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Fe(this._dragStartTarget,wn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(bn._dragging===this&&this.finishDrag(!0),Ue(this._dragStartTarget,wn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!we(this._element,"leaflet-zoom-anim")))if(t.touches&&1!==t.touches.length)bn._dragging===this&&this.finishDrag();else if(!(bn._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(bn._dragging=this,this._preventOutline&&Ne(this._element),De(),oe(),this._moving))){this.fire("down");var e=t.touches?t.touches[0]:t,n=Re(this._element);this._startPoint=new M(e.clientX,e.clientY),this._startPos=Ae(this._element),this._parentScale=ze(n);var i="mousedown"===t.type;Fe(document,i?"mousemove":"touchmove",this._onMove,this),Fe(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(t){if(this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new M(e.clientX,e.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,We(t),this._moved||(this.fire("dragstart"),this._moved=!0,be(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),be(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=t,this._updatePosition()))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Pe(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){xe(document.body,"leaflet-dragging"),this._lastTarget&&(xe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ue(document,"mousemove touchmove",this._onMove,this),Ue(document,"mouseup touchend touchcancel",this._onUp,this),Me(),re();var e=this._moved&&this._moving;this._moving=!1,bn._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function xn(t,e,n){var i,s,o,r,a,h,c,u,l,d=[1,4,2,8];for(s=0,c=t.length;s<c;s++)t[s]._code=On(t[s],e);for(r=0;r<4;r++){for(u=d[r],i=[],s=0,o=(c=t.length)-1;s<c;o=s++)a=t[s],h=t[o],a._code&u?h._code&u||((l=Nn(h,a,u,e,n))._code=On(l,e),i.push(l)):(h._code&u&&((l=Nn(h,a,u,e,n))._code=On(l,e),i.push(l)),i.push(a));t=i}return t}function Tn(t,e){var n,i,s,o,r,a,h,c,u;if(!t||0===t.length)throw new Error("latlngs not passed");Bn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var l=U([0,0]),d=F(t);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(l=En(t));var f=t.length,p=[];for(n=0;n<f;n++){var m=U(t[n]);p.push(e.project(U([m.lat-l.lat,m.lng-l.lng])))}for(a=h=c=0,n=0,i=f-1;n<f;i=n++)s=p[n],o=p[i],r=s.y*o.x-o.y*s.x,h+=(s.x+o.x)*r,c+=(s.y+o.y)*r,a+=3*r;u=0===a?p[0]:[h/a,c/a];var g=e.unproject(O(u));return U([g.lat+l.lat,g.lng+l.lng])}function En(t){for(var e=0,n=0,i=0,s=0;s<t.length;s++){var o=U(t[s]);e+=o.lat,n+=o.lng,i++}return U([e/i,n/i])}var Sn,Cn={__proto__:null,clipPolygon:xn,polygonCenter:Tn,centroid:En};function In(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=An(t=Dn(t,n),n)}function Ln(t,e,n){return Math.sqrt(zn(t,e,n,!0))}function Pn(t,e,n){return zn(t,e,n)}function An(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,kn(t,i,e,0,n-1);var s,o=[];for(s=0;s<n;s++)i[s]&&o.push(t[s]);return o}function kn(t,e,n,i,s){var o,r,a,h=0;for(r=i+1;r<=s-1;r++)(a=zn(t[r],t[i],t[s],!0))>h&&(o=r,h=a);h>n&&(e[o]=1,kn(t,e,n,i,o),kn(t,e,n,o,s))}function Dn(t,e){for(var n=[t[0]],i=1,s=0,o=t.length;i<o;i++)Rn(t[i],t[s])>e&&(n.push(t[i]),s=i);return s<o-1&&n.push(t[o-1]),n}function Mn(t,e,n,i,s){var o,r,a,h=i?Sn:On(t,n),c=On(e,n);for(Sn=c;;){if(!(h|c))return[t,e];if(h&c)return!1;a=On(r=Nn(t,e,o=h||c,n,s),n),o===h?(t=r,h=a):(e=r,c=a)}}function Nn(t,e,n,i,s){var o,r,a=e.x-t.x,h=e.y-t.y,c=i.min,u=i.max;return 8&n?(o=t.x+a*(u.y-t.y)/h,r=u.y):4&n?(o=t.x+a*(c.y-t.y)/h,r=c.y):2&n?(o=u.x,r=t.y+h*(u.x-t.x)/a):1&n&&(o=c.x,r=t.y+h*(c.x-t.x)/a),new M(o,r,s)}function On(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function Rn(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function zn(t,e,n,i){var s,o=e.x,r=e.y,a=n.x-o,h=n.y-r,c=a*a+h*h;return c>0&&((s=((t.x-o)*a+(t.y-r)*h)/c)>1?(o=n.x,r=n.y):s>0&&(o+=a*s,r+=h*s)),a=t.x-o,h=t.y-r,i?a*a+h*h:new M(o,r)}function Bn(t){return!_(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function Fn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Bn(t)}function Vn(t,e){var n,i,s,o,r,a,h,c;if(!t||0===t.length)throw new Error("latlngs not passed");Bn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var u=U([0,0]),l=F(t);l.getNorthWest().distanceTo(l.getSouthWest())*l.getNorthEast().distanceTo(l.getNorthWest())<1700&&(u=En(t));var d=t.length,f=[];for(n=0;n<d;n++){var p=U(t[n]);f.push(e.project(U([p.lat-u.lat,p.lng-u.lng])))}for(n=0,i=0;n<d-1;n++)i+=f[n].distanceTo(f[n+1])/2;if(0===i)c=f[0];else for(n=0,o=0;n<d-1;n++)if(r=f[n],a=f[n+1],(o+=s=r.distanceTo(a))>i){h=(o-i)/s,c=[a.x-h*(a.x-r.x),a.y-h*(a.y-r.y)];break}var m=e.unproject(O(c));return U([m.lat+u.lat,m.lng+u.lng])}var Un={__proto__:null,simplify:In,pointToSegmentDistance:Ln,closestPointOnSegment:Pn,clipSegment:Mn,_getEdgeIntersection:Nn,_getBitCode:On,_sqClosestPointOnSegment:zn,isFlat:Bn,_flat:Fn,polylineCenter:Vn},jn={project:function(t){return new M(t.lng,t.lat)},unproject:function(t){return new V(t.y,t.x)},bounds:new R([-180,-90],[180,90])},Zn={R:6378137,R_MINOR:6356752.314245179,bounds:new R([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,s=this.R_MINOR/n,o=Math.sqrt(1-s*s),r=o*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-r)/(1+r),o/2);return i=-n*Math.log(Math.max(a,1e-10)),new M(t.lng*e*n,i)},unproject:function(t){for(var e,n=180/Math.PI,i=this.R,s=this.R_MINOR/i,o=Math.sqrt(1-s*s),r=Math.exp(-t.y/i),a=Math.PI/2-2*Math.atan(r),h=0,c=.1;h<15&&Math.abs(c)>1e-7;h++)e=o*Math.sin(a),e=Math.pow((1-e)/(1+e),o/2),a+=c=Math.PI/2-2*Math.atan(r*e)-a;return new V(a*n,t.x*n/i)}},$n={__proto__:null,LonLat:jn,Mercator:Zn,SphericalMercator:H},qn=n({},$,{code:"EPSG:3395",projection:Zn,transformation:function(){var t=.5/(Math.PI*Zn.R);return K(t,.5,-t,.5)}()}),Hn=n({},$,{code:"EPSG:4326",projection:jn,transformation:K(1/180,1,-1/180,.5)}),Gn=n({},Z,{projection:jn,transformation:K(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});Z.Earth=$,Z.EPSG3395=qn,Z.EPSG3857=W,Z.EPSG900913=Q,Z.EPSG4326=Hn,Z.Simple=Gn;var Kn=D.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[r(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[r(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});on.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=r(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=r(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return r(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?_(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[r(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=r(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var s=this._zoomBoundLayers[i].options;t=void 0===s.minZoom?t:Math.min(t,s.minZoom),e=void 0===s.maxZoom?e:Math.max(e,s.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Wn=Kn.extend({initialize:function(t,e){var n,i;if(f(this,e),this._layers={},t)for(n=0,i=t.length;n<i;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return("number"==typeof t?t:this.getLayerId(t))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r(t)}}),Qn=function(t,e){return new Wn(t,e)},Yn=Wn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Wn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Wn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new B;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),Xn=function(t,e){return new Yn(t,e)},Jn=P.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){f(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var s=O(i),o=O("shadow"===e&&n.shadowAnchor||n.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Bt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function ti(t){return new Jn(t)}var ei=Jn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return"string"!=typeof ei.imagePath&&(ei.imagePath=this._detectIconPath()),(this.options.imagePath||ei.imagePath)+Jn.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(t,e,n){var i=e.exec(t);return i&&i[n]};return(t=e(t,/^url\((['"])?(.+)\1\)$/,2))&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=me("div","leaflet-default-icon-path",document.body),e=pe(t,"background-image")||pe(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e))return e;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),ni=yn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new bn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),be(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&xe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,i=this._marker.options.autoPanSpeed,s=this._marker.options.autoPanPadding,o=Ae(e._icon),r=n.getPixelBounds(),a=n.getPixelOrigin(),h=z(r.min._subtract(a).add(s),r.max._subtract(a).subtract(s));if(!h.contains(o)){var c=O((Math.max(h.max.x,o.x)-h.max.x)/(r.max.x-h.max.x)-(Math.min(h.min.x,o.x)-h.min.x)/(r.min.x-h.min.x),(Math.max(h.max.y,o.y)-h.max.y)/(r.max.y-h.max.y)-(Math.min(h.min.y,o.y)-h.min.y)/(r.min.y-h.min.y)).multiplyBy(i);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),Pe(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=S(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(C(this._panRequest),this._panRequest=S(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,i=Ae(e._icon),s=e._map.layerPointToLatLng(i);n&&Pe(n,i),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){C(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),ii=Kn.extend({options:{icon:new ei,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){f(this,e),this._latlng=U(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=U(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),be(n,e),t.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Fe(n,"focus",this._panOnFocus,this);var s=t.icon.createShadow(this._shadow),o=!1;s!==this._shadow&&(this._removeShadow(),o=!0),s&&(be(s,e),s.alt=""),this._shadow=s,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&o&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ue(this._icon,"focus",this._panOnFocus,this),ge(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ge(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Pe(this._icon,t),this._shadow&&Pe(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(be(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ni)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ni(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&Se(this._icon,t),this._shadow&&Se(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,n=e.iconSize?O(e.iconSize):O(0,0),i=e.iconAnchor?O(e.iconAnchor):O(0,0);t.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function si(t,e){return new ii(t,e)}var oi=Kn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return f(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ri=oi.extend({options:{fill:!0,radius:10},initialize:function(t,e){f(this,e),this._latlng=U(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=U(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return oi.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new R(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ai(t,e){return new ri(t,e)}var hi=ri.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=n({},i,{radius:e})),f(this,e),this._latlng=U(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new B(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:oi.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===$.distance){var s=Math.PI/180,o=this._mRadius/$.R/s,r=n.project([e+o,t]),a=n.project([e-o,t]),h=r.add(a).divideBy(2),c=n.unproject(h).lat,u=Math.acos((Math.cos(o*s)-Math.sin(e*s)*Math.sin(c*s))/(Math.cos(e*s)*Math.cos(c*s)))/s;(isNaN(u)||0===u)&&(u=o/Math.cos(Math.PI/180*e)),this._point=h.subtract(n.getPixelOrigin()),this._radius=isNaN(u)?0:h.x-n.project([c,t-u]).x,this._radiusY=h.y-r.y}else{var l=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(l).x}this._updateBounds()}});function ci(t,e,n){return new hi(t,e,n)}var ui=oi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){f(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=1/0,s=null,o=zn,r=0,a=this._parts.length;r<a;r++)for(var h=this._parts[r],c=1,u=h.length;c<u;c++){var l=o(t,e=h[c-1],n=h[c],!0);l<i&&(i=l,s=o(t,e,n))}return s&&(s.distance=Math.sqrt(i)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=U(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new B,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Bn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=Bn(t),i=0,s=t.length;i<s;i++)n?(e[i]=U(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new M(t,t);this._rawPxBounds&&(this._pxBounds=new R([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,n){var i,s,o=t[0]instanceof V,r=t.length;if(o){for(s=[],i=0;i<r;i++)s[i]=this._map.latLngToLayerPoint(t[i]),n.extend(s[i]);e.push(s)}else for(i=0;i<r;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,i,s,o,r,a,h=this._parts;for(e=0,i=0,s=this._rings.length;e<s;e++)for(n=0,o=(a=this._rings[e]).length;n<o-1;n++)(r=Mn(a[n],a[n+1],t,n,!0))&&(h[i]=h[i]||[],h[i].push(r[0]),r[1]===a[n+1]&&n!==o-2||(h[i].push(r[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=In(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,s,o,r,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,o=this._parts.length;n<o;n++)for(i=0,s=(r=(a=this._parts[n]).length)-1;i<r;s=i++)if((e||0!==i)&&Ln(t,a[s],a[i])<=h)return!0;return!1}});function li(t,e){return new ui(t,e)}ui._flat=Fn;var di=ui.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Tn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=ui.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof V&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){ui.prototype._setLatLngs.call(this,t),Bn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Bn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new M(e,e);if(t=new R(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,s=0,o=this._rings.length;s<o;s++)(i=xn(this._rings[s],t,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,s,o,r,a,h,c=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(s=0,a=this._parts.length;s<a;s++)for(o=0,r=(h=(e=this._parts[s]).length)-1;o<h;r=o++)n=e[o],i=e[r],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c||ui.prototype._containsPoint.call(this,t,!0)}});function fi(t,e){return new di(t,e)}var pi=Yn.extend({initialize:function(t,e){f(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,s=_(t)?t:t.features;if(s){for(e=0,n=s.length;e<n;e++)((i=s[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var r=mi(t,o);return r?(r.feature=xi(t),r.defaultOptions=r.options,this.resetStyle(r),o.onEachFeature&&o.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function mi(t,e){var n,i,s,o,r="Feature"===t.type?t.geometry:t,a=r?r.coordinates:null,h=[],c=e&&e.pointToLayer,u=e&&e.coordsToLatLng||_i;if(!a&&!r)return null;switch(r.type){case"Point":return gi(c,t,n=u(a),e);case"MultiPoint":for(s=0,o=a.length;s<o;s++)n=u(a[s]),h.push(gi(c,t,n,e));return new Yn(h);case"LineString":case"MultiLineString":return i=yi(a,"LineString"===r.type?0:1,u),new ui(i,e);case"Polygon":case"MultiPolygon":return i=yi(a,"Polygon"===r.type?1:2,u),new di(i,e);case"GeometryCollection":for(s=0,o=r.geometries.length;s<o;s++){var l=mi({geometry:r.geometries[s],type:"Feature",properties:t.properties},e);l&&h.push(l)}return new Yn(h);case"FeatureCollection":for(s=0,o=r.features.length;s<o;s++){var d=mi(r.features[s],e);d&&h.push(d)}return new Yn(h);default:throw new Error("Invalid GeoJSON object.")}}function gi(t,e,n,i){return t?t(e,n):new ii(n,i&&i.markersInheritOptions&&i)}function _i(t){return new V(t[1],t[0],t[2])}function yi(t,e,n){for(var i,s=[],o=0,r=t.length;o<r;o++)i=e?yi(t[o],e-1,n):(n||_i)(t[o]),s.push(i);return s}function vi(t,e){return void 0!==(t=U(t)).alt?[u(t.lng,e),u(t.lat,e),u(t.alt,e)]:[u(t.lng,e),u(t.lat,e)]}function wi(t,e,n,i){for(var s=[],o=0,r=t.length;o<r;o++)s.push(e?wi(t[o],Bn(t[o])?0:e-1,n,i):vi(t[o],i));return!e&&n&&s.length>0&&s.push(s[0].slice()),s}function bi(t,e){return t.feature?n({},t.feature,{geometry:e}):xi(e)}function xi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Ti={toGeoJSON:function(t){return bi(this,{type:"Point",coordinates:vi(this.getLatLng(),t)})}};function Ei(t,e){return new pi(t,e)}ii.include(Ti),hi.include(Ti),ri.include(Ti),ui.include({toGeoJSON:function(t){var e=!Bn(this._latlngs);return bi(this,{type:(e?"Multi":"")+"LineString",coordinates:wi(this._latlngs,e?1:0,!1,t)})}}),di.include({toGeoJSON:function(t){var e=!Bn(this._latlngs),n=e&&!Bn(this._latlngs[0]),i=wi(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),bi(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),Wn.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),bi(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,i=[];return this.eachLayer((function(e){if(e.toGeoJSON){var s=e.toGeoJSON(t);if(n)i.push(s.geometry);else{var o=xi(s);"FeatureCollection"===o.type?i.push.apply(i,o.features):i.push(o)}}})),n?bi(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var Si=Ei,Ci=Kn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=F(e),f(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(be(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ge(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ye(this._image),this},bringToBack:function(){return this._map&&ve(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=F(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:me("img");be(e,"leaflet-image-layer"),this._zoomAnimated&&be(e,"leaflet-zoom-animated"),this.options.className&&be(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onload=s(this.fire,this,"load"),e.onerror=s(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Le(this._image,n,e)},_reset:function(){var t=this._image,e=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();Pe(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){Se(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Ii=function(t,e,n){return new Ci(t,e,n)},Li=Ci.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:me("video");if(be(e,"leaflet-image-layer"),this._zoomAnimated&&be(e,"leaflet-zoom-animated"),this.options.className&&be(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onloadeddata=s(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),i=[],o=0;o<n.length;o++)i.push(n[o].src);this._url=n.length>0?i:[e.src]}else{_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var r=0;r<this._url.length;r++){var a=me("source");a.src=this._url[r],e.appendChild(a)}}}});function Pi(t,e,n){return new Li(t,e,n)}var Ai=Ci.extend({_initImage:function(){var t=this._image=this._url;be(t,"leaflet-image-layer"),this._zoomAnimated&&be(t,"leaflet-zoom-animated"),this.options.className&&be(t,this.options.className),t.onselectstart=c,t.onmousemove=c}});function ki(t,e,n){return new Ai(t,e,n)}var Di=Kn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof V||_(t))?(this._latlng=U(t),f(this,e)):(f(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return(t=arguments.length?t:this._source._map).hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Se(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Se(this._container,1),this.bringToFront(),this.options.interactive&&(be(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(Se(this._container,0),this._removeTimeout=setTimeout(s(ge,void 0,this._container),200)):ge(this._container),this.options.interactive&&(xe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=U(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ye(this._container),this},bringToBack:function(){return this._map&&ve(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof Yn){e=null;var n=this._source._layers;for(var i in n)if(n[i]._map){e=n[i];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else{if(!e.getBounds)throw new Error("Unable to get source layer LatLng.");t=e.getBounds().getCenter()}return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=O(this.options.offset),n=this._getAnchor();this._zoomAnimated?Pe(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}});on.include({_initOverlay:function(t,e,n,i){var s=e;return s instanceof t||(s=new t(i).setContent(e)),n&&s.setLatLng(n),s}}),Kn.include({_initOverlay:function(t,e,n,i){var s=n;return s instanceof t?(f(s,i),s._source=this):(s=e&&!i?e:new t(i,this)).setContent(n),s}});var Mi=Di.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Di.prototype.openOn.call(this,t)},onAdd:function(t){Di.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof oi||this._source.on("preclick",He))},onRemove:function(t){Di.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof oi||this._source.off("preclick",He))},getEvents:function(){var t=Di.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=me("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=me("div",t+"-content-wrapper",e);if(this._contentNode=me("div",t+"-content",n),Ke(e),Ge(this._contentNode),Fe(e,"contextmenu",He),this._tipContainer=me("div",t+"-tip-container",e),this._tip=me("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=me("a",t+"-close-button",e);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',Fe(i,"click",(function(t){We(t),this.close()}),this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,s=this.options.maxHeight,o="leaflet-popup-scrolled";s&&i>s?(e.height=s+"px",be(t,o)):xe(t,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();Pe(this._container,e.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,e=parseInt(pe(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,s=new M(this._containerLeft,-n-this._containerBottom);s._add(Ae(this._container));var o=t.layerPointToContainerPoint(s),r=O(this.options.autoPanPadding),a=O(this.options.autoPanPaddingTopLeft||r),h=O(this.options.autoPanPaddingBottomRight||r),c=t.getSize(),u=0,l=0;o.x+i+h.x>c.x&&(u=o.x+i-c.x+h.x),o.x-u-a.x<0&&(u=o.x-a.x),o.y+n+h.y>c.y&&(l=o.y+n-c.y+h.y),o.y-l-a.y<0&&(l=o.y-a.y),(u||l)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([u,l]))}},_getAnchor:function(){return O(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ni=function(t,e){return new Mi(t,e)};on.mergeOptions({closePopupOnClick:!0}),on.include({openPopup:function(t,e,n){return this._initOverlay(Mi,t,e,n).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Kn.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Mi,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof Yn||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){Qe(t);var e=t.layer||t.target;this._popup._source!==e||e instanceof oi?(this._popup._source=e,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Oi=Di.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Di.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Di.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Di.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=me("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+r(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,n,i=this._map,s=this._container,o=i.latLngToContainerPoint(i.getCenter()),r=i.layerPointToContainerPoint(t),a=this.options.direction,h=s.offsetWidth,c=s.offsetHeight,u=O(this.options.offset),l=this._getAnchor();"top"===a?(e=h/2,n=c):"bottom"===a?(e=h/2,n=0):"center"===a?(e=h/2,n=c/2):"right"===a?(e=0,n=c/2):"left"===a?(e=h,n=c/2):r.x<o.x?(a="right",e=0,n=c/2):(a="left",e=h+2*(u.x+l.x),n=c/2),t=t.subtract(O(e,n,!0)).add(u).add(l),xe(s,"leaflet-tooltip-right"),xe(s,"leaflet-tooltip-left"),xe(s,"leaflet-tooltip-top"),xe(s,"leaflet-tooltip-bottom"),be(s,"leaflet-tooltip-"+a),Pe(s,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Se(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return O(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ri=function(t,e){return new Oi(t,e)};on.include({openTooltip:function(t,e,n){return this._initOverlay(Oi,t,e,n).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Kn.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Oi,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof Yn||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&(Fe(e,"focus",(function(){this._tooltip._source=t,this.openTooltip()}),this),Fe(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e="function"==typeof t.getElement&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",(function(){e._openOnceFlag=!1,e._openTooltip(t)}))}else this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var zi=Jn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(_e(e),e.appendChild(n.html)):e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=O(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Bi(t){return new zi(t)}Jn.Default=ei;var Fi=Kn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Bt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){f(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ge(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ye(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ve(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=a(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof M?t:new M(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,i=-t(-1/0,1/0),s=0,o=n.length;s<o;s++)e=n[s].style.zIndex,n[s]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Bt.ielt9){Se(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var s=this._tiles[i];if(s.current&&s.loaded){var o=Math.min(1,(t-s.loaded)/200);Se(s.el,o),o<1?e=!0:(s.active?n=!0:this._onOpaqueTile(s),s.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(C(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(ge(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],s=this._map;return i||((i=this._levels[t]={}).el=me("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=s.project(s.unproject(s.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,s.getCenter(),s.getZoom()),c(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ge(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,i){var s=Math.floor(t/2),o=Math.floor(e/2),r=n-1,a=new M(+s,+o);a.z=+r;var h=this._tileCoordsToKey(a),c=this._tiles[h];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),r>i&&this._retainParent(s,o,r,i))},_retainChildren:function(t,e,n,i){for(var s=2*t;s<2*t+2;s++)for(var o=2*e;o<2*e+2;o++){var r=new M(s,o);r.z=n+1;var a=this._tileCoordsToKey(r),h=this._tiles[a];h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),n+1<i&&this._retainChildren(s,o,n+1,i))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var s=Math.round(e);s=void 0!==this.options.maxZoom&&s>this.options.maxZoom||void 0!==this.options.minZoom&&s<this.options.minZoom?void 0:this._clampZoom(s);var o=this.options.updateWhenZooming&&s!==this._tileZoom;i&&!o||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==s&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),s=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();Bt.any3d?Le(t.el,s,i):Pe(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,s=this._map.getPixelWorldBounds(this._tileZoom);s&&(this._globalTileRange=this._pxBoundsToTileRange(s)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),s=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*i);return new R(s.subtract(o),s.add(o))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(t),s=this._pxBoundsToTileRange(i),o=s.getCenter(),r=[],a=this.options.keepBuffer,h=new R(s.getBottomLeft().subtract([a,-a]),s.getTopRight().add([a,-a]));if(!(isFinite(s.min.x)&&isFinite(s.min.y)&&isFinite(s.max.x)&&isFinite(s.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var u=this._tiles[c].coords;u.z===this._tileZoom&&h.contains(new M(u.x,u.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var l=s.min.y;l<=s.max.y;l++)for(var d=s.min.x;d<=s.max.x;d++){var f=new M(d,l);if(f.z=this._tileZoom,this._isValidTile(f)){var p=this._tiles[this._tileCoordsToKey(f)];p?p.current=!0:r.push(f)}}if(r.sort((function(t,e){return t.distanceTo(o)-e.distanceTo(o)})),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<r.length;d++)this._addTile(r[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return F(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),s=i.add(n);return[e.unproject(i,t.z),e.unproject(s,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new B(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new M(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(ge(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){be(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=c,t.onmousemove=c,Bt.ielt9&&this.options.opacity<1&&Se(t,this.options.opacity)},_addTile:function(t,e){var n=this._getTilePos(t),i=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),s(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&S(s(this._tileReady,this,t,null,o)),Pe(o,n),this._tiles[i]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var i=this._tileCoordsToKey(t);(n=this._tiles[i])&&(n.loaded=+new Date,this._map._fadeAnimated?(Se(n.el,0),C(this._fadeFrame),this._fadeFrame=S(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(be(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Bt.ielt9||!this._map._fadeAnimated?S(this._pruneTiles,this):setTimeout(s(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new M(this._wrapX?h(t.x,this._wrapX):t.x,this._wrapY?h(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new R(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Vi(t){return new Fi(t)}var Ui=Fi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,(e=f(this,e)).detectRetina&&Bt.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Fe(n,"load",s(this._tileOnLoad,this,e,n)),Fe(n,"error",s(this._tileOnError,this,e,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:Bt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return g(this._url,n(e,this.options))},_tileOnLoad:function(t,e){Bt.ielt9?setTimeout(s(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.getAttribute("src")!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=c,e.onerror=c,!e.complete)){e.src=v;var n=this._tiles[t].coords;ge(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:n})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",v),Fi.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==v))return Fi.prototype._tileReady.call(this,t,e,n)}});function ji(t,e){return new Ui(t,e)}var Zi=Ui.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=n({},this.defaultWmsParams);for(var s in e)s in this.options||(i[s]=e[s]);var o=(e=f(this,e)).detectRetina&&Bt.retina?2:1,r=this.getTileSize();i.width=r.x*o,i.height=r.y*o,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,Ui.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,i=z(n.project(e[0]),n.project(e[1])),s=i.min,o=i.max,r=(this._wmsVersion>=1.3&&this._crs===Hn?[s.y,s.x,o.y,o.x]:[s.x,s.y,o.x,o.y]).join(","),a=Ui.prototype.getTileUrl.call(this,t);return a+p(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+r},setParams:function(t,e){return n(this.wmsParams,t),e||this.redraw(),this}});function $i(t,e){return new Zi(t,e)}Ui.WMS=Zi,ji.wms=$i;var qi=Kn.extend({options:{padding:.1},initialize:function(t){f(this,t),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),be(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),s=this._map.project(this._center,e),o=i.multiplyBy(-n).add(s).subtract(this._map._getNewPixelOrigin(t,e));Bt.any3d?Le(this._container,o,n):Pe(this._container,o)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new R(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Hi=qi.extend({options:{tolerance:0},getEvents:function(){var t=qi.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){qi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Fe(t,"mousemove",this._onMouseMove,this),Fe(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Fe(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){C(this._redrawRequest),delete this._ctx,ge(this._container),Ue(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){qi.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=Bt.retina?2:1;Pe(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",Bt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){qi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[r(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[r(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,n,i=t.options.dashArray.split(/[, ]+/),s=[];for(n=0;n<i.length;n++){if(e=Number(i[n]),isNaN(e))return;s.push(e)}t.options._dashArray=s}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||S(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,s,o,r=t._parts,a=r.length,h=this._ctx;if(a){for(h.beginPath(),n=0;n<a;n++){for(i=0,s=r[n].length;i<s;i++)o=r[n][i],h[i?"lineTo":"moveTo"](o.x,o.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=Math.max(Math.round(t._radius),1),s=(Math.max(Math.round(t._radiusY),1)||i)/i;1!==s&&(n.save(),n.scale(1,s)),n.beginPath(),n.arc(e.x,e.y/s,i,0,2*Math.PI,!1),1!==s&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),s=this._drawFirst;s;s=s.next)(e=s.layer).options.interactive&&e._containsPoint(i)&&("click"!==t.type&&"preclick"!==t.type||!this._map._draggableMoved(e))&&(n=e);this._fireEvent(!!n&&[n],t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(xe(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,i,o=this._drawFirst;o;o=o.next)(n=o.layer).options.interactive&&n._containsPoint(e)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(be(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(s((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function Gi(t){return Bt.canvas?new Hi(t):null}var Ki=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Wi={_initContainer:function(){this._container=me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(qi.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Ki("shape");be(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Ki("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;ge(e),t.removeInteractiveTarget(e),delete this._layers[r(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,s=t._container;s.stroked=!!i.stroke,s.filled=!!i.fill,i.stroke?(e||(e=t._stroke=Ki("stroke")),s.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=_(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(s.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=Ki("fill")),s.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(s.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ye(t._container)},_bringToBack:function(t){ve(t._container)}},Qi=Bt.vml?Ki:Y,Yi=qi.extend({_initContainer:function(){this._container=Qi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Qi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ge(this._container),Ue(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){qi.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),Pe(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Qi("path");t.options.className&&be(e,t.options.className),t.options.interactive&&be(e,"leaflet-interactive"),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ge(t._path),t.removeInteractiveTarget(t._path),delete this._layers[r(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,X(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),i="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",s=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ye(t._path)},_bringToBack:function(t){ve(t._path)}});function Xi(t){return Bt.svg||Bt.vml?new Yi(t):null}Bt.vml&&Yi.include(Wi),on.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&Gi(t)||Xi(t)}});var Ji=di.extend({initialize:function(t,e){di.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=F(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function ts(t,e){return new Ji(t,e)}Yi.create=Qi,Yi.pointsToPath=X,pi.geometryToLayer=mi,pi.coordsToLatLng=_i,pi.coordsToLatLngs=yi,pi.latLngToCoords=vi,pi.latLngsToCoords=wi,pi.getFeature=bi,pi.asFeature=xi,on.mergeOptions({boxZoom:!0});var es=yn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Fe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ue(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ge(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),oe(),De(),this._startPoint=this._map.mouseEventToContainerPoint(t),Fe(document,{contextmenu:Qe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=me("div","leaflet-zoom-box",this._container),be(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new R(this._point,this._startPoint),n=e.getSize();Pe(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(ge(this._box),xe(this._container,"leaflet-crosshair")),re(),Me(),Ue(document,{contextmenu:Qe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(s(this._resetState,this),0);var e=new B(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});on.addInitHook("addHandler","boxZoom",es),on.mergeOptions({doubleClickZoom:!0});var ns=yn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,s=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(s):e.setZoomAround(t.containerPoint,s)}});on.addInitHook("addHandler","doubleClickZoom",ns),on.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var is=yn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new bn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}be(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){xe(this._map._container,"leaflet-grab"),xe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=F(this._map.options.maxBounds);this._offsetLimit=z(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,s=(i-e+n)%t+e-n,o=(i+e+n)%t-e-n,r=Math.abs(s+n)<Math.abs(o+n)?s:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{this._prunePositions(+new Date);var s=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,r=n.easeLinearity,a=s.multiplyBy(r/o),h=a.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,h),u=a.multiplyBy(c/h),l=c/(n.inertiaDeceleration*r),d=u.multiplyBy(-l/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),S((function(){e.panBy(d,{duration:l,easeLinearity:r,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});on.addInitHook("addHandler","dragging",is),on.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ss=yn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Fe(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ue(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},s=this.keyCodes;for(e=0,n=s.left.length;e<n;e++)i[s.left[e]]=[-1*t,0];for(e=0,n=s.right.length;e<n;e++)i[s.right[e]]=[t,0];for(e=0,n=s.down.length;e<n;e++)i[s.down[e]]=[0,t];for(e=0,n=s.up.length;e<n;e++)i[s.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},s=this.keyCodes;for(e=0,n=s.zoomIn.length;e<n;e++)i[s.zoomIn[e]]=t;for(e=0,n=s.zoomOut.length;e<n;e++)i[s.zoomOut[e]]=-t},_addHooks:function(){Fe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ue(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(e=this._panKeys[n],t.shiftKey&&(e=O(e).multiplyBy(3)),i.options.maxBounds&&(e=i._limitOffset(O(e),i.options.maxBounds)),i.options.worldCopyJump){var s=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(e)));i.panTo(s)}else i.panBy(e)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Qe(t)}}});on.addInitHook("addHandler","keyboard",ss),on.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var os=yn.extend({addHooks:function(){Fe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ue(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=tn(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s(this._performZoom,this),i),Qe(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),s=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,o=n?Math.ceil(s/n)*n:s,r=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}});on.addInitHook("addHandler","scrollWheelZoom",os);var rs=600;on.mergeOptions({tapHold:Bt.touchNative&&Bt.safari&&Bt.mobile,tapTolerance:15});var as=yn.extend({addHooks:function(){Fe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ue(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),1===t.touches.length){var e=t.touches[0];this._startPos=this._newPos=new M(e.clientX,e.clientY),this._holdTimeout=setTimeout(s((function(){this._cancel(),this._isTapValid()&&(Fe(document,"touchend",We),Fe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))}),this),rs),Fe(document,"touchend touchcancel contextmenu",this._cancel,this),Fe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Ue(document,"touchend",We),Ue(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Ue(document,"touchend touchcancel contextmenu",this._cancel,this),Ue(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new M(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var n=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});n._simulated=!0,e.target.dispatchEvent(n)}});on.addInitHook("addHandler","tapHold",as),on.mergeOptions({touchZoom:Bt.touch,bounceAtZoomLimits:!0});var hs=yn.extend({addHooks:function(){be(this._map._container,"leaflet-touch-zoom"),Fe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){xe(this._map._container,"leaflet-touch-zoom"),Ue(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Fe(document,"touchmove",this._onTouchMove,this),Fe(document,"touchend touchcancel",this._onTouchEnd,this),We(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(i)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var r=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),C(this._animRequest);var a=s(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=S(a,this,!0),We(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,C(this._animRequest),Ue(document,"touchmove",this._onTouchMove,this),Ue(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});on.addInitHook("addHandler","touchZoom",hs),on.BoxZoom=es,on.DoubleClickZoom=ns,on.Drag=is,on.Keyboard=ss,on.ScrollWheelZoom=os,on.TapHold=as,on.TouchZoom=hs,t.Bounds=R,t.Browser=Bt,t.CRS=Z,t.Canvas=Hi,t.Circle=hi,t.CircleMarker=ri,t.Class=P,t.Control=an,t.DivIcon=zi,t.DivOverlay=Di,t.DomEvent=nn,t.DomUtil=Be,t.Draggable=bn,t.Evented=D,t.FeatureGroup=Yn,t.GeoJSON=pi,t.GridLayer=Fi,t.Handler=yn,t.Icon=Jn,t.ImageOverlay=Ci,t.LatLng=V,t.LatLngBounds=B,t.Layer=Kn,t.LayerGroup=Wn,t.LineUtil=Un,t.Map=on,t.Marker=ii,t.Mixin=vn,t.Path=oi,t.Point=M,t.PolyUtil=Cn,t.Polygon=di,t.Polyline=ui,t.Popup=Mi,t.PosAnimation=sn,t.Projection=$n,t.Rectangle=Ji,t.Renderer=qi,t.SVG=Yi,t.SVGOverlay=Ai,t.TileLayer=Ui,t.Tooltip=Oi,t.Transformation=G,t.Util=I,t.VideoOverlay=Li,t.bind=s,t.bounds=z,t.canvas=Gi,t.circle=ci,t.circleMarker=ai,t.control=hn,t.divIcon=Bi,t.extend=n,t.featureGroup=Xn,t.geoJSON=Ei,t.geoJson=Si,t.gridLayer=Vi,t.icon=ti,t.imageOverlay=Ii,t.latLng=U,t.latLngBounds=F,t.layerGroup=Qn,t.map=rn,t.marker=si,t.point=O,t.polygon=fi,t.polyline=li,t.popup=Ni,t.rectangle=ts,t.setOptions=f,t.stamp=r,t.svg=Xi,t.svgOverlay=ki,t.tileLayer=ji,t.tooltip=Ri,t.transformation=K,t.version=e,t.videoOverlay=Pi;var cs=window.L;t.noConflict=function(){return window.L=cs,this},window.L=t})(Of.exports);var Rf=Nf(Of.exports);function zf(e){let n;return{c(){n=c("div"),p(n,"id","map-form-ubi"),p(n,"class","svelte-18zb2y6")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&h(n)}}}function Bf(t,e,n){let i,s=null,{currentUbication:o}=e,{ubicationDefault:r=[-25,-56]}=e;const a=T();return x((()=>{i=Rf.map("map-form-ubi").setView(r,6),Rf.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(i);const t=Rf.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png"});i.on("click",(function(e){confirm("Perdiste o encotraste algo, agregalo aqui")&&(null!=s&&s.remove(),n(0,o=e.latlng),s=Rf.marker(o,{icon:t}).addTo(i).bindPopup("You clicked the map at "+e.latlng),a("set-ubicacion",o))}))})),t.$$set=t=>{"currentUbication"in t&&n(0,o=t.currentUbication),"ubicationDefault"in t&&n(1,r=t.ubicationDefault)},[o,r]}class Ff extends q{constructor(t){super(),$(this,t,Bf,zf,o,{currentUbication:0,ubicationDefault:1})}}const Vf=()=>`${(t=>{const e="abcdefghijklmnopqrstuvwxyz";let n="";for(let i=0;i<t;i++){const t=Math.floor(26*Math.random());n+=e.charAt(t)}return n})(4)}-${Math.floor(10001*Math.random())+1e4}`;function Uf(t){let e,n,s,o,u,m,v,w,b,x,T,E,S,C,I,L,P,A,k,D,M,N,O,R,z,Z,$,q,H,G,K,W,Q,Y,X,J,tt,et,nt,it,st,ot,rt,at,ht,ct,ut,lt,dt,ft,pt,mt,gt,_t,yt,vt,wt,bt,xt,Tt,Et,St,Ct,It,Lt,Pt,At,kt,Dt,Mt,Nt,Ot=""==t[0].estado?"":`en que ${t[0].estado}`;return Ct=new Ff({}),Ct.$on("set-ubicacion",t[3]),kt=g(t[5][0]),Dt=g(t[5][1]),{c(){e=c("div"),n=c("div"),s=c("label"),s.textContent="¿Qué pasó con el objeto?",o=d(),u=c("label"),m=c("input"),v=l(" Encontré"),w=d(),b=c("label"),x=c("input"),T=l(" Perdí"),E=d(),S=c("div"),C=c("label"),C.textContent="Nombre/s:",I=d(),L=c("input"),P=d(),A=c("div"),k=c("label"),D=l("Fecha "),M=l(Ot),N=l(":"),O=d(),R=c("input"),z=d(),Z=c("small"),Z.textContent=`Formato: 01/01/${(new Date).getFullYear()}`,$=d(),q=c("div"),H=c("label"),H.textContent="Teléfono:",G=d(),K=c("input"),W=c("br"),Q=d(),Y=c("small"),Y.textContent="Formato: 0991123456 (sin espacios)",X=d(),J=c("div"),tt=c("label"),tt.textContent="Descripción:",et=d(),nt=c("input"),it=d(),st=c("div"),ot=c("label"),ot.textContent="¿Qué cosas perdiste?",rt=d(),at=c("label"),ht=c("input"),ct=l(" Llaves"),ut=d(),lt=c("label"),dt=c("input"),ft=l(" Billetera"),pt=d(),mt=c("label"),gt=c("input"),_t=l(" Teléfono"),yt=d(),vt=c("label"),wt=c("input"),bt=l(" Cartera"),xt=d(),Tt=c("div"),Et=c("label"),Et.textContent="Indicar donde",St=d(),V(Ct.$$.fragment),It=d(),Lt=c("div"),Pt=c("button"),Pt.textContent="Enviar",p(m,"type","radio"),m.__value="encontre",m.value=m.__value,p(x,"type","radio"),x.__value="perdi",x.value=x.__value,p(n,"class","my-5"),p(L,"type","text"),p(L,"class",t[1].inputText),p(S,"class","my-5"),p(R,"type","text"),p(R,"class",t[1].inputText),p(A,"class","my-5"),p(H,"class","mt-3"),p(K,"type","tel"),p(K,"pattern","[0-9]3-[0-9]3-[0-9]4"),p(K,"class",t[1].inputText),p(q,"class","my-5"),p(nt,"type","text"),p(nt,"class",t[1].inputText),p(J,"class","my-5"),p(ot,"class","mt-3"),p(ht,"type","checkbox"),ht.__value="Llaves",ht.value=ht.__value,p(dt,"type","checkbox"),dt.__value="Billetera",dt.value=dt.__value,p(gt,"type","checkbox"),gt.__value="Teléfono",gt.value=gt.__value,p(wt,"type","checkbox"),wt.__value="Cartera",wt.value=wt.__value,p(st,"class","my-5"),p(Et,"class","mt-3"),p(Tt,"class","my-5"),p(Pt,"class","w-full bg-blue-500 text-white p-2 rounded-lg border-o w-100"),p(Lt,"class","my-3 "),kt.p(ht,dt,gt,wt),Dt.p(m,x)},m(i,h){a(i,e,h),r(e,n),r(n,s),r(n,o),r(n,u),r(u,m),m.checked=m.__value===t[0].estado,r(u,v),r(n,w),r(n,b),r(b,x),x.checked=x.__value===t[0].estado,r(b,T),r(e,E),r(e,S),r(S,C),r(S,I),r(S,L),y(L,t[0].nombre),r(e,P),r(e,A),r(A,k),r(k,D),r(k,M),r(k,N),r(A,O),r(A,R),y(R,t[0].fecha),r(A,z),r(A,Z),r(e,$),r(e,q),r(q,H),r(q,G),r(q,K),y(K,t[0].telefono),r(q,W),r(q,Q),r(q,Y),r(e,X),r(e,J),r(J,tt),r(J,et),r(J,nt),y(nt,t[0].descripcion),r(e,it),r(e,st),r(st,ot),r(st,rt),r(st,at),r(at,ht),ht.checked=~(t[0].cosas||[]).indexOf(ht.__value),r(at,ct),r(st,ut),r(st,lt),r(lt,dt),dt.checked=~(t[0].cosas||[]).indexOf(dt.__value),r(lt,ft),r(st,pt),r(st,mt),r(mt,gt),gt.checked=~(t[0].cosas||[]).indexOf(gt.__value),r(mt,_t),r(st,yt),r(st,vt),r(vt,wt),wt.checked=~(t[0].cosas||[]).indexOf(wt.__value),r(vt,bt),r(e,xt),r(e,Tt),r(Tt,Et),r(Tt,St),U(Ct,Tt,null),r(e,It),r(e,Lt),r(Lt,Pt),At=!0,Mt||(Nt=[f(m,"change",t[4]),f(x,"change",t[6]),f(L,"input",t[7]),f(R,"input",t[8]),f(K,"input",t[9]),f(nt,"input",t[10]),f(ht,"change",t[11]),f(dt,"change",t[12]),f(gt,"change",t[13]),f(wt,"change",t[14]),f(Pt,"click",t[2])],Mt=!0)},p(t,[e]){1&e&&(m.checked=m.__value===t[0].estado),1&e&&(x.checked=x.__value===t[0].estado),1&e&&L.value!==t[0].nombre&&y(L,t[0].nombre),(!At||1&e)&&Ot!==(Ot=""==t[0].estado?"":`en que ${t[0].estado}`)&&_(M,Ot),1&e&&R.value!==t[0].fecha&&y(R,t[0].fecha),1&e&&y(K,t[0].telefono),1&e&&nt.value!==t[0].descripcion&&y(nt,t[0].descripcion),1&e&&(ht.checked=~(t[0].cosas||[]).indexOf(ht.__value)),1&e&&(dt.checked=~(t[0].cosas||[]).indexOf(dt.__value)),1&e&&(gt.checked=~(t[0].cosas||[]).indexOf(gt.__value)),1&e&&(wt.checked=~(t[0].cosas||[]).indexOf(wt.__value))},i(t){At||(B(Ct.$$.fragment,t),At=!0)},o(t){F(Ct.$$.fragment,t),At=!1},d(t){t&&h(e),j(Ct),kt.r(),Dt.r(),Mt=!1,i(Nt)}}}function jf(t,e,n){let i={estado:"",nombre:"",telefono:"",cosas:[],fecha:"",ubicacion:null};function s(){n(0,i={estado:"",nombre:"",telefono:"",cosas:[],fecha:"",ubicacion:null})}x((()=>{s()}));const o=[[],[]];return[i,{inputText:"bg-gray-50 w-100 rounded-lg p-2 w-full"},async function(){try{const t=Vf().toString().toUpperCase(),e=new Date,n={...i,codigo:t,fechaCreacion:e,id:t};if((t=>{for(const e in t)if(Object.hasOwnProperty.call(t,e)){const n=t[e];if(!n||null==n||""==n)return!0}return!1})(n))throw"Verifique que todos los campos hayan sido completados";kf(Vd(Mf,"cosas"),n).then((t=>{s()})),alert(`Por favor guarde o quitele una foto al código: ${t}`)}catch(t){alert(t)}},function(t){n(0,i.ubicacion=JSON.stringify(t.detail),i)},function(){i.estado=this.__value,n(0,i)},o,function(){i.estado=this.__value,n(0,i)},function(){i.nombre=this.value,n(0,i)},function(){i.fecha=this.value,n(0,i)},function(){i.telefono=this.value,n(0,i)},function(){i.descripcion=this.value,n(0,i)},function(){i.cosas=m(o[0],this.__value,this.checked),n(0,i)},function(){i.cosas=m(o[0],this.__value,this.checked),n(0,i)},function(){i.cosas=m(o[0],this.__value,this.checked),n(0,i)},function(){i.cosas=m(o[0],this.__value,this.checked),n(0,i)}]}class Zf extends q{constructor(t){super(),$(this,t,jf,Uf,o,{})}}function $f(e){let n;return{c(){n=c("div"),p(n,"id","map"),p(n,"class","svelte-33nii4")},m(t,e){a(t,n,e)},p:t,i:t,o:t,d(t){t&&h(n)}}}function qf(t,e,n){let i,{cosas:s}=e,o=[],r=[-25,-56];async function a(){const t=Rf.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png"});o.forEach((t=>i.removeLayer(t)));const e=function(t,e,...n){let i=[];e instanceof gf&&i.push(e),i=i.concat(n),function(t){const e=t.filter((t=>t instanceof vf)).length,n=t.filter((t=>t instanceof yf)).length;if(e>1||e>0&&n>0)throw new fr(dr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(i);for(const e of i)t=e._apply(t);return t}(Vd(Mf,"cosas"),function(t,e="asc"){const n=e,i=mf("orderBy",t);return wf._create(i,n)}("id","desc"));Df(e,(e=>{n(0,s=e.docs),s.forEach((e=>{const n=e.data(),s=JSON.parse(n.ubicacion);Rf.marker([s.lat,s.lng],{icon:t}).addTo(i)}))}))}return x((()=>{i=Rf.map("map").setView(r,6),Rf.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(i),a(),i.on("click",(function(t){confirm("Perdiste o encotraste algo, agregalo aqui")&&Rf.marker(t.latlng,{icon:icon}).addTo(i).bindPopup("You clicked the map at "+t.latlng.toString())}))})),t.$$set=t=>{"cosas"in t&&n(0,s=t.cosas)},[s]}class Hf extends q{constructor(t){super(),$(this,t,qf,$f,o,{cosas:0})}}function Gf(e){let n,i,s,o,l,f,m,g,_,y,v,w,b,x,T,E,S;return{c(){n=c("section"),i=c("div"),s=c("a"),o=c("span"),o.textContent="Ayudame",l=d(),f=c("span"),f.textContent=`La plataforma tiene ${e[0]} dias`,m=d(),g=u("svg"),_=u("path"),y=d(),v=c("h1"),v.textContent="Crear historias de esperanza y reencuentros!",w=d(),b=c("p"),b.textContent="Explora el listado de cosas perdidas y encontradas, dale la oportunidad para vuelvan a sus casas y con sus dueños. Se parte de este espacio de solidaridad y alegría.",x=d(),T=c("div"),T.innerHTML='<a href="#" class="inline-flex justify-center items-center py-3 px-5 text-base font-medium text-center text-white rounded-lg bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-900">Encontra por tu codigo\n                <svg class="ml-2 -mr-1 w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></a> \n            <input type="text" class="inline-flex justify-center items-center py-3 px-5 text-base font-medium text-center text-gray-900 rounded-lg border border-gray-300 hover:bg-gray-100 focus:ring-4 focus:ring-gray-100 dark:text-white dark:border-gray-700 dark:hover:bg-gray-700 dark:focus:ring-gray-800"/>',E=d(),S=c("div"),p(o,"class","text-xs bg-primary-600 rounded-full text-blue px-4 py-1.5 mr-3"),p(f,"class","text-sm font-medium"),p(_,"fill-rule","evenodd"),p(_,"d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"),p(_,"clip-rule","evenodd"),p(g,"class","ml-2 w-5 h-5"),p(g,"fill","currentColor"),p(g,"viewBox","0 0 20 20"),p(g,"xmlns","http://www.w3.org/2000/svg"),p(s,"href","https://github.com/ivanfretes/sepierde.org"),p(s,"target","_blank"),p(s,"class","inline-flex justify-between items-center py-1 px-1 pr-4 mb-7 text-sm text-gray-700 bg-gray-100 rounded-full dark:bg-gray-800 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-700"),p(s,"role","alert"),p(v,"class","mb-4 text-4xl font-extrabold tracking-tight leading-none text-gray-900 md:text-5xl lg:text-6xl dark:text-white"),p(b,"class","mb-8 text-lg font-normal text-gray-500 lg:text-xl sm:px-16 xl:px-48 dark:text-gray-400"),p(T,"class","flex flex-col mb-8 lg:mb-16 space-y-4 sm:flex-row sm:justify-center sm:space-y-0 sm:space-x-4"),p(i,"class","py-8 px-4 mx-auto max-w-screen-xl text-center lg:py-16 lg:px-12"),p(n,"class","bg-white dark:bg-gray-900")},m(t,e){a(t,n,e),r(n,i),r(i,s),r(s,o),r(s,l),r(s,f),r(s,m),r(s,g),r(g,_),r(i,y),r(i,v),r(i,w),r(i,b),r(i,x),r(i,T),r(n,E),r(n,S)},p:t,i:t,o:t,d(t){t&&h(n)}}}function Kf(t){const e=((t,e)=>{const n=t.getTime();return(e.getTime()-n)/864e5})(new Date("2024-04-13"),new Date).toFixed(2);return[e]}class Wf extends q{constructor(t){super(),$(this,t,Kf,Gf,o,{})}}function Qf(t){let e,n,i,s,o,u,f,m,g,y,v,w,b,x,T,E,S,C,I,L,P,A,k,D,M,N,O,R,z,Z,$;return g=new Wf({}),C=new Zf({}),M=new Hf({props:{cosas:t[1]}}),{c(){e=c("main"),n=c("div"),i=c("div"),i.innerHTML='<img src="/icon.png" class="icon svelte-18dr1qd"/>',s=d(),o=c("div"),u=c("h1"),f=l(t[0]),m=d(),V(g.$$.fragment),y=d(),v=c("div"),w=c("div"),b=c("div"),x=c("h2"),x.textContent="Perdiste o encontraste algo",T=d(),E=c("hr"),S=d(),V(C.$$.fragment),I=d(),L=c("div"),P=c("h2"),P.textContent="Listado por ubicación",A=d(),k=c("hr"),D=d(),V(M.$$.fragment),N=d(),O=c("div"),R=l(t[0]),z=l(" - con mucho ❤️ por "),Z=c("a"),Z.textContent="Ivan F.",p(i,"class","mx-2 mt-1"),p(u,"class","text-3xl font-bold"),p(n,"class","mt-3 mb-5 flex justify-start"),p(x,"class","mb-4 text-2xl font-extrabold tracking-tight leading-none text-gray-900 "),p(E,"class","mt-2 mb-3"),p(P,"class","mb-4 text-2xl font-extrabold tracking-tight leading-none text-gray-900 "),p(k,"class","mt-2 mb-3"),p(w,"class","grid grid-cols-2 gap-8"),p(Z,"href","https://ivanfretes.com"),p(Z,"target","_blank"),p(O,"class","py-5"),p(v,"class","container mx-auto"),p(e,"class","svelte-18dr1qd")},m(t,h){a(t,e,h),r(e,n),r(n,i),r(n,s),r(n,o),r(o,u),r(u,f),r(e,m),U(g,e,null),r(e,y),r(e,v),r(v,w),r(w,b),r(b,x),r(b,T),r(b,E),r(b,S),U(C,b,null),r(w,I),r(w,L),r(L,P),r(L,A),r(L,k),r(L,D),U(M,L,null),r(v,N),r(v,O),r(O,R),r(O,z),r(O,Z),$=!0},p(t,[e]){(!$||1&e)&&_(f,t[0]),(!$||1&e)&&_(R,t[0])},i(t){$||(B(g.$$.fragment,t),B(C.$$.fragment,t),B(M.$$.fragment,t),$=!0)},o(t){F(g.$$.fragment,t),F(C.$$.fragment,t),F(M.$$.fragment,t),$=!1},d(t){t&&h(e),j(g),j(C),j(M)}}}function Yf(t,e,n){let{appName:i}=e;document.title=i;return t.$$set=t=>{"appName"in t&&n(0,i=t.appName)},[i,[]]}return new class extends q{constructor(t){super(),$(this,t,Yf,Qf,o,{appName:0})}}({target:document.body,props:{appName:"sepierde.org"}})}();
//# sourceMappingURL=bundle.js.map
